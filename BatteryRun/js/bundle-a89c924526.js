!function(){"use strict";if(window.JJSdkConf={app_key:"52998f9ae1eaf7519a83fe29ce8b0f14",req_domain:"https://api.jiujiuhuyu.com",version:"1.0.1",get_location:!1,share_success_time:3,storage_req_queue:"jiujiu_req_queue",storage_req_queue_max_len:50,is_submit_click_event:!1},null!=window.wx){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){function a(){try{return wx.getStorageSync("jiu_open_id")}catch(t){}return!1}function i(t){t.app_key=window.JJSdkConf.app_key,t.req_time=Date.now(),t.data.launch_param=n,new Promise(function(t,e){var i=a();i?t(i):wx.login({success:function(a){a.code?wx.request({url:window.JJSdkConf.req_domain+"/minigame/login",data:{code:a.code,app_key:window.JJSdkConf.app_key},success:function(a){if(0===a.data.code){try{wx.setStorageSync("jiu_open_id",a.data.data)}catch(t){}t(a.data.data)}else e("获取用户OpenId失败，"+a.data.msg)}}):e("登录失败！"+a.errMsg)}})}).then(function(e){t.open_id=e,-1!==o.indexOf(t.event+"_"+t.behavior)?function(t){if(function(t,e){try{var a=wx.getStorageSync(t);a="object"!==w(a)?[]:a}catch(t){}if("object"===w(a)&&a.length>0){var i=a.filter(function(a){return t===window.JJSdkConf.storage_req_queue+"_banner_show"?a.event===e.event&&a.behavior===e.behavior&&a.data.pageName===e.data.pageName&&a.data.adUnitId===e.data.adUnitId:t===window.JJSdkConf.storage_req_queue+"_icon_click"?a.event===e.event&&a.behavior===e.behavior&&a.data.id===e.data.id:t===window.JJSdkConf.storage_req_queue+"_rewardedVideo_click"?a.event===e.event&&a.behavior===e.behavior&&a.data.adUnitId===e.data.adUnitId&&a.data.isEnded===e.data.isEnded:t===window.JJSdkConf.storage_req_queue+"_share_share"?a.event===e.event&&a.behavior===e.behavior&&a.data.id===e.data.id&&a.data.active===e.data.active:t===window.JJSdkConf.storage_req_queue+"_event_event"&&a.event===e.event&&a.behavior===e.behavior&&a.data.name===e.data.name&&JSON.stringify(a.data.param)===JSON.stringify(e.data.param)});"object"===w(i)&&1===i.length?i[0].data.num+=1:a.push(e)}else a.push(e);try{wx.setStorageSync(t,a)}catch(t){}return a.length}(window.JJSdkConf.storage_req_queue+"_"+t.event+"_"+t.behavior,t)>=window.JJSdkConf.storage_req_queue_max_len)try{var e=wx.getStorageSync(window.JJSdkConf.storage_req_queue+"_"+t.event+"_"+t.behavior);for(var a in e)s(e[a]);wx.setStorageSync(window.JJSdkConf.storage_req_queue+"_"+t.event+"_"+t.behavior,[])}catch(t){console.error(t)}}(t):s(t)},function(t){console.error(t)})}function s(t){wx.JJReqQueue.push(function(){return new Promise(function(e,a){wx.request({url:window.JJSdkConf.req_domain+"/count",data:t,method:"GET",fail:function(){a("")},success:function(t){e(200==t.statusCode?"":"status error")}})})})}function w(e){var a={};return"Boolean Number String Function Array Date RegExp Object Error Symbol".split(" ").forEach(function(t,e){a["[object "+t+"]"]=t.toLowerCase()}),null==e?e:"object"==(void 0===e?"undefined":t(e))||"function"==typeof e?a[function(t){return Object.prototype.toString.call(t)}.call(e)]||"object":void 0===e?"undefined":t(e)}var n=wx.getLaunchOptionsSync(),o=["banner_show","icon_click","rewardedVideo_click","share_share","event_event"];void 0===wx.JJReqQueue&&(wx.JJReqQueue=new function(){this.concurrency=4,this.queue=[],this.tasks=[],this.active_count=0;var t=this;this.push=function(e){this.tasks.push(new Promise(function(a,i){var n=function(){t.active_count++,e().then(function(t){a(t)}).then(function(){t.next()})};t.active_count<t.concurrency?n():t.queue.push(n)}))},this.all=function(){return Promise.all(this.tasks)},this.next=function(){t.active_count--,t.queue.length>0&&t.queue.shift()()}},wx.JJReqQueue.all()),(void 0===window.JJSdkConf&&console.error("jiujiu_sdk_conf.js必须放置在jiujiu_sdk.js、jiujiu_pull_sdk.js之前"),Promise.all([new Promise(function(t,e){wx.getNetworkType({success:function(e){t(e)},fail:function(){t("")}})}),window.JJSdkConf.get_location?new Promise(function(t,e){wx.getLocation({success:function(e){t(e)},fail:function(){t("")}})}):"",new Promise(function(t,e){try{t(wx.getSystemInfoSync())}catch(t){}t("")})])).then(function(t){var e={data:{},event:"init",behavior:"init"};e.data.nt=t[0]&&t[0].networkType||"",e.data.lat=t[1]&&t[1].latitude||"",e.data.lnt=t[1]&&t[1].longitude||"",e.data.spd=t[1]&&t[1].speed||"",e.data.wvv=t[2]?t[2].fontSizeSetting:"",e.data.wsdk=t[2]?t[2].SDKVersion:"",e.data.br=t[2]&&t[2].brand||"",e.data.md=t[2]&&t[2].model||"",e.data.pr=t[2]?t[2].pixelRatio:"",e.data.sw=t[2]?t[2].screenWidth:"",e.data.sh=t[2]?t[2].screenHeight:"",e.data.ww=t[2]?t[2].windowWidth:"",e.data.wh=t[2]?t[2].windowHeight:"",e.data.lg=t[2]?t[2].language:"",e.data.wv=t[2]?t[2].version:"",e.data.sv=t[2]?t[2].system:"",e.data.bh=t[2]?t[2].benchmarkLevel:"",e.data.gv=function(){var t=window.JJSdkConf.version,e=wx.getAccountInfoSync();return e.miniProgram.version&&(t=e.miniProgram.version),t}(),i(e)});var r=Date.now();wx.onShow(function(t){r=Date.now();var e={data:{},event:"onShow",behavior:"onShow"};e.data.scene=t.scene,e.data.query=t.query,e.data.shareTicket=t.shareTicket,e.data.referrerInfo=t.referrerInfo,i(e)}),wx.onHide(function(t){!function(){for(var t in o){var e=wx.getStorageSync(window.JJSdkConf.storage_req_queue+"_"+o[t]);for(var a in e)s(e[a]);wx.setStorageSync(window.JJSdkConf.storage_req_queue+"_"+o[t],[])}}();var e={data:{},event:"onHide",behavior:"onHide"};e.data.game_time=Date.now()-r,i(e)}),wx.onError(function(t){var e={data:{},event:"onError",behavior:"onError"};e.data=t,i(e)});var h=["payStart","paySuccess","payFail","die","revive","tools","award"],l=["complete","fail"];wx.JJStage=new function(){function e(t){return!/^\d+(.\d+)*$/.test(t.stageId)||t.stageId.length>32||isNaN(Number(t.stageId))?(console.warn("关卡stageId必须符合传参规则,请参考文档。"),!1):!("string"!==w(t.stageName)||t.stageName.length>32)||(console.warn("关卡名称为必传字段,且长度小于32个字符,请参考文档"),!1)}var t=0;this.onStart=function(a){if(e(a)){t=Date.now();var n={data:{}};n.data.stageInitTime=Date.now(),n.data.stageId=a.stageId,n.data.stageName=a.stageName,n.event="stage",n.behavior="start",i(n)}},this.onRunning=function(t){if(e(t)){if("string"!==w(t.event)&&-1===h.join(",").indexOf(t.event+","))return void console.warn("关卡running状态中仅支持"+h.join(",")+"事件类型，且为必传字段，详情请参考文档。");if("object"!==w(t.params))return void console.warn("关卡running状态中params为必传字段，且该字段需为Object类型，详情请参考文档。");if("string"!==w(t.params.itemName)||t.params.itemName.length>32)return void console.warn("道具/商品名称为必传字段，且长度小于32个字符，详情请参考文档");var a={data:{},event:"stage",behavior:"running"};a.data=t,"number"!==w(t.params.itemCount)&&(a.data.params.itemCount=1),-1!==t.event.indexOf("pay")&&"number"!==w(t.params.itemMoney)&&(a.data.params.itemMoney=0),i(a)}},this.onEnd=function(a){if(e(a)){if(void 0===a.event||-1===l.join(",").indexOf(a.event+","))return void console.warn("关卡结束事件仅支持"+l.join(",")+",且为必传字段。详情请参考文档");var n={data:{},event:"stage",behavior:"end"};n.data=a,0!==t&&(n.data.stage_take_time=Date.now()-t),i(n)}}};for(var d={JJSendIconExposure:function(t){var e={data:{}};e.data=t(),e.event="icon",e.behavior="show",i(e)},JJNavigateToMiniProgram:function(t){var e={data:{}};return e.data=t(),"object"!==w(e.data)?void console.error("统计: 打开小游戏参数必须为Object类型"):void 0===e.data.id||"number"!==w(e.data.id)?void console.error("统计：打开小游戏参数必须包含创意id"):"string"!==w(e.data.appId)||void 0===e.data.appId?void console.error("统计： 打开小游戏参数appid错误"):"string"!==w(e.data.path)||void 0===e.data.path?void console.error("统计： 打开小游戏参数path错误"):(e.event="icon",e.behavior="click",e.data.num=1,window.JJSdkConf.is_submit_click_event&&i(e),new Promise(function(t,a){wx.navigateToMiniProgram({appId:e.data.appId,path:e.data.path?e.data.path:"",extraData:e.data.extraData?e.data.extraData:"",envVersion:e.data.envVersion?e.data.envVersion:"release",success:function(a){e.behavior="jump",i(e),t(a)},fail:function(t){a(t)}})}))},JJBannerAdShowCount:function(t){var e={data:{}};return e.data=t(),"object"!==w(e.data)?void console.error("统计: JJBannerAdShowCount参数必须为Object类型"):void 0===e.data.adUnitId||"string"!==w(e.data.adUnitId)?void console.error("统计：JJBannerAdShowCount必须传入adUnitId参数"):void 0===e.data.adUnitName||"string"!==w(e.data.adUnitName)?void console.error("统计：JJBannerAdShowCount必须传入adUnitName参数"):void 0===e.data.pageName||"string"!==w(e.data.pageName)?void console.error("统计：JJBannerAdShowCount必须传入pageName参数"):(e.event="banner",e.behavior="show",e.data.num=1,void i(e))},JJSendVideoAdCount:function(e){var a={data:{}};return a.data=e(),"object"!==t(a.data)?void console.error("发送激励视频数据参数必须为对象"):void 0===a.data.adUnitId?void console.error("发送激励视频数据参数必须包含广告位ID"):void 0===a.data.adUnitName?void console.error("发送激励视频数据参数必须包含广告位名称"):void 0===a.data.isEnded?void console.error("发送激励视频数据参数必须包含用户是否观看完整标识(isEnded)"):(a.event="rewardedVideo",a.behavior="click",a.data.num=1,void i(a))},JJShareAppMessage:function(t){var e=Date.now(),n={data:{}};n.data=t();var s,o=a();s=void 0!==n.data.query?n.data.query+"&jiu_share_src="+o:"jiu_share_src="+o,n.data.query=s,n.event="share",n.behavior="share",n.data.active=1,n.data.num=1;var r=n.data;return i(n),wx.shareAppMessage(n.data),new Promise(function(t,a){wx.onShow(function(a){if(Date.now()-e>=1e3*window.JJSdkConf.share_success_time){var n={data:{},event:"share",behavior:"success"};n.data=r,i(n),t(!0)}else t(!1)})})},JJOnShareAppMessage:function(t){wx.onShareAppMessage(function(){var e={data:{}};e.data=t();var n,s=a();return n=void 0!==e.data.query?e.data.query+"&jiu_share_src="+s:"jiu_share_src="+s,e.data.query=n,e.event="share",e.behavior="share",e.data.active=0,e.data.num=1,i(e),t()})},JJSendEvent:function(e){var a={data:{},event:"event",behavior:"event"};return a.data=e(),"object"!=t(a.data)?void console.error("事件参数必须是Object类型"):""===a.data.name||"string"!=typeof a.data.name||a.data.name.length>255?void console.error("事件名称必须为String类型且不能超过255个字符"):JSON.stringify(a.data).length>=255?void console.error("自定义事件参数不能超过255个字符"):void 0!==a.data.param&&function(e){for(var a in e)if("object"==t(e[a])&&null!==e[a])return!0;return!1}(a.data.param)?void console.error("事件参数，参数内部只支持Number,String等类型，请参考接入文档"):(a.data.num=1,void i(a))}},c=["JJSendIconExposure","JJNavigateToMiniProgram","JJBannerAdShowCount","JJSendVideoAdCount","JJShareAppMessage","JJOnShareAppMessage","JJSendEvent"],u=c.length-1;u>=0;u--)!function(t,e){Object.defineProperty(wx,t,{value:e,writable:!1,enumerable:!0,configurable:!0})}(c[u],d[c[u]])}()}!function(){function e(t,e,a){return new Promise(function(i,n){var s=new XMLHttpRequest;s.withCredentials=!0,s.onreadystatechange=function(){4===s.readyState&&200==s.status&&i(JSON.parse(s.responseText))},s.onerror=function(t){n("")},s.ontimeout=function(t){n("")},s.open(t,e+function(t){var e="?";for(var a in t)e+=a+"="+t[a]+"&";return e}(a),!1),s.send()})}void 0===window.JJSdkConf&&console.error("jiujiu_sdk_conf.js必须放置在jiujiu_sdk.js、jiujiu_pull_sdk.js之前");for(var t={JJGameConfigs:function(){return e("GET",window.JJSdkConf.req_domain+"/game/configs",{version:window.JJSdkConf.version,app_key:window.JJSdkConf.app_key})},JJGameConfigByKeys:function(t){return e("GET",window.JJSdkConf.req_domain+"/get/configs/by/keys",{version:window.JJSdkConf.version,app_key:window.JJSdkConf.app_key,config_key:t})},JJGameShares:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e("GET",window.JJSdkConf.req_domain+"/game/shares",{app_key:window.JJSdkConf.app_key,p_code:t})},JJGameAds:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e("GET",window.JJSdkConf.req_domain+"/ads",{app_key:window.JJSdkConf.app_key,position_id:t})},JJGetGameConfigAdShare:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a={};return t&&(a=t()),a.app_key=window.JJSdkConf.app_key,a.version=window.JJSdkConf.version,void 0===a.version?void console.error("配置三合一接口必须小游戏传递版本号"):e("GET",window.JJSdkConf.req_domain+"/batch/configs",a)}},a=["JJGameConfigs","JJGameConfigByKeys","JJGameShares","JJGameAds","JJGetGameConfigAdShare"],i=a.length-1;i>=0;i--)!function(t,e){Object.defineProperty(window,t,{value:e,writable:!1,enumerable:!0,configurable:!0})}(a[i],t[a[i]])}();class e{constructor(){this.gridIdArr=[],this.gridAdArr=[],this.totalCount=1,this.createIndex=0,this.showTimes=0,this.currentIndex=0}static get instance(){return this._instance||(this._instance=new e),this._instance}get sysInfo(){return window.wx.getSystemInfoSync()}initCustomAd(){this.gridIdArr=x.instance.dataConfig.front_more_gezi_list,this.gridIdArr&&(this.showTimes=0,this.currentIndex=0,this.createIndex=0,this.gridIdArr=x.instance.shuffleArr(this.gridIdArr),this.totalCount=this.gridIdArr.length,this.createCustomAd())}getCustomAd(t,e,a=null,i=null){let n=Laya.Browser.window.wx.createCustomAd({adUnitId:t,adIntervals:x.instance.dataConfig.front_more_gezi_time/1e3,style:e});return n.onError(t=>{console.log("全屏格子加载失败"),i&&i(),n.offError(),n.offLoad()}),n.onLoad(()=>{a&&a(),n.offError(),n.offLoad()}),n}createCustomAd(){if(this.createIndex>=this.gridIdArr.length||this.gridAdArr.length>=this.totalCount)return;let t=this.getCustomAd(this.gridIdArr[this.createIndex],{left:0,top:70},()=>{this.gridAdArr.push(t),this.createIndex++,this.createCustomAd()},()=>{this.createIndex++,this.createCustomAd()})}showGrid(){Laya.Browser.onWeiXin&&this.getIsError()?this.initCustomAd():Laya.Browser.onWeiXin&&this.gridAdArr.length>0&&(this.gridAdArr[this.currentIndex].show(),this.showTimes++)}hideGrid(){Laya.Browser.onWeiXin&&this.gridAdArr.length>0&&(this.gridAdArr[this.currentIndex].hide(),this.showTimes>=x.instance.dataConfig.front_more_gezi_refresh_num&&(this.showTimes=0,this.currentIndex++,this.currentIndex>=this.gridAdArr.length&&(this.currentIndex=0)))}getIsError(){return this.gridAdArr.length<=0}getIsShow(){return!(this.gridAdArr.length<=0)&&this.gridAdArr[this.currentIndex].isShow()}}var n,o,r,h,l,d,c,u,m,g,y,f,p,C={wechat:{videoAdUnitId:["adunit-66c46b38b19be006"],interstitialAdUnitId:["adunit-afb4272719c07a03"],customAd:["adunit-d122fa3fb04f7fcc","adunit-b928031ceab13a61"],finishCustomAd:["adunit-2fd6e62d03037c55"]}};class L{constructor(){this.gridIdArr=[],this.gridAdArr=[],this.totalCount=1,this.createIndex=0}static get instance(){return this._instance||(this._instance=new L),this._instance}get sysInfo(){return window.wx.getSystemInfoSync()}initCustomAd(){Laya.Browser.onWeiXin&&(this.gridIdArr=C.wechat.finishCustomAd,this.totalCount=1,this.createIndex=0,this.createCustomAd())}getCustomAd(t,e,a=null,i=null){let n=Laya.Browser.window.wx.createCustomAd({adUnitId:t,adIntervals:x.instance.dataConfig.front_more_gezi_time/1e3,style:e});return n.onError(t=>{console.log("结算格子加载失败"),i&&i(),n.offError(),n.offLoad()}),n.onLoad(()=>{a&&a(),n.offError(),n.offLoad()}),n}createCustomAd(){if(this.createIndex>=this.gridIdArr.length||this.gridAdArr.length>=this.totalCount)return;let t={left:0,top:this.sysInfo.screenHeight/2-220,width:this.sysInfo.screenWidth},e=this.getCustomAd(this.gridIdArr[this.createIndex],t,()=>{this.gridAdArr.push(e),this.createIndex++,this.createCustomAd()},()=>{this.createIndex++,this.createCustomAd()})}showGrid(){Laya.Browser.onWeiXin&&this.getIsError()?this.initCustomAd():Laya.Browser.onWeiXin&&this.gridAdArr.length>0&&this.gridAdArr[0].show()}hideGrid(){Laya.Browser.onWeiXin&&this.gridAdArr.length>0&&this.gridAdArr[0].hide()}getIsError(){return this.gridAdArr.length<=0}}class v{constructor(){this.bannerAdArr=[],this.bannerTimeArr=[],this.bannerErrorArr=[],this.bannerCountArr=[],this.currentIndex=0,this.indexTime=0}static get Instance(){return v._instance||(v._instance=new v),v._instance}get sysInfo(){return this._sysInfo||(this._sysInfo=wx.getSystemInfoSync()),this._sysInfo}initAd(t=[]){this.bannerIds=[],this.bannerIds=this.bannerIds.concat(t),this.showBanner=this.showBannerFun,this.hideBanner=this.hideBannerFun,this.createBannerAd()}createBannerAd(){if(Laya.Browser.onWeiXin){this.bannerAdArr=[],this.bannerTimeArr=[],this.bannerErrorArr=[],this.currentIndex=0;for(let t=0;t<this.bannerIds.length;t++){this.bannerErrorArr.push(!1),this.bannerTimeArr.push(0),this.bannerCountArr.push(0);let e=this.getBannerAd(t);this.bannerAdArr.push(e)}}}getBannerAd(t,e=!1){let a=Laya.Browser.window.wx.createBannerAd({adUnitId:e?x.instance.getRandomItemInArr(this.bannerIds):this.bannerIds[t],style:{top:.8*this.sysInfo.screenHeight,width:10,left:this.sysInfo.screenWidth/2-150},adIntervals:x.instance.dataConfig.front_banner_auto_refresh_time/1e3});return a.onError(()=>{console.log("banner加载失败：",t),this.bannerErrorArr[t]=!0}),a.onLoad(()=>{this.bannerErrorArr[t]=!1}),a.onResize(()=>{a.style.top=this.sysInfo.screenHeight-a.style.realHeight,a.style.left=this.sysInfo.screenWidth/2-a.style.realWidth/2}),a}getIsAllError(){let t=!0;for(let e=0;e<this.bannerErrorArr.length;e++)if(!this.bannerErrorArr[e]){t=!1;break}return t}showBannerFun(){if(!Laya.Browser.onWeiXin)return!1;this.currentIndex>=this.bannerAdArr.length&&(this.currentIndex=0),this.bannerCountArr[this.currentIndex]>=x.instance.dataConfig.front_banner_refresh_num&&(this.bannerCountArr[this.currentIndex]=0,this.currentIndex++,console.log("切换id:",this.currentIndex),this.currentIndex>=this.bannerAdArr.length&&(this.currentIndex=0));let t=!1;for(let e=0;e<this.bannerErrorArr.length;e++)if(0==this.bannerErrorArr[e]){t=!0;break}for(let t=0;t<this.bannerErrorArr.length&&this.bannerErrorArr[this.currentIndex];t++)this.bannerTimeArr[this.currentIndex]=0,this.bannerCountArr[this.currentIndex]=0,this.bannerAdArr[this.currentIndex]=this.getBannerAd(this.currentIndex),this.currentIndex++,this.currentIndex>=this.bannerAdArr.length&&(this.currentIndex=0);return this.hideBannerFun(),this.bannerAdArr[this.currentIndex]&&(this.bannerAdArr[this.currentIndex].show(),this.bannerCountArr[this.currentIndex]++),Laya.timer.clear(this,this.updateBannerTime),Laya.timer.loop(100,this,this.updateBannerTime),!0}showBannerFun2(){this.hideBannerFun(),this.showBannerFun()}showBannerFun2Fun(){this.showBannerFun()}hideBannerFun(t){if(Laya.Browser.onWeiXin){Laya.timer.clear(this,this.updateBannerTime);for(let t=0;t<this.bannerAdArr.length;t++)this.bannerAdArr[t]&&this.bannerAdArr[t].hide();t&&this.hideBannerFun2()}}hideBannerFun2(){}checkBannerTimeOut(){if(!Laya.Browser.onWeiXin)return;let t=x.instance.dataConfig.front_banner_refresh_time;S.Instance.NewWuchu2||(t=3e4),this.bannerTimeArr[this.currentIndex]>=t/1e3&&(Laya.timer.clear(this,this.updateBannerTime),this.hideBannerFun(),this.bannerAdArr[this.currentIndex].destroy(),this.bannerTimeArr[this.currentIndex]=0,this.bannerErrorArr[this.currentIndex]=!0,this.bannerAdArr[this.currentIndex]=this.getBannerAd(this.currentIndex),this.bannerAdArr[this.currentIndex].show(),Laya.timer.loop(100,this,this.updateBannerTime))}updateBannerTime(){this.bannerTimeArr[this.currentIndex]+=.1,this.checkBannerTimeOut()}countIndexTime(){Laya.timer.loop(100,this,this.updateIndexTime)}updateIndexTime(){let t=this;t.indexTime+=.1,t.indexTime>=x.instance.dataConfig.front_assign_banner_time/1e3&&(t.hideBannerFun(),t.currentIndex++,t.showBannerFun(),t.indexTime=0)}stopCountIndexTime(){Laya.timer.clear(this,this.updateIndexTime)}showHideBanner(){Laya.timer.once(x.instance.dataConfig.front_gezi_time,this,this.showHideBannerShow)}showHideBannerShow(){this.showBannerFun(),Laya.timer.once(1e3,this,this.showHideBannerHide)}showHideBannerHide(){this.hideBannerFun(),Laya.timer.once(x.instance.dataConfig.front_gezi_time,this,this.showHideBannerShow)}clearShowHideBanner(){Laya.timer.clear(this,this.showHideBannerHide),Laya.timer.clear(this,this.showHideBannerShow),this.hideBannerFun()}}class _{constructor(){this.videoIsError=!1}static get Instance(){return _._instance||(_._instance=new _),_._instance}set bannerLoadError(t){}get bannerLoadError(){return v.Instance.getIsAllError()}init(){Laya.Browser.onWeiXin&&(this.sysInfo=wx.getSystemInfoSync(),this.videoId=C.wechat.videoAdUnitId[0],this.interId=C.wechat.interstitialAdUnitId[0],this.gridId=C.wechat.customAd)}loadVideoAd(){if(Laya.Browser.onWeiXin){var t,e=this;null!=(t=this.videoAd)&&(t.offLoad(onLoadVideo),t.offError(onErrorVideo),t.offClose(onCloseVideo)),(t=Laya.Browser.window.wx.createRewardedVideoAd({adUnitId:e.videoId})).onLoad(onLoadVideo),t.onError(onErrorVideo),t.onClose(onCloseVideo),this.videoAd=t}function onLoadVideo(){console.log("video 加载成功"),e.existVideoAd=!0}function onErrorVideo(t){this.videoIsError=!0,console.error("video 加载错误",t)}function onCloseVideo(a){let i=!!(a&&a.isEnded||void 0===a);i&&(e.videoEndCallback&&e.videoEndCallback(),e.videoEndCallback=null),e.videoCloseCallback&&e.videoCloseCallback(i),e.videoCloseCallback=null,t.load()}}showVideoAd(t,e,a=!1){if(!Laya.Browser.onWeiXin)return t&&t(),void(e&&e());if(this.videoEndCallback=t,this.videoCloseCallback=e,this.existVideoAd||this.loadVideoAd(),!a)if(Laya.Browser.onWeiXin){var i=this.videoAd;i.show().then(()=>{}).catch(t=>{i.load().then(()=>i.show().then(()=>{})).catch(t=>{this.videoEndCallback&&this.videoEndCallback(),this.videoEndCallback=null,this.videoCloseCallback&&this.videoCloseCallback(!0),this.videoCloseCallback=null})})}else this.videoEndCallback&&this.videoEndCallback(),this.videoEndCallback=null,this.videoCloseCallback&&this.videoCloseCallback(!0),this.videoCloseCallback=null}createInterAd(){if(Laya.Browser.onWeiXin){let t=this;this.interAd=wx.createInterstitialAd({adUnitId:t.interId}),this.interAd.onLoad(()=>{console.log("插屏广告加载成功")}),this.interAd.onError(t=>{console.error("插屏广告加载失败"),this.interAd=null})}}showInterAd(){this.interAd&&this.interAd.show()}createGameCustomAd(){if(Laya.Browser.onWeiXin&&!this.gameGridAd&&x.instance.dataConfig.front_dangezi_switch){this.gameGridAd=[];for(let t=0;t<2;t++){let e=this.getGridPos(t,80*(Math.floor(t/2)+1)),a=wx.createCustomAd({adUnitId:this.gridId[t],adIntervals:30,style:e});this.gameGridAd.push(a),a.onLoad(()=>{})}}}hideGameCustomAd(){if(Laya.Browser.onWeiXin&&this.gameGridAd)for(let t=0;t<2;t++)this.gameGridAd[t].hide()}showGameCustomAd(){if(Laya.Browser.onWeiXin&&this.gameGridAd)for(let t=0;t<2;t++)this.gameGridAd[t].show()}getGridPos(t,e=120){let a={width:20,height:20};return t%2==0?(a.left=20,a.top=e):(a.left=this.sysInfo.windowWidth-90,a.top=e),a}}class S{constructor(){this.dataConfig=x.instance.dataConfig,this._Level=0}static get Instance(){return S._instance||(S._instance=new S),S._instance}get Level(){return this._Level}set Level(t){this._Level=t}get NewWuchu(){return!0}get NewWuchu2(){return x.instance.dataConfig.is_allow_area&&this.allowScene}inHomePage(t,e){console.log("本地保存场景值：",Laya.LocalStorage.getItem("localScene")),console.log("本地保存路径值：",Laya.LocalStorage.getItem("wxgamecid")),console.log("allowScene:",this.allowScene),this.moreGameBtn=t,this.drawBtn=e,t&&Laya.timer.loop(100,this,this.updateMoreGameBtn),e&&Laya.timer.loop(100,this,this.updateDrawBtn),b.instance.hideGrid(),new Promise((t,e)=>{!this.isSplash&&S.Instance.NewWuchu2&&x.instance.dataConfig.front_home_hot_tuijian?this.showGridUI4(()=>{t(0)}):t(0)}).then(t=>new Promise((t,e)=>{!this.isSplash&&S.Instance.NewWuchu2&&100*Math.random()<x.instance.dataConfig.front_home_vi_chance?(_.Instance.showVideoAd(null,t=>{}),t(1)):t(1)})).then(t=>new Promise((t,e)=>{!this.isSplash&&S.Instance.NewWuchu2&&100*Math.random()<x.instance.dataConfig.front_home_box_chance?this.showHomeBox(()=>{t(2)}):t(2)})).then(t=>new Promise((t,e)=>{this.gridInt=setInterval(()=>{this.testGrid()},1e3),t(3)})).then(t=>{v.Instance.showBannerFun2(),this.isSplash=!0})}testGrid(){b.instance.gridAdArr.length>0&&(b.instance.showGrid(),clearInterval(this.gridInt))}updateMoreGameBtn(){this.moreGameBtn.visible=S.Instance.NewWuchu2&&x.instance.dataConfig.front_haowan_switch}updateDrawBtn(){this.drawBtn.visible=S.Instance.NewWuchu2&&x.instance.dataConfig.front_chouti_switch}inGame(t,e){t&&(t.visible=S.Instance.NewWuchu&&x.instance.dataConfig.front_chouti_switch),e&&(e.visible=S.Instance.NewWuchu&&x.instance.dataConfig.front_jingxi_gezi_switch)}clickShop(t){b.instance.hideGrid(),t||v.Instance.hideBannerFun(!0),Laya.timer.clear(this,this.updateMoreGameBtn),Laya.timer.clear(this,this.updateDrawBtn)}clickStartGame(t){b.instance.hideGrid(),v.Instance.hideBannerFun(!0),Laya.timer.clear(this,this.updateMoreGameBtn),Laya.timer.clear(this,this.updateDrawBtn),S.Instance.NewWuchu2?new Promise((t,e)=>{this.showGridUI3(()=>{t(0)})}).then(t=>new Promise((t,e)=>{100*Math.random()<x.instance.dataConfig.front_start_vi_chance?(_.Instance.showVideoAd(null,t=>{}),t(1)):t(1)})).then(t=>new Promise((t,e)=>{this.showStartBox(()=>{t(2)})})).then(e=>{_.Instance.showGameCustomAd(),t&&t()}):t&&t()}clickHomeMoreGame(){b.instance.hideGrid(),v.Instance.hideBannerFun(!0),this.showGridUI(()=>{b.instance.showGrid(),v.Instance.showBanner()},!1,!0)}clickDraw(){b.instance.hideGrid(),v.Instance.hideBannerFun(!0),this.showGridUI(()=>{b.instance.showGrid(),v.Instance.showBanner()},!1,!0)}clickFinishMoreGame(){L.instance.hideGrid(),_.Instance.hideGameCustomAd(),v.Instance.hideBannerFun(!0),this.showGridUI(()=>{_.Instance.showGameCustomAd(),v.Instance.showBanner(),this.dataConfig.front_jiesuanye_switch&&this.NewWuchu&&(100*Math.random()<this.dataConfig.front_daochu_gezi_chance||L.instance.showGrid())},!1,!0)}showGameBanner(){this.NewWuchu&&x.instance.dataConfig.front_game_banner_switch&&v.Instance.showBannerFun2()}showGameOver(t){_.Instance.hideGameCustomAd(),v.Instance.hideBannerFun(!0),this.showGridUI(()=>{this.showEndBox(t)},!0)}showFinishUI(t,e){v.Instance.hideBannerFun(!0),_.Instance.showGameCustomAd(),e&&(e.visible=S.Instance.NewWuchu&&x.instance.dataConfig.front_chouti_switch),v.Instance.showBannerFun2(),this.NewWuchu&&x.instance.dataConfig.front_daochulan_switch&&this.showFinishScroll(t),this.dataConfig.front_jiesuanye_switch&&this.NewWuchu&&(100*Math.random()<this.dataConfig.front_daochu_gezi_chance?this.showFinishExport(t):L.instance.showGrid()),S.Instance.NewWuchu&&x.instance.dataConfig.front_jiesaunye_chaping_switch&&_.Instance.showInterAd()}closeFinishUI(t){_.Instance.hideGameCustomAd(),v.Instance.hideBannerFun(!0),L.instance.hideGrid(),new Promise((t,e)=>{this.NewWuchu2&&100*Math.random()<x.instance.dataConfig.front_jiesuanye_vi_chance?_.Instance.showVideoAd(null,e=>{t(1)}):t(1)}).then(t=>new Promise((t,e)=>{this.showGridUI2(()=>{t(2),this.dataConfig.front_wx_ad_switch&&this.NewWuchu&&_.Instance.showInterAd()},!0)})).then(e=>{t&&t()})}showGridUI(t,e=!1,a=!1){Laya.Scene.open("JJExport/GridUI.scene",!1,{ccb:t,isInterAd:e,isMoreGame:a},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))}showGridUI2(t,e=!1){Laya.Scene.open("JJExport/GridUI2.scene",!1,{ccb:t,isFinishUI:e},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))}showGridUI3(t){Laya.Scene.open("JJExport/GridUI3.scene",!1,{ccb:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))}showGridUI4(t){Laya.Scene.open("JJExport/GridUI4.scene",!1,{ccb:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))}showRunUI(t){t&&t()}showFinishExport(t){Laya.Scene.open("JJExport/FinishGameUI.scene",!1,null,Laya.Handler.create(this,e=>{t.addChild(e)}))}showFinishScroll(t){Laya.Scene.open("JJExport/FinishScrollUI.scene",!1,null,Laya.Handler.create(this,e=>{t.addChild(e)}))}showHomeBox(t){Laya.Scene.open("JJExport/StartBoxUI.scene",!1,{ccb:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))}showStartBox(t){this.getRandom0To100<x.instance.dataConfig.front_fbox_wuchu_change&&x.instance.dataConfig.front_level_fbox_num<=this.Level&&x.instance.dataConfig.is_allow_area&&this.allowScene?(1==x.instance.dataConfig.front_fbox_status&&Laya.Scene.open("JJExport/EndBoxUI.scene",!1,{lianxu_num:x.instance.dataConfig.front_fbox_lianxu_num,ccb:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)})),2==x.instance.dataConfig.front_fbox_status&&Laya.Scene.open("JJExport/StartBoxUI.scene",!1,{lianxu_num:x.instance.dataConfig.front_fbox_lianxu_num,ccb:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))):t&&t()}showEndBox(t){this.getRandom0To100<x.instance.dataConfig.front_tbox_wuchu_change&&x.instance.dataConfig.front_level_tbox_num<=this.Level&&x.instance.dataConfig.is_allow_area&&this.allowScene?(1==x.instance.dataConfig.front_tbox_status&&Laya.Scene.open("JJExport/EndBoxUI.scene",!1,{lianxu_num:x.instance.dataConfig.front_tbox_lianxu_num,ccb:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)})),2==x.instance.dataConfig.front_tbox_status&&Laya.Scene.open("JJExport/StartBoxUI.scene",!1,{lianxu_num:x.instance.dataConfig.front_tbox_lianxu_num,ccb:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))):t&&t()}getRandomIndex(){return Math.floor(Math.random()*x.instance.navDataArr.length)}get getRandom0To100(){return 100*Math.random()}get allowScene(){if(Laya.Browser.onWeiXin){if(!this.dataConfig.front_wuchu_scene)return!0;let t=window.wx.getEnterOptionsSync().scene,e=window.wx.getEnterOptionsSync().query,a=Number(Laya.LocalStorage.getItem("localScene"));a||(a=t,Laya.LocalStorage.setItem("localScene",a.toString()),e.wxgamecid&&Laya.LocalStorage.setItem("wxgamecid",e.wxgamecid.toString())),this.dataConfig.front_first_scv_swtich&&(t=a);let i=Laya.LocalStorage.getItem("wxgamecid");this.dataConfig.front_is_source||(i="true");let n=this.dataConfig.front_wuchu_scene.toString();if(-1==n.search("|")){return parseInt(n)!=t}let s=n.split("|");for(let e=0;e<s.length;e++){if(parseInt(s[e])==t&&i)return!0}return!1}return!1}switch(t){let e="";for(let a=t.length-1;a>=0;a--)e+=t[a];return e}addClickEvent(t,e,a,i,n){if(t.offAllCaller(e),t instanceof Laya.Button&&!n){let n=t=>{a&&a.call(e,t)};t.on(Laya.Event.CLICK,e,n,[i])}else{let n=60,s=1,o=t.scaleX*s,r=t.scaleY*s,h=.9*s,l=!1,d=e=>{l=!0,Laya.Tween.to(t,{scaleX:h,scaleY:h},n)};t.on(Laya.Event.MOUSE_DOWN,e,d,[i]);let c=i=>{0!=l&&(l=!1,Laya.Tween.to(t,{scaleX:o,scaleY:r},n,null,new Laya.Handler(e,()=>{a&&a.call(e,i)})))};t.on(Laya.Event.MOUSE_UP,e,c,[i]);let u=e=>{Laya.Tween.to(t,{scaleX:o,scaleY:r},n)};t.on(Laya.Event.MOUSE_OUT,e,u,[i])}}}class b{constructor(){this.gridIdArr=[],this.gridAdArr=[],this.hadHide=!1,this.totalCount=2,this.createIndex=0,this.showTimes=0}static get instance(){return this._instance||(this._instance=new b),this._instance}get sysInfo(){return window.wx.getSystemInfoSync()}initCustomAd(){Laya.Browser.onWeiXin&&x.instance.dataConfig.front_duilian_gezi_switch&&S.Instance.NewWuchu2&&(this.gridIdArr=x.instance.dataConfig.front_duilian_gezi_list,this.gridIdArr&&(this.totalCount=2,this.createIndex=0,this.createCustomAd()))}getCustomAd(t,e,a=null,i=null){let n=Laya.Browser.window.wx.createCustomAd({adUnitId:t,adIntervals:x.instance.dataConfig.front_more_gezi_time/1e3,style:e});return n.onError(t=>{console.log("对联格子加载失败"),i&&i(),n.offError(),n.offLoad()}),n.onLoad(()=>{this.hadHide||n.show(),a&&a(),n.offError(),n.offLoad()}),n}createCustomAd(){if(this.createIndex>=this.gridIdArr.length||this.gridAdArr.length>=this.totalCount)return;let t={left:0==this.gridAdArr.length?0:this.sysInfo.screenWidth-65,top:120},e=this.getCustomAd(this.gridIdArr[this.createIndex],t,()=>{this.gridAdArr.push(e),this.createIndex++,this.createCustomAd()},()=>{this.createIndex++,this.createCustomAd()})}showGrid(){if(Laya.Browser.onWeiXin&&this.getIsError()&&this.showTimes>0)this.initCustomAd();else{if(Laya.Browser.onWeiXin&&this.gridAdArr.length>0)for(let t=0;t<this.gridAdArr.length;t++)this.gridAdArr[t].show();this.showTimes++}}hideGrid(){if(this.hadHide=!0,Laya.Browser.onWeiXin&&this.gridAdArr.length>0)for(let t=0;t<this.gridAdArr.length;t++)this.gridAdArr[t].hide()}getIsError(){return this.gridAdArr.length<=0}}!function(t){t.SCENE_RECOMMENDUI="JJExport/RecommendUI.scene",t.SCENE_FULLGAMEUI="JJExport/FullGameUI.scene",t.SCENE_FINISHGAMEUI="JJExport/FinishGameUI.scene",t.SCENE_FINISH2GAMEUI="JJExport/Finish2GameUI.scene",t.SCENE_BOX1="JJExport/Box1.scene",t.SCENE_BOX2="JJExport/Box2.scene",t.SCENE_BOX3="JJExport/Box3.scene"}(n||(n={})),function(t){t.PORTRAIT="portrait",t.LANDSCAPE="landscape"}(o||(o={}));class x{constructor(){this.screenOrientation=o.PORTRAIT,this.eventDispatcher=new Laya.EventDispatcher,this.navDataArr=[],this.closeCBScenes=[],this.dataConfig={}}static get instance(){return this._instance||(this._instance=new x),this._instance}set shareCount(t){this.dataConfig.front_share_number=t}get shareCount(){return this.dataConfig.front_share_number}set shareContext(t){this.shareConfig=t}get shareContext(){return this.shareConfig}initJJ(t,a=o.PORTRAIT){let i=window.wx.getEnterOptionsSync().scene;console.log(window.wx.getEnterOptionsSync()),console.log("本次场景值：",i),this.screenOrientation=a,_.Instance.init(),Laya.Browser.window.JJGetGameConfigAdShare().then(a=>{console.log("获取游戏配置：",a.data.config),this.updateDataConfig(a.data.config),console.log("获取导出配置：",a.data.ad),this.updateNavData(a.data.ad),console.log("获取分享配置：",a.data.share);var i=a.data.share[0];i&&(this.shareContext={title:i.share_content,imageUrl:i.share_img,id:i.id}),Laya.Browser.onWeiXin&&this.JJOnShareAppMessage(this.shareContext);let n=x.instance.dataConfig;e.instance.initCustomAd(),b.instance.initCustomAd(),_.Instance.createInterAd(),_.Instance.createGameCustomAd(),L.instance.initCustomAd();let s=n.front_banner_ids;v.Instance.initAd(s),Laya.Browser.onWeiXin&&S.Instance.NewWuchu&&x.instance.dataConfig.front_leave_return_switch&&Laya.Browser.window.wx.onShow(()=>{_.Instance.showInterAd()}),t&&t(!0)},()=>{t&&t(!1)}),this.showShareMenuWithTicket(!0)}openScene(t,e=!1,a,i=(()=>{}),n,s){Laya.Scene.open(t,e,a,Laya.Handler.create(this,t=>{n?n.addChild(t):Laya.stage.addChild(t),s&&s(),i&&this.closeCBScenes.push({scene:t,closeCB:i})}))}closeScene(t){if(t instanceof Laya.Scene){Laya.Scene.close(t.url);let e=this.closeCBScenes.filter(e=>e.scene===t);if(e&&e.length>0){let t=e[0];t.closeCB(),this.closeCBScenes.splice(this.closeCBScenes.indexOf(t),1)}}else Laya.Scene.close(t)}NavigateApp(t,e,a){if(0!=this.navDataArr.length)if(console.log("跳转",this.navDataArr[t].appid),Laya.Browser.onWeiXin){var i=this;wx.JJNavigateToMiniProgram(()=>({appId:i.navDataArr[t].appid,path:i.navDataArr[t].path,id:i.navDataArr[t].id})).then(t=>{console.log("success"),a&&a(t)},t=>{console.log("fail",t),-1!=t.errMsg.indexOf("cancel")?e&&e(!0):e&&e(!1)})}else e&&e(!1)}getTitle(t,e=!0){return null==t?" ":e&&t.subtitle&&""!=t.subtitle?t.subtitle:t.title}updateDataConfig(t){var e=t.data;this.dataConfig.is_allow_area=t.is_allow_area,this.dataConfig.is_allow_export=t.is_allow_export,this.dataConfig.front_wuchu_scene=t.front_wuchu_scene;for(let t in e)this.dataConfig[t]=e[t].config_val;console.log(this.dataConfig)}updateNavData(t){this.navDataArr=[];for(var e=0;e<t.length;e++){var a=t[e],i=new A;i.appid=a.channel_game_appid,i.title=a.channel_game_name,i.path=a.path,i.subtitle=a.originality.copywriting,i.icon=a.originality.material,i.id=a.originality.id,this.navDataArr.push(i)}}get allowScene(){if(Laya.Browser.onWeiXin){var t=wx.getLaunchOptionsSync();console.log("当前场景：",t.scene);var e=!0;let a=x.instance.dataConfig.front_wuchu_scene;if(null==a&&(e=!0),-1==a.search("|")){e=parseInt(a)!=t.scene}let i=a.split("|");for(let a=0;a<i.length;a++){parseInt(i[a])==t.scene&&(e=!1)}return e}return!0}shuffleArr(t){let e=t.length;for(;e;){let a=Math.floor(Math.random()*e--);[t[a],t[e]]=[t[e],t[a]]}return t}addClickEvent(t,e,a,i,n){if(t.offAllCaller(e),t instanceof Laya.Button&&!n){let n=t=>{a&&a.call(e,t)};t.on(Laya.Event.CLICK,e,n,[i])}else{let n=60,s=t.scaleX,o=t.scaleY,r=.9,h=!1,l=e=>{h=!0,Laya.Tween.to(t,{scaleX:r,scaleY:r},n)};t.on(Laya.Event.MOUSE_DOWN,e,l,[i]);let d=i=>{0!=h&&(h=!1,Laya.Tween.to(t,{scaleX:s,scaleY:o},n),a&&a.call(e,i))};t.on(Laya.Event.MOUSE_UP,e,d,[i]);let c=e=>{Laya.Tween.to(t,{scaleX:s,scaleY:o},n)};t.on(Laya.Event.MOUSE_OUT,e,c,[i])}}toRotaion(t,e,a,i=!1,n=!1,s){if(t&&!t.destroyed){var o=t.rotation;!function(){if(i)var s=new Laya.Handler(this,rotate2);else if(n)var s=new Laya.Handler(this,rotate4);Laya.Tween.to(t,{rotation:e},a,null,s)}()}function rotate2(){t&&!t.destroyed&&Laya.Tween.to(t,{rotation:-e},2*a,null,Laya.Handler.create(this,rotate3))}function rotate3(){t&&!t.destroyed&&Laya.Tween.to(t,{rotation:e},2*a,null,Laya.Handler.create(this,rotate2))}function rotate4(){t&&!t.destroyed&&Laya.Tween.to(t,{rotation:o},a,null,Laya.Handler.create(this,()=>{s&&s()}))}}rewardClick(t,e,a){this.rewardCallback=t,this.cancelCallback=e,Laya.Browser.onWeiXin?a||0==this.shareCount?_.Instance.showVideoAd(a=>{a?t():e&&e()}):this.shareGame(e=>{e?(t(),this.shareCount-=1,Laya.LocalStorage.setItem("shareCount",JSON.stringify(this.shareCount))):this.showModal(this.shareFailContext)}):this.rewardCallback()}get shareFailContext(){return["请分享到活跃的群！","请分享到不同群！","请分享给好友！","请分享给20人以上的群！"][Math.floor(4*Math.random())]}showModal(t){if(Laya.Browser.onWeiXin){var e=this;Laya.Browser.window.wx.showModal({title:"提示",content:t,showCancel:!0,confirmText:"重新分享",success(t){t.confirm?(console.log("点击确定"),e.shareGame(e.rewardCallback)):t.cancel&&(console.log("点击取消"),e.cancelCallback&&e.cancelCallback())}})}}shareGame(t){if(Laya.Browser.onWeiXin){console.log("分享游戏");var e=x.instance.shareContext;this.JJShareAppMessage(e,t)}}regisiterWxCallback(){Laya.Browser.onWeiXin&&(Laya.Browser.window.wx.offShow(this.onShowEvent),Laya.Browser.window.wx.onShow(this.onShowEvent),Laya.Browser.window.wx.offHide(this.onHideEvent),Laya.Browser.window.wx.onHide(this.onHideEvent))}GetRandom(t,e,a=!0){let i=e-t+1,n=Math.random()*i;return n+=t,a?Math.floor(n):n}onShowEvent(t){x.instance.eventDispatcher.event("wx_awake_event")}onHideEvent(t){x.instance.eventDispatcher.event("wx_sleep_event")}showShareMenuWithTicket(t){Laya.Browser.onWeiXin&&wx.showShareMenu({withShareTicket:t,success:function(){},fail:function(){},complete:function(){}})}regisiterWXShareCallback(){if(Laya.Browser.onWeiXin){var t=this.shareContext;Laya.Browser.window.wx.onShareAppMessage(function(){return console.log("用户点击了转发按钮"),{title:t.title,imageUrl:t.image,query:"share_id=1",success:function(t){},fail:function(){}}})}}JJSendEvent(t,e){console.log("埋点：",t),this.dataConfig.front_report_event_point_switch&&Laya.Browser.onWeiXin&&wx.JJSendEvent(()=>({name:t,param:e}))}JJBannerAdShowCount(){Laya.Browser.onWeiXin&&wx.JJBannerAdShowCount(()=>({adUnitId:"",adUnitName:"banner",pageName:"all"}))}JJSendVideoAdCount(t,e){Laya.Browser.onWeiXin&&wx.JJSendVideoAdCount(()=>({adUnitId:_.Instance.videoId,adUnitName:e,isEnded:t}))}JJShareAppMessage(t,e){wx.JJShareAppMessage(()=>({title:t.title,imageUrl:t.imageUrl,id:t.id})).then(t=>{e(t)})}JJOnShareAppMessage(t){wx.JJOnShareAppMessage(()=>({title:t.title,imageUrl:t.imageUrl,id:t.id}))}refreshData(){let t=Laya.LocalStorage.getItem("dayTime");if(t)var e=Number(JSON.parse(t));else e=((new Date).getTime()-864e5)/864e5,Laya.LocalStorage.setItem("dayTime",JSON.stringify(e));var a=Math.floor((new Date).getTime()/864e5);e!=a?(console.log("刷新缓存数据"),Laya.LocalStorage.setItem("shareCount",JSON.stringify(this.dataConfig.front_share_number)),Laya.LocalStorage.setItem("dayTime",JSON.stringify(a))):this.dataConfig.front_share_number=JSON.parse(Laya.LocalStorage.getItem("shareCount"))}getRandomItemInArr(t){return t[Math.floor(Math.random()*t.length)]}}class A{}class I extends Laya.Scene{constructor(){super(),this.clickCount=0,this.lianxu_num=0,this.ccb=null,this.showCallback=null,this.hadShowBanner=!1,this.preTime=0,this.rateTime=0,this.isforce=!1}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.ccb=t.ccb,this.lianxu_num=t.lianxu_num,this.showUI()}onClosed(){Laya.Browser.onWeiXin&&window.wx.offShow(this.showCallback),Laya.timer.clearAll(this),this.lianxu_num>0?(this.lianxu_num--,Laya.timer.once(100,this,()=>{this.openAgain()})):this.ccb&&this.ccb()}openAgain(){Laya.Scene.open("JJExport/EndBoxUI.scene",!1,{lianxu_num:this.lianxu_num,ccb:this.ccb},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))}showUI(t){this.clickCount=0,this.minclicknum=Number(x.instance.dataConfig.front_box_clicks[0]),this.maxclicknum=Number(x.instance.dataConfig.front_box_clicks[1]),this.needClick=x.instance.GetRandom(this.minclicknum,this.maxclicknum-x.instance.dataConfig.front_progress_bar_reduce),this.isforce=x.instance.dataConfig.front_is_box_force,this.addProgerss=1/this.maxclicknum,S.Instance.addClickEvent(this.clickBtn,this,this.clickCB),console.log("this.needClick:",this.needClick),console.log("this.addProgerss:",this.addProgerss),v.Instance.hideBannerFun(!0),this.hadShowBanner=!1,this.pBar.value=0,this.rateTime=0,this.preTime=0,Laya.timer.frameLoop(1,this,this.DecBar),Laya.Browser.onWeiXin&&(this.showCallback=(()=>{this.close()}),window.wx.onShow(this.showCallback))}closeCB(){this.close()}clickCB(){if(this.clickCount++,this.pBar.value+=this.addProgerss,this.pBar.value>1&&(this.pBar.value=1),this.shakeBox(),!this.hadShowBanner){this.isforce=x.instance.dataConfig.front_is_box_force;let t=x.instance.dataConfig.front_box_hide_time,e=()=>{this.hadShowBanner=!0,Laya.timer.once(t,this,()=>{v.Instance.hideBannerFun(!0),Laya.Browser.onWeiXin&&this.isforce?(v.Instance.getIsAllError()&&this.closeCB(),this.hadShowBanner=!1):this.closeCB()}),v.Instance.showBanner()},a=this.rateTime-this.preTime,i=x.instance.dataConfig.front_box_sulv_qujian,n=this.getRandomItemInArr(i).split("|"),s=n[0],o=n[1];if(100*this.pBar.value>=x.instance.dataConfig.front_box_sulv_start&&parseFloat(s)<=a&&a<=parseFloat(o))return x.instance.dataConfig.front_sulv_wuchu_switch&&(this.isforce=!0,t=x.instance.dataConfig.front_fbox_hide_time),console.log("宝箱触发频率：",a),void e();if(this.preTime=this.rateTime,this.pBar.value>=this.needClick*this.addProgerss&&!this.hadShowBanner)return console.log("宝箱触发进度"),void e();this.clickCount>=x.instance.dataConfig.front_box_click_count&&(console.log("点击次数",this.clickCount),this.clickCount=0,e())}}shakeBox(){Laya.Tween.to(this.box,{rotation:-10},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.box,{rotation:10},200,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.box,{rotation:0},100,null,Laya.Handler.create(this,()=>{}))}))}))}DecBar(){this.updateTest(),this.pBar.value-=x.instance.dataConfig.front_progress_bar_return,this.pBar.value<0&&(this.pBar.value=0)}updateTest(){this.rateTime+=Laya.timer.delta/1e3}GetRandom(t,e,a=!0){let i=e-t,n=Math.random()*i;return n+=t,a?Math.floor(n):n}getRandomItemInArr(t){return t[Math.floor(Math.random()*t.length)]}}class B extends Laya.Script{constructor(){super()}onAwake(){this.myOwnwer=this.owner,this.scaleLoop(this.myOwnwer,1.1,400)}scaleLoop(t,e,a){Laya.Tween.to(t,{scaleX:e,scaleY:e},a,null,new Laya.Handler(this,()=>{Laya.Tween.to(t,{scaleX:1,scaleY:1},a,null,new Laya.Handler(this,()=>{this.scaleLoop(t,e,a)}))}))}}class k extends Laya.Script{constructor(){super()}onAwake(){this.myOwnwer=this.owner,this.rotateLoop(this.myOwnwer,3e3)}rotateLoop(t,e){Laya.Tween.to(t,{rotation:360},e,null,new Laya.Handler(this,()=>{this.myOwnwer.rotation=0,this.rotateLoop(t,e)}))}}class M extends Laya.Scene{constructor(){super(...arguments),this.navData=[],this.hotArr=[],this.fingerId=0}onOpened(t){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),t&&t.posY&&(this.navList.y=t.posY),this.initList()}updateNavData(){this.fingerId=Math.floor(6*Math.random()),this.navData=[].concat(x.instance.shuffleArr(x.instance.navDataArr)).slice(0,6),this.hotArr=[];for(let t=0;t<this.navData.length;t++)this.hotArr.push(t);this.hotArr=this.getRandomItemInArrWithoutSelf(-1,this.hotArr,4),this.navList.array=this.navData}initList(){this.fingerId=Math.floor(6*Math.random()),this.navData=[].concat(x.instance.shuffleArr(x.instance.navDataArr)).slice(0,6),this.hotArr=[];for(let t=0;t<this.navData.length;t++)this.hotArr.push(t);this.hotArr=this.getRandomItemInArrWithoutSelf(-1,this.hotArr,2),this.navList.vScrollBarSkin="",this.navList.repeatX=3,this.navList.repeatY=2,this.navList.array=this.navData,this.navList.renderHandler=Laya.Handler.create(this,this.onListRender,null,!1),Laya.timer.once(1e3,this,()=>{this.showTween()})}onListRender(t,e){if(!(e>=this.navList.array.length)){var a=t.getChildByName("item"),i=a.getChildByName("icon");a.getChildByName("finger").visible=e==this.fingerId,a.getChildByName("hot").visible=-1!=this.hotArr.indexOf(e),i.skin=this.navData[e].icon,e=x.instance.navDataArr.indexOf(this.navData[e]),a.off(Laya.Event.CLICK,this,this.navCB,[e]),a.on(Laya.Event.CLICK,this,this.navCB,[e])}}navCB(t){console.log("click id:",t),x.instance.NavigateApp(t,()=>{S.Instance.NewWuchu&&x.instance.dataConfig.front_quxiao_switch&&S.Instance.clickFinishMoreGame()},()=>{}),this.updateNavData()}showTween(){var t=Math.floor(Math.random()*this.navData.length),e=this.navList.cells[t];e.rotation=0,x.instance.toRotaion(e,20,150,!1,!0),Laya.timer.once(300,this,()=>{e.rotation=0,x.instance.toRotaion(e,-20,150,!1,!0),Laya.timer.once(300,this,()=>{e.rotation=0,x.instance.toRotaion(e,10,50,!1,!0),Laya.timer.once(100,this,()=>{e.rotation=0,x.instance.toRotaion(e,-10,50,!1,!0),Laya.timer.once(300,this,()=>{this.updateNavData()})})})}),Laya.timer.once(4e3,this,this.showTween)}onClosed(){Laya.timer.clear(this,this.showTween)}shuffleArr(t){let e=t.length;for(;e;){let a=Math.floor(Math.random()*e--);[t[a],t[e]]=[t[e],t[a]]}return t}getRandomItemInArrWithoutSelf(t,e,a=1){let i=[].concat(e);return i.splice(i.indexOf(t),1),(i=this.shuffleArr(i)).slice(0,a)}}class P extends Laya.Scene{constructor(){super(),this.navList=this.navList,this.navData=[],this.scrollDir=1,this.preIndex=-1,this.hotArr=[]}onOpened(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.initList()}onClosed(){Laya.timer.clearAll(this)}initList(){this.navData=[].concat(x.instance.navDataArr);for(let t=0;t<this.navData.length;t++)this.hotArr.push(t);this.hotArr=this.getRandomItemInArrWithoutSelf(-1,this.hotArr,4),this.navList.hScrollBarSkin="",this.navList.repeatX=this.navData.length,this.navList.repeatY=1,this.navList.array=this.navData,this.navList.renderHandler=Laya.Handler.create(this,this.onListRender,null,!1),this.navList.mouseHandler=new Laya.Handler(this,this.mouseHandler),this.scrollLoop()}mouseHandler(t,e){Laya.timer.clear(this,this.scrollLoop),Laya.timer.once(1e3,this,this.scrollLoop)}scrollLoop(){Laya.timer.once(1e3,this,()=>{let t=Math.floor(this.navList.startIndex);1==this.scrollDir?++t>=this.navData.length-4&&(this.scrollDir=-this.scrollDir):--t<0&&(this.scrollDir=-this.scrollDir),this.navList.tweenTo(t,1e3,Laya.Handler.create(this,this.scrollLoop))})}onListRender(t,e){if(!(e>=this.navList.array.length)){var a=t.getChildByName("item");a.getChildByName("hot").visible=-1!=this.hotArr.indexOf(e),a.skin=this.navData[e].icon,a.off(Laya.Event.CLICK,this,this.navCB,[e]),a.on(Laya.Event.CLICK,this,this.navCB,[e])}}navCB(t){console.log("click id:",t),x.instance.NavigateApp(t,()=>{S.Instance.NewWuchu&&x.instance.dataConfig.front_quxiao_switch&&S.Instance.clickFinishMoreGame()})}shuffleArr(t){let e=t.length;for(;e;){let a=Math.floor(Math.random()*e--);[t[a],t[e]]=[t[e],t[a]]}return t}getRandomItemInArrWithoutSelf(t,e,a=1){let i=[].concat(e);return i.splice(i.indexOf(t),1),(i=this.shuffleArr(i)).slice(0,a)}}class T extends Laya.Scene{constructor(){super(),this.ccb=null,this.hadClick=!1,this.isShowHide=!1}onAwake(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight)}onOpened(t){let a=!1;t&&(t.ccb&&(this.ccb=t.ccb),t.isMoreGame&&(a=t.isMoreGame)),a||S.Instance.NewWuchu2&&x.instance.dataConfig.front_all_gezi_switch?(e.instance.showGrid(),t.isInterAd&&S.Instance.NewWuchu&&x.instance.dataConfig.front_wx_chaping_switch&&_.Instance.showInterAd(),S.Instance.addClickEvent(this.continueBtn,this,this.continueBtnCB),this.isShowHide=100*Math.random()<x.instance.dataConfig.front_hot_youxi,x.instance.dataConfig.is_allow_area&&S.Instance.allowScene&&this.isShowHide&&v.Instance.showHideBanner()):this.continueBtnCB()}onClosed(){v.Instance.clearShowHideBanner(),Laya.timer.clearAll(this),this.ccb&&this.ccb()}continueBtnCB(){S.Instance.NewWuchu&&this.isShowHide&&!this.hadClick?this.hadClick=!0:(e.instance.hideGrid(),this.visible=!1,Laya.timer.once(100,this,()=>{this.close()}))}}class E extends Laya.Scene{constructor(){super(),this.ccb=null,this.hadClick=!1,this.isShowHide=!1}onAwake(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight)}onClosed(){Laya.timer.clearAll(this),this.ccb&&this.ccb()}onOpened(t){let a=!1;if(t&&(t.ccb&&(this.ccb=t.ccb),t.isFinishUI&&(a=t.isFinishUI)),!S.Instance.NewWuchu2||!x.instance.dataConfig.front_gezi_two_switch)return this.visible=!1,void Laya.timer.once(100,this,()=>{this.close()});e.instance.showGrid(),S.Instance.addClickEvent(this.giveupBtn,this,this.continueBtnCB),this.isShowHide=100*Math.random()<x.instance.dataConfig.front_hot_tuijian,x.instance.dataConfig.is_allow_area&&S.Instance.allowScene&&this.isShowHide&&v.Instance.showHideBanner()}continueBtnCB(){S.Instance.NewWuchu&&this.isShowHide&&!this.hadClick?this.hadClick=!0:(v.Instance.clearShowHideBanner(),e.instance.hideGrid(),this.visible=!1,Laya.timer.once(100,this,()=>{this.close()}))}adBtnCB(){this.continueBtnCB()}}class N extends Laya.Scene{constructor(){super(),this.ccb=null,this.hadClick=!1,this.isShowHide=!1}onAwake(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight)}onClosed(){Laya.timer.clearAll(this),this.ccb&&this.ccb()}onOpened(t){if(t&&t.ccb&&(this.ccb=t.ccb),!S.Instance.NewWuchu2||!x.instance.dataConfig.front_play_gezi_switch)return this.visible=!1,void Laya.timer.once(100,this,()=>{this.close()});e.instance.showGrid(),S.Instance.addClickEvent(this.adBtn,this,this.adBtnCB),this.isShowHide=100*Math.random()<x.instance.dataConfig.front_hot_xiaochengxu,x.instance.dataConfig.is_allow_area&&S.Instance.allowScene&&this.isShowHide&&v.Instance.showHideBanner()}continueBtnCB(){S.Instance.NewWuchu&&this.isShowHide&&!this.hadClick?this.hadClick=!0:(v.Instance.clearShowHideBanner(),e.instance.hideGrid(),this.visible=!1,Laya.timer.once(100,this,()=>{this.close()}))}adBtnCB(){this.continueBtnCB()}}class J extends Laya.Scene{constructor(){super(),this.ccb=null,this.hadClick=!1,this.isShowHide=!1}onAwake(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight)}onClosed(){Laya.timer.clearAll(this),this.ccb&&this.ccb()}onOpened(t){if(t&&t.ccb&&(this.ccb=t.ccb),!S.Instance.NewWuchu2||!x.instance.dataConfig.front_play_gezi_switch)return this.visible=!1,void Laya.timer.once(100,this,()=>{this.close()});this.testGrid(),Laya.timer.loop(1e3,this,this.testGrid),S.Instance.addClickEvent(this.adBtn,this,this.adBtnCB),S.Instance.NewWuchu2&&v.Instance.showHideBanner()}testGrid(){e.instance.gridAdArr.length>0&&!this.hadShow&&(this.hadShow=!0,e.instance.showGrid())}continueBtnCB(){!S.Instance.NewWuchu||this.hadClick?(v.Instance.clearShowHideBanner(),e.instance.hideGrid(),this.visible=!1,Laya.timer.once(100,this,()=>{this.close()})):this.hadClick=!0}adBtnCB(){this.continueBtnCB()}}class D extends Laya.Scene{constructor(){super(),this.ccb=null,this.hadClick=!1}onOpened(t){if(t&&t.ccb&&(this.ccb=t.ccb),!S.Instance.NewWuchu||!x.instance.dataConfig.front_run_switch)return this.visible=!1,void Laya.timer.once(100,this,()=>{this.close()});S.Instance.addClickEvent(this.getBtn,this,this.getBtnCB),S.Instance.addClickEvent(this.adBtn,this,this.adBtnCB),this.gsMove(),v.Instance.showBanner()}onAwake(){this.size(Laya.stage.displayWidth,Laya.stage.displayHeight)}onClosed(){v.Instance.hideBanner(),Laya.timer.clearAll(this),Laya.Tween.clearAll(this.gsNode),Laya.Tween.clearAll(this.renNode),this.ccb&&this.ccb()}gsMove(){Laya.Tween.to(this.gsNode,{x:650},500,null,new Laya.Handler(this,()=>{Laya.Tween.to(this.gsNode,{x:850},1e3,null,new Laya.Handler(this,()=>{Laya.Tween.to(this.gsNode,{x:750},500,null,new Laya.Handler(this,()=>{this.gsMove()}))}))}))}renMove1(){Laya.Tween.to(this.renNode,{x:124},500,null,new Laya.Handler(this,()=>{Laya.Tween.to(this.renNode,{x:324},1e3,null,new Laya.Handler(this,()=>{Laya.Tween.to(this.renNode,{x:224},500,null,new Laya.Handler(this,()=>{this.renMove1()}))}))}))}renMove2(t=!1){t&&this.ren.play(0,!0,"ani2"),Laya.Tween.clearAll(this.renNode),this.renNode.x=224,Laya.Tween.to(this.renNode,{x:-276},t?500:1e3,null,new Laya.Handler(this,()=>{this.close()}))}getBtnCB(){this.renMove2()}adBtnCB(){_.Instance.showVideoAd(()=>{this.renMove2(!0)})}}class H extends Laya.Scene{constructor(){super(),this.clickCount=0,this.lianxu_num=0,this.ccb=null,this.showCallback=null,this.hadShowBanner=!1,this.preTime=0,this.rateTime=0,this.isforce=!1}onClosed(){Laya.Browser.onWeiXin&&window.wx.offShow(this.showCallback),Laya.timer.clearAll(this),e.instance.hideGrid(),v.Instance.hideBannerFun(!0),this.lianxu_num>0?(this.lianxu_num--,Laya.timer.once(100,this,()=>{this.openAgain()})):this.ccb&&this.ccb()}openAgain(){Laya.Scene.open("JJExport/StartBoxUI.scene",!1,{lianxu_num:this.lianxu_num,ccb:this.ccb},Laya.Handler.create(this,t=>{Laya.stage.addChild(t)}))}onOpened(t){this.clickCount=0,this.size(Laya.stage.displayWidth,Laya.stage.displayHeight),this.minclicknum=Number(x.instance.dataConfig.front_box_clicks[0]),this.maxclicknum=Number(x.instance.dataConfig.front_box_clicks[1]),this.needClick=x.instance.GetRandom(this.minclicknum,this.maxclicknum-x.instance.dataConfig.front_progress_bar_reduce),this.isforce=x.instance.dataConfig.front_is_box_force,this.addProgerss=1/this.maxclicknum,S.Instance.addClickEvent(this.clickBtn,this,this.clickCB),console.log("this.needClick:",this.needClick),console.log("this.addProgerss:",this.addProgerss),v.Instance.hideBannerFun(!0),this.ccb=t.ccb,this.lianxu_num=t.lianxu_num,this.hadShowBanner=!1,this.pBar.value=0,this.rateTime=0,this.preTime=0,Laya.timer.frameLoop(1,this,this.DecBar),Laya.Browser.onWeiXin&&(this.showCallback=(()=>{this.close()}),window.wx.onShow(this.showCallback)),v.Instance.showBanner()}closeCB(){this.close()}clickCB(){if(this.clickCount++,this.pBar.value+=this.addProgerss,this.pBar.value>1&&(this.pBar.value=1),this.shakeBox(),!this.hadShowBanner){this.isforce=x.instance.dataConfig.front_is_box_force;let t=x.instance.dataConfig.front_box_hide_time,a=()=>{this.hadShowBanner=!0,Laya.timer.once(t,this,()=>{e.instance.hideGrid(),Laya.Browser.onWeiXin&&this.isforce?(e.instance.getIsError()&&this.closeCB(),this.hadShowBanner=!1):this.closeCB()}),e.instance.showGrid()},i=this.rateTime-this.preTime,n=x.instance.dataConfig.front_box_sulv_qujian,s=this.getRandomItemInArr(n).split("|"),o=s[0],r=s[1];if(100*this.pBar.value>=x.instance.dataConfig.front_box_sulv_start&&parseFloat(o)<=i&&i<=parseFloat(r))return console.log("宝箱触发频率：",i),x.instance.dataConfig.front_sulv_wuchu_switch&&(this.isforce=!0,t=x.instance.dataConfig.front_fbox_hide_time),void a();if(this.preTime=this.rateTime,this.pBar.value>=this.needClick*this.addProgerss&&!this.hadShowBanner)return console.log("宝箱触发进度"),void a();this.clickCount>=x.instance.dataConfig.front_box_click_count&&(console.log("点击次数",this.clickCount),this.clickCount=0,a())}}shakeBox(){Laya.Tween.to(this.box,{rotation:-10},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.box,{rotation:10},200,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.box,{rotation:0},100,null,Laya.Handler.create(this,()=>{}))}))}))}DecBar(){this.updateTest(),this.pBar.value-=x.instance.dataConfig.front_progress_bar_return,this.pBar.value<0&&(this.pBar.value=0)}updateTest(){this.rateTime+=Laya.timer.delta/1e3}GetRandom(t,e,a=!0){let i=e-t,n=Math.random()*i;return n+=t,a?Math.floor(n):n}getRandomItemInArr(t){return t[Math.floor(Math.random()*t.length)]}}class O{static on(t,e,a,i){this.eventDispatcher.on(t,e,a,i)}static event(t,e){this.eventDispatcher.event(t,e)}static off(t,e,a){this.eventDispatcher.off(t,e,a)}static offAllCaller(t){this.eventDispatcher.offAllCaller(t)}}O.eventDispatcher=new Laya.EventDispatcher;class R extends Laya.Scene{onAwake(){this.size(Laya.stage.width,Laya.stage.height),this.init(),this.initEvent()}onClosed(){O.offAllCaller(this),Laya.timer.clearAll(this)}init(){}initEvent(){}}class G{static toAlpha(t,e,a,i,n,s,o=!1,r=!1){function alpha1(){let e=r||o?new Laya.Handler(this,alpha2):new Laya.Handler(this,()=>{s&&s(),s=null});Laya.Tween.to(t,{alpha:a},i,n,e)}function alpha2(){let a=r?new Laya.Handler(this,alpha1):new Laya.Handler(this,()=>{s&&s(),s=null});Laya.Tween.to(t,{alpha:e},i,n,a)}t&&!t.destroyed&&(this.clearTween(t),t.alpha=e,alpha1())}static toScale(t,e,a,i,n,s,o=!1,r=!1){function scale1(){let e=r||o?new Laya.Handler(this,scale2):new Laya.Handler(this,()=>{s&&s(),s=null});Laya.Tween.to(t,{scaleX:a,scaleY:a},i,n,e)}function scale2(){let a=r?new Laya.Handler(this,scale1):new Laya.Handler(this,()=>{s&&s(),s=null});Laya.Tween.to(t,{scaleX:e,scaleY:e},i,n,a)}t&&!t.destroyed&&(this.clearTween(t),t.scale(e,e),scale1())}static toPosition(t,e,a,i,n,s=!1,o=0){if(!t||t.destroyed)return;this.clearTween(t);let r={},h={};function pos1(){if(s)var e=0==o?new Laya.Handler(this,pos2):new Laya.Handler(this,pos3);else e=new Laya.Handler(this,()=>{n&&n(),n=null});Laya.Tween.to(t,h,a,i,e)}function pos2(){Laya.Tween.to(t,r,a,i,Laya.Handler.create(this,pos1))}function pos3(){t.pos(r.x,r.y),pos1()}null!=e.x&&(r.x=t.x,h.x=e.x),null!=e.y&&(r.y=t.y,h.y=e.y),pos1()}static toRotaion(t,e,a,i,n,s=!1,o=!1){if(!t||t.destroyed)return;this.clearTween(t);let r=t.rotation,h=r+e,l=r-e+r;function rotate2(){Laya.Tween.to(t,{rotation:l},2*a,i,Laya.Handler.create(this,rotate3))}function rotate3(){Laya.Tween.to(t,{rotation:h},2*a,i,Laya.Handler.create(this,rotate2))}function rotate4(){let e=new Laya.Handler(this,()=>{n&&n(),n=null});Laya.Tween.to(t,{rotation:r},a,i,e)}!function(){let e=o?new Laya.Handler(this,rotate2):s?new Laya.Handler(this,rotate4):new Laya.Handler(this,()=>{n&&n(),n=null});Laya.Tween.to(t,{rotation:h},a,i,e)}()}static showViewByScale(t,e,a=1,i=200){this.toScale(t,0,a,i,Laya.Ease.bounceOut,e,!0,!1)}static clearTween(t){Laya.Tween.clearAll(t)}}class F extends R{constructor(){super(...arguments),this.value=0}init(){F.instance=this}initEvent(){}showAddClip(){this.value++,this.showClip.value="+"+this.value.toString(),this.showClip.alpha=1,Laya.timer.clear(this,this.showClipCool1),G.toScale(this.showClip,0,1,500,Laya.Ease.elasticOut,()=>{Laya.timer.once(500,this,this.showClipCool1)})}showClipCool1(){let t=this;G.toAlpha(this.showClip,1,0,500,null,()=>{t.value=0})}}!function(t){t.Load="scenes/Load.scene",t.Home="scenes/Home.scene",t.Game="scenes/Game.scene",t.Over="scenes/Over.scene"}(r||(r={})),function(t){t.SubPackage="分包",t.Scene3D="3D场景",t.SDK="SDK"}(h||(h={})),function(t){t.Scene_GoHome="Scene_GoHome",t.Scene_GoGame="Scene_GoGame",t.Scene_GoOver="Scene_GoOver",t.Progress_Load_Update="Progress_Load_Update",t.Platform_Wake_Do="Platform_Wake_Do",t.Platform_Hide_Do="Platform_Hide_Do",t.Game_Coin_Update="Game_Coin_Update",t.Game_RoadToEnd_Event="Game_RoadToEnd_Event",t.Game_Over_Event="Game_Over_Event",t.Game_SkinChange_Event="Game_SkinChange_Event",t.Game_Progress_Event="Game_Progress_Event",t.Game_CountChange_Event="Game_CountChange_Event",t.Game_AddMoneyCount_Event="Game_AddMoneyCount_Event"}(l||(l={})),function(t){t.Bgm="Bgm",t.Button="Button",t.Get="Get",t.Fail="Fail",t.Fill="Fill",t.Full="Full",t.GetMoney="GetMoney",t.Obstacle="Obstacle",t.Win="Win"}(d||(d={})),function(t){t.Battery="Item_Battery"}(c||(c={})),function(t){t[t.Battery=0]="Battery"}(u||(u={})),function(t){t.Obs1_Battery="Obs1_Battery",t.Obs2_Battery="Obs2_Battery",t.StartPoint="StartPoint",t.EndPoint="EndPoint",t.Obs_BatteryPit="Obs_BatteryPit",t.PowerBank_1="PowerBank_1",t.PowerBank_2="PowerBank_2",t.RemoteControl="RemoteControl",t.Bunny="Bunny",t.Kaktus="Kaktus",t.Musicbox="Musicbox",t.SawBlade="SawBlade",t.SawBlade_Move="SawBlade_Move",t.Obstacle="Obstacle",t.Clapboard="Clapboard"}(m||(m={}));class z{static soldDeal(t){let e=0;return e+=1,1}}z.itemAxisSize=.8,z.itemHorizontalSize=2,z.coinUrl="ui/game/gold.png",z.musicTime=38e3,z.upgradeCost=[100,200,400,700,1100,160,2200];class V{constructor(){this.tween=new Laya.Tween,this.tweens=[]}getTimeByFrame(t){return Math.round(10*t)}toTween(t,e,a,i,n,s=!0){if(this.target=t,this.isLocal=s,t&&!t.destroyed){var o={},r={};if(e.pos){var h=s?t.transform.localPosition.clone():t.transform.position.clone();o.posX=h.x,o.posY=h.y,o.posZ=h.z,r.posX=e.pos.x,r.posY=e.pos.y,r.posZ=e.pos.z}if(e.rot){var l=s?t.transform.localRotation.clone():t.transform.rotation.clone();o.rotX=l.x,o.rotY=l.y,o.rotZ=l.z,o.rotW=l.w,r.rotX=e.rot.x,r.rotY=e.rot.y,r.rotZ=e.rot.z,r.rotW=e.rot.w}if(e.sca){var d=t.transform.getWorldLossyScale().clone();o.scaX=d.x,o.scaY=d.y,o.scaZ=d.z,r.scaX=e.sca.x,r.scaY=e.sca.y,r.scaZ=e.sca.z}this.tween.to(o,{posX:r.posX,posY:r.posY,posZ:r.posZ,rotX:r.rotX,rotY:r.rotY,rotZ:r.rotZ,rotW:r.rotW,scaX:r.scaX,scaY:r.scaY,scaZ:r.scaZ},a,n,Laya.Handler.create(this,()=>{i&&i();var e=this.tweens.shift();t&&!t.destroyed&&(e?this.toTween(this.target,e.value,e.time,e.completeFun,n):this.updateTweenCallback&&(this.updateTweenCallback=null))}));var c=0;return this.tween.update=new Laya.Handler(this,()=>{if(!t||t.destroyed)return;let i=(c+=Laya.timer.delta)/a;i>1&&(i=1),e.pos&&(s?t.transform.localPosition=new Laya.Vector3(o.posX,o.posY,o.posZ):t.transform.position=new Laya.Vector3(o.posX,o.posY,o.posZ)),e.rot&&(s?t.transform.localRotation=new Laya.Quaternion(o.rotX,o.rotY,o.rotZ,o.rotW):t.transform.rotation=new Laya.Quaternion(o.rotX,o.rotY,o.rotZ,o.rotW)),e.sca&&t.transform.setWorldLossyScale(new Laya.Vector3(o.scaX,o.scaY,o.scaZ)),this.updateTweenCallback&&this.updateTweenCallback(i)}),this}}clearTween(t){this.tweens=[],this.tween.clear(),this.target&&t&&(t.pos&&(this.isLocal?this.target.transform.localPosition=new Laya.Vector3(t.pos.x,t.pos.y,t.pos.z):this.target.transform.position=new Laya.Vector3(t.pos.x,t.pos.y,t.pos.z)),t.rot&&(this.target.transform.rotation=new Laya.Quaternion(t.rot.x,t.rot.y,t.rot.z,t.rot.w)),t.sca&&this.target.transform.setWorldLossyScale(new Laya.Vector3(t.sca.x,t.sca.y,t.sca.z)))}then(t,e,a){return this.tweens.push({value:t,time:e,completeFun:a}),this}toScaleTween(t,e,a,i,n,s=Laya.Ease.elasticOut){t&&!t.destroyed&&(t.transform.localScale=e,this.toTween(t,{sca:a},i,n,s))}}class U extends Laya.Script3D{onAwake(){this.self=this.owner,this.selfTween=new V,this.init()}init(...t){}onDestroy(){Laya.timer.clearAll(this),this.selfTween.clearTween(),O.offAllCaller(this)}tweenBornDo(){let t=this.selfTween;t.clearTween(),this.self.transform.localScale=new Laya.Vector3(0,0,0),t.toTween(this.self,{sca:new Laya.Vector3(1,1,1)},500,null,Laya.Ease.elasticOut)}tweenBornDo_Smooth(){let t=this.selfTween;t.clearTween(),this.self.transform.localScale=new Laya.Vector3(0,0,0),t.toTween(this.self,{sca:new Laya.Vector3(1,1,1)},250,null)}}class W{static bornStageObj(t,e=this.mainScene){let a=this.prefabs.getChildByName(t);if(!a)return console.warn("生成物体不存在",t),null;let i=Laya.Sprite3D.instantiate(a,e);return i.transform.localPosition=new Laya.Vector3,this.stageObj.push(i),this.fxPool=[],i}static stageObjClear(){for(let t=this.stageObj.length-1;t>=0;t--)this.stageObj[t]&&!this.stageObj[t].destroyed&&this.stageObj[t].destroy();this.stageObj=[]}static bornFxDestroy(t,e,a=1e3,i=1,n=new Laya.Vector3){if(!this.isFxOn)return null;let s=this.fxs.getChildByName(t).clone();return e.addChild(s),s.transform.localPosition=n,s.transform.localRotationEuler=new Laya.Vector3,s.transform.localScale=new Laya.Vector3(i,i,i),Laya.timer.once(a,this,()=>{s.destroy()}),s}static bornFxFromPool(t,e,a=1e3,i=1,n=new Laya.Vector3){let s;for(let e=this.fxPool.length-1;e>=0;e--)if(this.fxPool[e].name==t){(s=this.fxPool.splice(e,1)[0]).active=!0;break}if(!s){let e=this.fxs.getChildByName(t);s=e.clone()}return e.addChild(s),this.stageObj.push(s),s.transform.localPosition=n,s.transform.localRotationEuler=new Laya.Vector3,s.transform.localScale=new Laya.Vector3(i,i,i),Laya.timer.once(a,this,()=>{s&&!s.destroyed&&(this.mainScene.addChild(s),s.active=!1,this.fxPool.push(s))}),s}static bornFxStage(t,e,a=1,i=new Laya.Vector3){let n=this.fxs.getChildByName(t).clone();return e.addChild(n),n.transform.localPosition=i,n.transform.localRotationEuler=new Laya.Vector3,n.transform.localScale=new Laya.Vector3(a,a,a),this.stageObj.push(n),n}}W.stageObj=[],W.isFxOn=!0,W.fxPool=[];class X{static add(t,e){var a=new Laya.Vector3;return Laya.Vector3.add(t,e,a),a.clone()}static subtract(t,e){var a=new Laya.Vector3;return Laya.Vector3.subtract(t,e,a),a.clone()}static mull(t,e){var a=new Laya.Vector3;return Laya.Vector3.scale(t,e,a),a.clone()}static dot(t,e){return Laya.Vector3.dot(t,e)}static cross(t,e){var a=new Laya.Vector3;return Laya.Vector3.cross(t,e,a),a.clone()}static normalized(t){var e=new Laya.Vector3;return Laya.Vector3.normalize(t,e),e.clone()}static distance(t,e){var a=X.subtract(t,e);return Laya.Vector3.scalarLength(a)}}class j{constructor(){this.pos=new Laya.Vector3,this.rot=new Laya.Quaternion,this.state="empty"}}class Y extends U{updateCul(){let t=null,e=0;for(let a=0;a<this.self.numChildren;a++){let i=this.self.getChildAt(a);if(null!=t){let a=i.transform.position.clone(),n=i.transform.rotation.clone(),s=t.transform.position.clone();t.transform.rotation.clone();if(-1==i.name.indexOf("circle"))e+=X.distance(a,s),this.endPos=a,this.endRot=n;else{i.name.split("_");let t=a,o=X.distance(t,s),r=new Laya.Vector3(0,1,0),h=X.normalized(X.subtract(t,s)),l=X.cross(h,r),d=X.mull(h,o),c=X.mull(l,o),u=X.add(d,c),m=X.add(s,u);e+=Math.PI/2*o,this.endPos=m,this.endRot=n}}t=i}this.roadLength=e}getPathNowPos(t,e){let a=new j,i=new Laya.Vector3,n=new Laya.Quaternion,s=null;for(let e=0;e<this.self.numChildren;e++){let a=this.self.getChildAt(e),o=0;if(null!=s){let e=a.transform.position.clone(),r=a.transform.rotation.clone(),h=s.transform.position.clone(),l=s.transform.rotation.clone();if(-1==a.name.indexOf("circle")){if(t<(o=X.distance(e,h))){let a=X.normalized(X.subtract(e,h));i=X.add(h,X.mull(a,t)),n=r;break}}else{let a=e,s=X.distance(a,h);if(t<(o=Math.PI/2*s)){let e=X.normalized(X.subtract(a,h)),d=new Laya.Vector3(0,1,0),c=X.cross(e,d),u=t/o,m=Math.PI/2*u,g=X.mull(e,s*(1-Math.cos(m))),y=X.mull(c,s*Math.sin(m)),f=X.add(g,y);i=X.add(h,f),Laya.Quaternion.lerp(l,r,u,n);break}}}t-=o,s=a}return a.pos=i,a.rot=n,a}}!function(t){t.Road_1="Road_1",t.Road_2="Road_2",t.Road_3="Road_3",t.Road_4="Road_4",t.Road_5="Road_5"}(g||(g={}));class q extends U{updateLength(){this.roadLength=0;let t=this.self.transform.position.clone(),e=this.self.transform.rotation.clone(),a=this.self.getChildByName("Roads");for(let i=0;i<a.numChildren;i++){let n=a.getChildAt(i);n.transform.position=t,n.transform.rotation=e;let s=n.getChildByName("Path").getComponent(Y);s.updateCul(),t=s.endPos,e=s.endRot,this.roadLength+=s.roadLength}this.endPos=t,this.endRot=e}}class Q extends U{constructor(){super(...arguments),this.endAxis=0}setUpdate(){let t=this.self.transform.position.clone(),e=this.self.transform.rotation.clone();this.endAxis=0;for(let a=0;a<this.self.numChildren;a++){let i=this.self.getChildAt(a);i.transform.position=t,i.transform.rotation=e;let n=i.getComponent(q);n.updateLength(),t=n.endPos,e=n.endRot,this.endAxis+=n.roadLength}}getNowPos(t,e){let a=new j,i=new Laya.Vector3,n=new Laya.Quaternion;if(t<0)return a.pos=i,a.rot=n,a.state="startPoint",a;let s=null;for(let e=0;e<this.self.numChildren;e++)if(s=this.self.getChildAt(e).getComponent(q)){if(t<s.roadLength)break;t-=s.roadLength,s=null}if(null!=s)for(let i=0;i<s.self.getChildByName("Roads").numChildren;i++){let n=s.self.getChildByName("Roads").getChildAt(i);if(-1!=n.name.indexOf("Road")){let i=n.getChildByName("Path").getComponent(Y);if(t<i.roadLength){(a=i.getPathNowPos(t,e)).state=s.self.name+"_"+n.name+"_"+t.toString();break}t-=i.roadLength}}else{t=(s=this.self.getChildAt(this.self.numChildren-1).getComponent(q)).roadLength-1e-4;for(let i=0;i<s.self.getChildByName("Roads").numChildren;i++){let n=s.self.getChildByName("Roads").getChildAt(i);if(-1!=n.name.indexOf("Road")){let i=n.getChildByName("Path").getComponent(Y);if(t<i.roadLength){a=i.getPathNowPos(t,e);break}t-=i.roadLength}}a.state="endPoint"}return a}}class Z extends U{constructor(){super(...arguments),this.axis=0,this.horizontal=0}init(...t){this.model=this.self.getChildByName("Model"),this.model||(this.model=this.self.getChildAt(0))}go(){if(null!=this.stage){let t=this.stage.getNowPos(this.axis,this.horizontal);this.self.transform.position=t.pos,this.self.transform.rotation=t.rot,this.model||(this.model=this.self.getChildAt(0)),this.model&&(this.model.transform.localPosition=new Laya.Vector3(-this.horizontal,this.model.transform.localPosition.y,this.model.transform.localPosition.z),this.model.transform.localRotation=new Laya.Quaternion)}else W.stage&&(this.stage=W.stage.getComponent(Q))}}class K extends U{constructor(){super(...arguments),this.forwardSpeed_Data=2,this.speedAxis=1,this.isCamCtrl=!0,this.isMove=!1,this.axis=0,this.horizontal=0,this.modelMoveRange=10-z.itemHorizontalSize,this.camPointMoveRange=2,this.forwardSpeed=0,this.horizontalSensity=.12,this.forwardSensity=.15,this.wayAxis=0,this.targetYpos=0,this.lastHorizontal=0,this.horizontalDt=0,this.targetHorizontal=0,this.inHorizontal=0,this.isHit=!1,this.hitTime=250}init(){K.instance=this,this.player=this.self,this.model=this.player.getChildByName("Model"),this.camPoint=this.player.getChildByName("CamPoint"),this.startCamPoint=this.player.getChildByName("CamStartPoint"),this.endCamPoint=this.player.getChildByName("CamEndPoint"),this.forwardSpeed=this.forwardSpeed_Data,this.posSet=this.player.getComponent(Z)}reset(t,e){this.isHit=!1,this.axis=t,this.horizontal=e,this.targetHorizontal=e,this.lastHorizontal=e,this.speedAxis=1,this.horizontalDt=0,this.posSet.axis=t,this.posSet.horizontal=this.modelMoveRange*this.horizontal,this.posSet.go(),this.model.transform.localRotation=new Laya.Quaternion}onUpdate(){let t=Laya.timer.delta/16;if(this.forwardSpeed>=0?this.isMove&&(this.axis+=this.forwardSpeed*this.forwardSensity*t*this.speedAxis):this.forwardSpeed<0&&(this.axis+=this.forwardSpeed*this.forwardSensity*t*this.speedAxis),this.wayAxis=this.targetHorizontal-this.horizontal,this.horizontal+=this.wayAxis*this.horizontalSensity*t,this.horizontalDt=this.horizontal-this.lastHorizontal,this.lastHorizontal=this.horizontal,this.isMove&&(this.posSet.axis=this.axis),this.posSet.horizontal=this.modelMoveRange*this.horizontal,this.posSet.go(),this.isCamCtrl){let t=this.camPoint.transform.localPosition.clone();t.x=this.startCamPoint.transform.localPosition.x-this.camPointMoveRange*this.horizontal,this.camPoint.transform.localPosition=t}}changeHegiht(t){}checkWay(t){let e=!1;return this.targetHorizontal=this.inHorizontal+t,this.targetHorizontal>.5?(this.targetHorizontal=.5,this.checkOut(),e=!0):this.targetHorizontal<-.5&&(this.targetHorizontal=-.5,this.checkOut(),e=!0),e}checkOut(){this.inHorizontal=this.targetHorizontal}Hit(t=1){this.forwardSpeed=-.35*t,this.isHit=!0,Laya.timer.once(this.hitTime,this,this.HitEnd),Laya.timer.frameLoop(1,this,this.HitUpdate)}HitEnd(){this.isHit=!1}HitUpdate(){this.forwardSpeed+=.035*Laya.timer.delta/16,this.forwardSpeed>=this.forwardSpeed_Data&&(Laya.timer.clear(this,this.HitUpdate),this.forwardSpeed=this.forwardSpeed_Data)}HitHorizontal(t){this.horizontal=(this.horizontal+t)/this.modelMoveRange*2,this.targetHorizontal=this.horizontal,this.checkOut()}onDisable(){}}class ${static init(){for(var t in this._soundCtx={},this._soundFile=[],this.loopSounds=[],d){let e=d[t];this._soundFile.push(e)}console.log("音效：",this._soundFile);let e=this._pathRoot,a="",i=this._soundFile,n=this._soundFile.length;for(let t=0;t<n;++t){a=i[t];let n=new Laya.SoundChannel;n.url=e+a+this.soundType,Laya.SoundManager.addChannel(n),this._soundCtx[a]=!0}Laya.SoundManager.autoStopMusic=!0,Laya.Browser.onWeiXin&&(O.on(l.Platform_Wake_Do,this,this.randomPlayMusic),Laya.timer.once(1e3,this,this.randomPlayMusic))}static setSoundVolume(t,e){this._soundCtx[t]&&Laya.SoundManager.setSoundVolume(e,this._pathRoot+t+this.soundType)}static play(t,e=!1){if(this._soundCtx[t])return e&&-1==this.loopSounds.indexOf(t)?(this.loopSounds.push(t),Laya.SoundManager.playSound(this._pathRoot+t+this.soundType,0)):Laya.SoundManager.playSound(this._pathRoot+t+this.soundType)}static stop(t,e=!1){if(this._soundCtx[t]){if(e){let e=this.loopSounds.indexOf(t);-1!=e&&this.loopSounds.splice(e,1)}Laya.SoundManager.stopSound(this._pathRoot+t+this.soundType)}}static playMusic(t){let e;return Laya.SoundManager.stopMusic(),t?(e=Laya.SoundManager.playMusic(this._pathRoot+t+this.soundType,0),this.currentBgm=t):e=this.currentBgm?Laya.SoundManager.playMusic(this._pathRoot+this.currentBgm+this.soundType,0):Laya.SoundManager.playMusic(this._pathRoot+d.Bgm+this.soundType,0),e}static stopMusic(){Laya.SoundManager.stopMusic()}static randomPlayMusic(){let t=d.Bgm,e=($.playMusic(t),z.musicTime);Laya.timer.once(e,this,this.randomPlayMusic)}static soundSwitch(t){this.isSound=t,Laya.SoundManager.soundMuted=!this.isSound}static muiscSwitch(t){this.isMusic=t,Laya.SoundManager.musicMuted=!this.isMusic}static playSoundLimit(t){let e=!0;if(this.CDs[t]&&0!=this.CDs[t]&&(e=!1),e){let e=this.play(t);e&&(this.CDs[t]=200*e.duration),Laya.timer.once(this.CDs[t],this,()=>{this.CDs[t]=0})}}}$._pathRoot="res/sounds/",$.soundType=".mp3",$.isSound=!0,$.isMusic=!0,$.CDs={};class tt{static d3_getSpritePosBySprite3DPoint(t,e,a=new Laya.Vector3(0,0,0)){var i=e.transform.position.clone();i.x+=a.x,i.y+=a.y,i.z+=a.z;var n=new Laya.Vector4;t.viewport.project(i,t.projectionViewMatrix,n);var s=new Laya.Vector2(n.x/Laya.stage.clientScaleX,n.y/Laya.stage.clientScaleY);return new Laya.Point(s.x,s.y)}static d3_FindNodeByName(t,e){let a=null,i=t=>{for(let n=0;n<t.numChildren;n++){if(t.getChildAt(n).name==e)return void(a=t.getChildAt(n));i(t.getChildAt(n))}};return i(t),a}static d3_FindNodeHasName(t,e){let a=null,i=t=>{for(let n=0;n<t.numChildren;n++){if(-1!=t.getChildAt(n).name.indexOf(e))return void(a=t.getChildAt(n));i(t.getChildAt(n))}};return i(t),a}static d3_switchAllMathInChildren(t,e){if(t.meshRenderer){let a=t.meshRenderer.material.clone();a.albedoColor=tt.d3_getRgbByHex(e),t.meshRenderer.material=a}for(let a=0;a<t.numChildren;a++){let i=t.getChildAt(a);if(i.meshRenderer){let t=new Laya.BlinnPhongMaterial,a=tt.d3_getRgbByHex(e);t.albedoColor=new Laya.Vector4(a.x,a.y,a.z,1),t.specularColor=new Laya.Vector4(0,0,0,1),i.meshRenderer.material=t}this.d3_switchAllMathInChildren(i,e)}}static d3_swtichMatColor(t,e){let a=t.meshRenderer.material.clone();a.albedoColor=e,t.meshRenderer.material=a}static d3_switchAllMatInChildren_Alpha(t,e){if(t.meshRenderer){let a=t.meshRenderer.material.clone();a.albedoColor.w=e,t.meshRenderer.material=a}for(let a=0;a<t.numChildren;a++){let i=t.getChildAt(a);this.d3_switchAllMatInChildren_Alpha(i,e)}}static d3_unactiveAllChildren(t){for(let e=0;e<t.numChildren;e++)t.getChildAt(e).active=!1}static d3_addChildNotMove(t,e){let a=t.transform.position.clone(),i=t.transform.rotation.clone();e.addChild(t),t.transform.position=a,t.transform.rotation=i}static d3_getRgbByHex(t){var e=[],a=[];let i=t.replace(/#/,"");if(3==i.length){for(var n=[],s=0;s<3;s++)n.push(i.charAt(s)+i.charAt(s));i=n.join("")}for(s=0;s<3;s++)e[s]="0x"+i.substr(2*s,2),a.push(parseInt(e[s]));return new Laya.Vector4(a[0]/255,a[1]/255,a[2]/255,0)}static d3_objectShake(t,e=1,a=.7){var i=e,n=1,s=t.transform.localPosition.clone();Laya.timer.frameLoop(1,this,function updateShake(){if(i>0){var e=new Laya.Vector3;Laya.Vector3.scale((o=Math.random()>.5?Math.random():-Math.random(),r=Math.random()>.5?Math.random():-Math.random(),new Laya.Vector3(o,r,0)),a,e),Laya.Vector3.add(s,e,e),t.transform.localPosition=e,i-=.02*n}else i=0,t.transform.localPosition=s,Laya.timer.clear(this,updateShake);var o,r})}static getAngle(t,e){var a=Laya.Vector3.dot(t,e),i=Laya.Vector3.scalarLength(t)*Laya.Vector3.scalarLength(e);if(0==i){if(t.z>e.z)return 0;if(t.z<e.z)return 180;if(t.y>e.y)return 90;if(t.y<e.y)return-90}var n=a/i;return n<-1&&(n=-1),n>1&&(n=1),180*Math.acos(n)/Math.PI}static getAngleUp(t,e,a){let i=tt.getAngle(t,e),n=new Laya.Vector3;return Laya.Vector3.cross(e,t,n),tt.getAngle(a,n)>90&&(i*=-1),i}static getProjection(t,e){let a=X.mull(e,X.dot(t,e));return X.subtract(t,a)}static d2_AddClickEvent(t,e,a,i,n=!1,s=!0,o=!0){t.offAllCaller(e);let r=t.scaleX,h=.9*r,l=!1;t.on(Laya.Event.MOUSE_DOWN,e,e=>{l=!0,o&&Laya.Tween.to(t,{scaleX:h,scaleY:h},60),n&&e.stopPropagation},i);t.on(Laya.Event.MOUSE_UP,e,i=>{0!=l&&(l=!1,n&&i.stopPropagation,o?Laya.Tween.to(t,{scaleX:r,scaleY:r},60,null,Laya.Handler.create(t,()=>{a&&a.call(e,i)})):a&&a.call(e,i),s&&$.play(d.Button))},i);t.on(Laya.Event.MOUSE_OUT,e,e=>{0!=l&&(l=!1,o&&Laya.Tween.to(t,{scaleX:r,scaleY:r},60),n&&e.stopPropagation)},i)}static getAngle2DWay(t,e){var a=Laya.Vector2.dot(t,e),i=Laya.Vector2.scalarLength(t)*Laya.Vector2.scalarLength(e),n=180*Math.acos(a/i)/Math.PI,s=t.x*e.y-e.x*t.y;return s>0?n*=1:s<0?n*=-1:n=0,n}static d2_numberLabelToast(t,e){let a=t>=0?this.greenColor:this.redColor,i=t>=0?"+":"-",n=tt.d3_getSpritePosBySprite3DPoint(K.instance.mainCamera,e,new Laya.Vector3(0,.2,0));tt.d2_labelToast(i+t+"$",a,Laya.stage,1,new Laya.Vector2(n.x,n.y))}static d2_coinCollectAnim(t,e,a,i,n=15,s=1,o=null,r=null){for(var h=n,l=0;l<n;l++){let n=Laya.Pool.getItemByClass("coin",Laya.Image);n.skin=t,n.x=e.x,n.y=e.y,n.scale(s,s),i.addChild(n);let l=300+100*Math.random()-50;Laya.Tween.to(n,{x:n.x+250*Math.random()-125,y:n.y+250*Math.random()-125},l),Laya.timer.once(l+50,this,function(){Laya.Tween.to(n,{x:a.x,y:a.y},400,null,new Laya.Handler(this,function(){i.removeChild(n),Laya.Pool.recover("coin",n),h--,r&&r(),0==h&&o&&o(i)}))})}}static d2_coinCollectAnimAni(t,e,a,i,n=15,s=null){for(var o=n,r=0;r<n;r++){let n=Laya.Pool.getItemByClass("coinAnim",Laya.Clip);n.skin=t.skin,n.index=t.index,n.clipX=t.clipX,n.clipY=t.clipY,n.autoPlay=t.autoPlay,n.x=e.x,n.y=e.y,n.scale(.8,.8),i.addChild(n);let r=300+100*Math.random()-50;Laya.Tween.to(n,{x:n.x+250*Math.random()-125,y:n.y+250*Math.random()-125},r),Laya.timer.once(r+50,this,function(){Laya.Tween.to(n,{x:a.x,y:a.y},400,null,new Laya.Handler(this,function(){i.removeChild(n),Laya.Pool.recover("coinAnim",n),0==--o&&s&&s(i)}))})}}static faceToast(t,e,a,i){let n=new Laya.Image(t);n.anchorX=.5,n.anchorY=.5,n.alpha=1,n.scaleX=.3,n.scaleY=.3,e.addChild(n),n.x=a.x,n.y=a.y,Laya.Tween.to(n,{x:i.x,y:i.y,alpha:.9},1e3,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{n&&!n.destroyed&&Laya.Tween.to(n,{x:i.x,y:i.y-100,alpha:0},1e3,null,Laya.Handler.create(this,()=>{n&&!n.destroyed&&n.destroy()}))}))}static d2_fontClipToast(t,e,a,i,n){if(!this.wordToastOk)return;let s=Laya.Pool.getItemByClass("fontClip_d2",Laya.FontClip);s.skin=t,s.sheet="0123456789",s.value=e,s.anchorX=.5,s.anchorY=.5,s.alpha=1,s.scaleX=i,s.scaleY=i,a.addChild(s),s.x=n.x,s.y=n.y;let o=new Laya.Vector2(n.x+(tt.halfPercent()?tt.randomInt(-100,-75):tt.randomInt(75,100)),n.y-50);Laya.Tween.to(s,{x:o.x,y:o.y,alpha:.9},500,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{Laya.Tween.to(s,{x:o.x,y:o.y-90,alpha:0},500,null,Laya.Handler.create(this,()=>{a.removeChild(s),Laya.Pool.recover("fontClip_d2",s)}))}))}static d2_imageToast(t,e,a){if(!this.wordToastOk)return;tt.wordToastOk=!1;let i=new Laya.Image(t);i.anchorX=.5,i.anchorY=.5,i.alpha=1,e.addChild(i),i.top=300,i.centerX=0;i.scaleX=0,i.scaleY=0,Laya.Tween.to(i,{scaleX:1,scaleY:1},500,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{tt.wordToastOk=!0,i&&!i.destroyed&&Laya.Tween.to(i,{top:200,alpha:0},500,null,Laya.Handler.create(this,()=>{i&&!i.destroyed&&i.destroy()}))}))}static d2_labelToast(t,e,a,i,n){let s=Laya.Pool.getItemByClass("label_d2",Laya.Label);s.text=t,s.color=e,s.anchorX=.5,s.anchorY=.5,s.alpha=1,s.scaleX=i,s.scaleY=i,s.font="Microsoft YaHei",s.fontSize=50,s.bold=!0,a.addChild(s),s.x=n.x,s.y=n.y;let o=new Laya.Vector2(n.x+(tt.halfPercent()?tt.randomInt(-100,-75):tt.randomInt(75,100)),n.y-50);Laya.Tween.to(s,{x:o.x,y:o.y,alpha:.9},500,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{Laya.Tween.to(s,{x:o.x,y:o.y-90,alpha:0},500,null,Laya.Handler.create(this,()=>{a.removeChild(s),Laya.Pool.recover("label_d2",s)}))}))}static clamp01(t){return t>1?1:t<0?0:t}static clamp(t,e,a){return t<e?e:t>a?a:t}static get getCurrentTime(){return(new Date).getTime()}static get getCurrentTime_Second(){return Math.floor(Date.parse((new Date).toString())/1e3)}static math_gcd(t,e){return 0==e?t:this.math_gcd(e,t%e)}static numberTo(t,e,a){return Math.abs(e-t)<a?t=e:t<e?t+=a:t>e&&(t-=a),t}static randomNumber(t,e){return t+(e-t)*Math.random()}static randomInt(t,e){return Math.floor(t+(e+1-t)*Math.random())}static halfPercent(){return Math.random()<.5}static percent(t){return Math.random()<t}static cloneArray(t){return[].concat(t)}static getRandomInArray(t){if(t.length){let e=Math.random()*t.length;return t[e=Math.floor(e)]}return console.error("传入错误参数,返回空"),null}static takeRandomInArray(t){if(t.length){let e=Math.random()*t.length,a=t[e=Math.floor(e)];return t.splice(e,1),a}return console.error("传入错误参数,返回空"),null}static randomArray(t){let e=new Array(t.length),a=e.length;for(let i=0;i<a;i++){let a=this.takeRandomInArray(t);e[i]=a}return e}static BoxCheck_2D_Normal(t,e,a,i,n,s,o,r){let h=n-t,l=s-e,d=Math.abs(l),c=Math.abs(h),u=(i+r)/2,m=(a+o)/2;return{isHit:d<u&&c<m,axisDis:c,axisRange:m,horizontalDis:d,horizontalRange:u,axisWay:h,horizontalWay:l}}static CircleCheck_2D(t,e,a,i,n,s){let o=Math.pow(t-i,2)+Math.pow(e-n,2),r=Math.pow(a+s,2);return{isHit:o<r,distancePow2:o,rangePow2:r}}}tt.greenColor="#00FF00",tt.redColor="#FF0000",tt.wordToastOk=!0,function(t){t.start="touchStart",t.move="touchMove",t.end="touchEnd",t.getAxis="GetAxis",t.slideWay="slideWay",t.singleTouchStart="singleTouchStart",t.singleTouchMove="singleTouchMove",t.singleTouchEnd="singleTouchEnd",t.secondTouchStart="secondTouchStart",t.secondTouchMove="secondTouchMove",t.secondTouchEnd="secondTouchEnd",t.getAxisAlways="getAxisAlways",t.keyDown="keyDown"}(y||(y={}));class et extends Laya.Script{constructor(){super(...arguments),this.isPressed=!1,this.hOriginal=0,this.vOriginal=0,this.hAxis=0,this.vAxis=0,this.outAxis=0,this.touchId=-1}onEnable(){et.instance=this}onMouseDown(t){O.event(y.start,[t])}onMouseMove(t){O.event(y.move,[t])}onMouseOut(t){O.event(y.end,[t])}onMouseOver(t){O.event(y.end,[t])}onMouseUp(t){O.event(y.end,[t])}}class at extends Laya.Script{constructor(){super(...arguments),this.calls=[],this.firstId=-1,this.secondId=-1,this.firstOriginalPoint=new Laya.Vector2,this.secondOriginalPoint=new Laya.Vector2,this.isSecond=!1,this.orignalHorizontal=0,this.orignalAxis=0,this.orignalHorizontalAlways=0,this.orignalAxisAlways=0,this.offset=new Laya.Vector3}onEnable(){O.on(y.start,this,this.onMouseDown),O.on(y.move,this,this.onMouseMove),O.on(y.end,this,this.onMouseUp)}onDisable(){O.off(y.start,this,this.onMouseDown),O.off(y.move,this,this.onMouseMove),O.off(y.end,this,this.onMouseUp)}onMouseDown(t){0==this.isSecond?-1==this.firstId?(this.checkOut(t),this.firstId=t.touchId,O.event(y.singleTouchStart,t),this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):this.firstId!=t.touchId&&-1==this.secondId&&(this.secondId=t.touchId,this.isSecond=!0,O.event(y.secondTouchStart,t),this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):-1==this.firstId?(this.firstId=t.touchId,this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):-1==this.secondId&&(this.secondId=t.touchId,this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),this.checkOutAlways(t)}onMouseMove(t){if(0==this.isSecond)t.touchId==this.firstId&&(this.checkWay(t),this.checkOut(t),O.event(y.singleTouchMove,t));else if(-1!=this.firstId&&-1!=this.secondId){let e,a={distance:0,angle:0},i=this.Vector2Reduce(this.secondOriginalPoint,this.firstOriginalPoint),n=Laya.Vector2.scalarLength(i);if(t.touchId==this.firstId?e=this.Vector2Reduce(this.secondOriginalPoint,new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):t.touchId==this.secondId&&(e=this.Vector2Reduce(new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height),this.firstOriginalPoint)),e){let t=Laya.Vector2.scalarLength(e);a.distance=t-n,a.angle=tt.getAngle2DWay(i,e),O.event(y.secondTouchMove,a)}}t.touchId==this.firstId&&(this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),t.touchId==this.secondId&&(this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),this.checkWayAlways(t)}onMouseUp(t){this.checkOutAlways(t),t.touchId==this.firstId&&(this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),t.touchId==this.secondId&&(this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),0==this.isSecond?t.touchId==this.firstId&&(this.checkOut(t),O.event(y.singleTouchEnd,t),this.firstId=-1):(t.touchId==this.firstId&&(this.firstId=-1),t.touchId==this.secondId&&(this.secondId=-1),-1==this.firstId&&-1==this.secondId&&(this.isSecond=!1))}WayCheck(){let t=this.Vector2Reduce(this.nowPos,this.startPos);if(Laya.Vector2.scalarLength(t)>100){let e=Math.atan2(t.y,t.x)/Math.PI*180,a="none";e>-135&&e<-45?a="up":e>-45&&e<45?a="right":e<135&&e>45?a="down":(e<-135||e>135)&&(a="left"),this.isDown=!1}this.startPos=this.nowPos}onDestroy(){this.touchTimer&&clearTimeout(this.touchTimer)}checkWay(t){let e=t.stageX-this.orignalHorizontal,a=t.stageY-this.orignalAxis;O.event(y.getAxis,[{x:e,y:a}])}checkOut(t){this.orignalHorizontal=t.stageX,this.orignalAxis=t.stageY}checkWayAlways(t){let e=t.stageX/Laya.stage.width-this.orignalHorizontalAlways,a=t.stageY/Laya.stage.height-this.orignalAxisAlways;this.checkOutAlways(t),O.event(y.getAxisAlways,[{x:e,y:a}])}checkOutAlways(t){this.orignalHorizontalAlways=t.stageX/Laya.stage.width,this.orignalAxisAlways=t.stageY/Laya.stage.height}modelRotateControlDown(){let t=new Laya.Vector3(Laya.MouseManager.instance.mouseX,Laya.MouseManager.instance.mouseY,0);this.startPosition=t.clone(),this.prePosition=t.clone()}modelRotateControlMove(){let t=new Laya.Vector3(Laya.MouseManager.instance.mouseX,Laya.MouseManager.instance.mouseY,0);Laya.Vector3.subtract(t,this.prePosition,this.offset),this.prePosition=t.clone();var e=new Laya.Vector3(this.offset.x,this.offset.y,0);let a=new Laya.Vector3;Laya.Vector3.cross(e,new Laya.Vector3(0,0,1),a),Laya.Vector3.normalize(a,a)}modelRotateControlUp(){new Laya.Vector3(Laya.MouseManager.instance.mouseX,Laya.MouseManager.instance.mouseY,0)}onKeyDown(t){O.event(y.keyDown,t)}Vector2Reduce(t,e){return new Laya.Vector2(t.x-e.x,t.y-e.y)}}class it{constructor(){this.isSubPackage=!0,this.isVibrate=!0}init(){it.instance=this}loadSubPackage(t,e){if(this.platformApi&&this.isSubPackage){this.platformApi.loadSubpackage({name:t,success:function(a){console.log("分包加载成功：",t),e.call(!0,a)},fail:function(a){console.error("分包加载失败：",t,JSON.stringify(a)),e.call(!1,a)}})}else console.log("没有平台API"),e(!0)}showToast(t,e=1e3){console.log(t,e.toString()+"ms")}vibrateShort(){this.platformApi&&this.isVibrate&&this.platformApi.vibrateShort()}vibrateLong(){this.platformApi&&this.isVibrate&&this.platformApi.vibrateLong()}regisiterCallback(){this.platformApi&&(this.platformApi.offShow(this.onShowEvent),this.platformApi.onShow(this.onShowEvent),this.platformApi.offHide(this.onHideEvent),this.platformApi.onHide(this.onHideEvent))}onShowEvent(t){O.event(l.Platform_Wake_Do,t)}onHideEvent(t){O.event(l.Platform_Hide_Do,t)}showVideo(t,e){this.showToast("无视频，默认发放奖励"),t&&t()}}class nt{static AddGrade(){let t=this.GetPlayerData();t.grade++,parseInt(t.grade)>99&&(t.grade=99),this.SavePlayerData(t),S.Instance.Level=t.grade}static ReadGrade(){let t=this.GetPlayerData();return parseInt(t.grade)}static AddCoin(t){let e=this.GetPlayerData();e.coin+=t,e.coin>99999&&(e.coin=99999),Math.floor(e.coin),this.SavePlayerData(e),O.event(l.Game_Coin_Update)}static CostCoin(t){let e=!1;return this.ReadCoin()>=t?(this.AddCoin(-t),e=!0):it.instance.showToast("金币不足"),e}static ReadCoin(){let t=this.GetPlayerData();return Math.floor(t.coin)}static AddNowSkin(){let t=this.GetPlayerData();t.nowSkin++,this.SavePlayerData(t),O.event(l.Game_SkinChange_Event)}static ReadNowSkin(){return this.GetPlayerData().nowSkin}static AddCountLevel(){let t=this.GetPlayerData();t.countLevel++,this.SavePlayerData(t),O.event(l.Game_CountChange_Event)}static ReadCountLevel(){return this.GetPlayerData().countLevel}static AddIncomeLevel(){let t=this.GetPlayerData();t.incomeLevel++,this.SavePlayerData(t)}static ReadIncomeLevel(){return this.GetPlayerData().incomeLevel}static ReadHighScore(){return this.GetPlayerData().highScore}static WriteHighScore(t){let e=this.GetPlayerData();t>e.highScore?(e.highScore=t,this.SavePlayerData(e)):it.instance.showToast("输入值"+t.toString()+"不是最高分最高分是"+e.highScore)}static GetPlayerData(){let t;return(t=Laya.LocalStorage.getJSON("PlayerData"))||(t=this.data,Laya.LocalStorage.setJSON("PlayerData",t),t)}static SavePlayerData(t){Laya.LocalStorage.setJSON("PlayerData",t)}static ClearPlayerData(){Laya.LocalStorage.clear()}static CheckPlayerData(){let t;(t=Laya.LocalStorage.getJSON("PlayerData"))&&t.ver&&t.ver==this.data.ver||(t=this.data,Laya.LocalStorage.setJSON("PlayerData",t),console.log("触发存档重置条件")),console.log(this.GetPlayerData())}}nt.data={ver:"Battery_1.0.1",grade:1,coin:0,highScore:0,nowSkin:0,countLevel:0,incomeLevel:0};class st extends Laya.Script{onAwake(){this.self=this.owner,this.init()}init(...t){}onDestroy(){Laya.timer.clearAll(this),O.offAllCaller(this)}}class ot extends st{init(...t){this.value=this.self.getChildByName("value"),this.coinUpdate(),O.on(l.Game_Coin_Update,this,this.coinUpdate)}coinUpdate(){this.value.value=nt.ReadCoin().toString()}}class rt extends st{init(...t){this.value=this.self.getChildByName("value"),this.value.value=nt.ReadGrade().toString(),this.bar=this.self.getChildByName("bar"),O.on(l.Game_Progress_Event,this,this.changeBar),this.changeBar(0)}changeBar(t){this.bar.value=t}}class ht extends U{constructor(){super(...arguments),this.yForceMin=1,this.yForceMax=2,this.xForceMin=.5,this.xForceMax=1,this.zForceMin=15,this.zForceMax=25,this.dir=new Laya.Vector3(0,1,0),this.gravity=0,this.yforce=0,this.xForce=0,this.zForce=0,this.rotate=new Laya.Vector3,this.dorpDeadY=-2,this.dropDeadChangeX=4,this.isDestory=!0,this.isActive=!0}init(){this.setData()}changeDropData(t,e,a,i,n,s){this.yForceMin=t.x,this.yForceMax=t.y,this.xForceMin=e.x,this.xForceMax=e.y,this.zForceMin=a.x,this.zForceMax=a.y,this.rotate=n,this.dir=i,this.gravity=s,this.setData()}setTimeDestroy(t=1e3){Laya.timer.once(t,this,()=>{this.self.destroy()})}setData(){this.xForce=tt.randomNumber(this.xForceMin,this.xForceMax),this.yforce=tt.randomNumber(this.yForceMin,this.yForceMax),this.zForce=tt.randomNumber(this.zForceMin,this.zForceMax)}onUpdate(){if(!this.isActive)return;let t=Laya.timer.delta/1e3;this.yforce-=this.gravity*t;let e=this.self;e&&!e.destroyed&&(e.transform.translate(new Laya.Vector3(this.dir.x*this.xForce*t,this.yforce*t,this.dir.z*this.zForce*t),!1),Math.abs(this.self.transform.position.x)>this.dropDeadChangeX&&(this.dorpDeadY=-19.5),this.self.transform.position.y<this.dorpDeadY&&(this.isDestory?this.self.destroy():this.isActive=!1))}}class lt extends U{constructor(){super(...arguments),this.range=1,this.width=1,this.raidus=1,this.colliderActive=!0,this.isBullet=!1,this.itemState=u.Battery,this.isLib=!1,this.isSleeve=!1}init(...t){this.model=this.self.getChildAt(0).getChildByName("Model"),this.skin=this.model.getChildByName("Skin"),this.changeSkin(),O.on(l.Game_SkinChange_Event,this,this.changeSkin)}setData(t,e,a=!1){this.range=t,this.width=e,this.raidus=this.range>this.width?this.range:this.width,this.colliderActive=!0,this.isBullet=a}changeSkin(){let t=nt.ReadNowSkin()%7,e=this.skin;for(let a=0;a<e.numChildren;a++)e.getChildAt(a).active=a==t}changeState(t){this.self.getChildAt(0);switch(this.itemState=t,t){case u.Battery:}(()=>{this.tweenBornDo_Smooth()})()}changeHegiht(t){let e=this.self.transform.position.clone();e.y=t,this.self.transform.position=e}skinRot(t){let e=this.skin.transform.localRotationEuler.clone();e.y=Laya.MathUtil.lerp(e.y,180*-t,.5),this.skin.transform.localRotationEuler=e}clearSkinRot(){this.model.transform.localRotation=new Laya.Quaternion,this.skin.getChildAt(nt.ReadNowSkin()%7).transform.localRotation=new Laya.Quaternion,this.skin.transform.localRotation=new Laya.Quaternion}}class dt extends U{constructor(){super(...arguments),this.offsetX=0,this.offsetZ=z.itemAxisSize,this.itemLerpAxis=30,this.nowType=[]}init(...t){dt.instance=this,this.items=this.self.getChildByName("Items"),this.model=this.self.getChildByName("Model"),this.size=z.itemAxisSize,Laya.timer.loop(8,this,this.update)}reset(t=1){this.items.active=!0,this.nowType=[];for(let t=this.items.numChildren-1;t>=0;t--)this.items.getChildAt(t).destroy();let e=t;for(let t=0;t<e;t++)this.addItem()}addItem(){let t=new Laya.Sprite3D("item");W.stageObj.push(t),this.items.addChild(t),W.bornStageObj(c.Battery,t).transform.localPosition=new Laya.Vector3;let e=t.addComponent(lt);e.posSet=t.addComponent(Z),e.setData(this.size,this.size),e.changeState(u.Battery),it.instance.vibrateShort(),$.playSoundLimit(d.Get),F.instance&&F.instance.showAddClip()}addOldItem(t){tt.d3_addChildNotMove(t.self,this.items),t.self.transform.localPosition=new Laya.Vector3,t.self.getChildAt(0).getChildByName("Model").transform.localRotation=new Laya.Quaternion,t.tweenBornDo(),it.instance.vibrateShort(),$.playSoundLimit(d.Get),F.instance.showAddClip()}getItem(){return this.items.numChildren<=1&&O.event(l.Game_Over_Event,!1),0==this.items.numChildren?null:this.items.getChildAt(0).getComponent(lt)}update(){let t=.008;t>.03&&(t=.03);let e,a,i=this.self.getComponent(Z),n={axis:i.axis,horizontal:i.horizontal};n.horizontal+=this.offsetX,n.axis+=this.offsetZ;for(let s=0;s<this.items.numChildren;s++)if((e=this.items.getChildAt(s))&&!e.destroyed){a=e.getComponent(Z);let o=0==s?1:t*this.itemLerpAxis;o>1&&(o=1);let r=Laya.MathUtil.lerp(a.horizontal,n.horizontal,o),h=r-a.horizontal,l=i.axis-this.offsetZ-s*this.size;a.axis=l,a.horizontal=r,a.go(),n=a;let d=a.model.getChildAt(0).getChildByName("Skin").getChildAt(nt.ReadNowSkin()%7);K.instance.isMove&&d.transform.rotate(new Laya.Vector3(6*t*K.instance.forwardSpeed,0,0),!0),e.getComponent(lt).skinRot(h)}}}class ct extends ht{constructor(){super(...arguments),this.isColliderActive=!1,this.isLandRotate=!0,this.hitGroundAxis=.6,this.blockAxis=.05}init(){super.init(),this.self.getComponent(lt).clearSkinRot(),this.dorpDeadY=this.self.transform.position.clone().y,this.isDestory=!1,this.isLandRotate=!0,this.isActive=!0,this.yforce=0,this.changeDropData(new Laya.Vector2(30,40),new Laya.Vector2(-5,5),new Laya.Vector2(15,30),new Laya.Vector3(1,1,1),new Laya.Vector3(tt.randomNumber(-10,10),tt.randomNumber(-10,10),tt.randomNumber(-10,10)),125)}onUpdate(){let t=Laya.timer.delta/1e3;if(this.isActive){this.yforce-=this.gravity*t;let e=this.self;this.self.getChildAt(0).getChildByName("Model");if(e&&!e.destroyed){let a=new Laya.Vector3,i=new Laya.Vector3;this.self.transform.getForward(a),this.self.transform.getRight(i);let n=X.mull(a,this.zForce*-t),s=X.mull(i,this.xForce*t),o=X.mull(new Laya.Vector3(0,1,0),this.yforce*t),r=X.add(n,s);if(r=X.add(r,o),e.transform.translate(r,!1),this.self.transform.position.y<=this.dorpDeadY)if(this.isColliderActive=!0,this.isDestory)this.self.destroy();else{let t=-(this.self.transform.position.y-this.dorpDeadY);this.yforce*=-this.hitGroundAxis,this.xForce*=this.hitGroundAxis,this.zForce*=this.hitGroundAxis,this.xForce+this.zForce+this.yforce<=this.blockAxis&&(this.isActive=!1),e.transform.position=new Laya.Vector3(this.self.transform.position.x,this.dorpDeadY+t,this.self.transform.position.z)}}}}colliderDo(){this.isColliderActive&&(dt.instance.addOldItem(this.self.getComponent(lt)),it.instance.vibrateShort(),this.destroy())}}class ut extends U{constructor(){super(...arguments),this.isCircle=!1,this.range=1,this.width=1,this.raidus=1,this.soundRange=100,this.colliderActive=!0,this.colliderSprite=[],this.obsType=m.Obs1_Battery,this.rewardAdd=0,this.batteryPitCount=0,this.powerBankShow=[],this.isColliderStatic=!0,this.hasColliderObj=[]}init(...t){}setData(t){this.obsType=t,this.isCircle=!1;let e=tt.d3_FindNodeHasName(this.self,"collider");if(this.posSet=this.self.getComponent(Z),e){this.range=parseFloat(e.name.split("_")[2]),this.width=parseFloat(e.name.split("_")[3]),this.raidus=(this.range+this.width)/2,this.raidus*=.5,this.colliderSprite.push(e);let t=e.addComponent(Z);t.axis=this.posSet.axis+e.transform.localPositionZ,t.horizontal=this.posSet.horizontal+e.transform.localPositionX}else this.colliderSprite.push(this.self);switch(t){case m.Obs1_Battery:case m.Obs2_Battery:this.changeSkin(),O.on(l.Game_SkinChange_Event,this,this.changeSkin);break;case m.StartPoint:tt.d3_unactiveAllChildren(this.posSet.model),K.instance.reset(this.posSet.axis,0);break;case m.EndPoint:break;case m.Obs_BatteryPit:this.batteryPitCount=1;break;case m.PowerBank_1:this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank1_3")),this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank1_4")),this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank1_5")),this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank1_6"));for(let t=1;t<this.powerBankShow.length;t++)this.powerBankShow[t].active=!1;this.batteryPitCount=3;break;case m.PowerBank_2:this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank2_3")),this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank2_4")),this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank2_5")),this.powerBankShow.push(tt.d3_FindNodeByName(this.self,"Powerbank2_6"));for(let t=0;t<this.powerBankShow.length;t++)this.powerBankShow[t].active=!1;this.batteryPitCount=5;break;case m.RemoteControl:this.batteryPitCount=6;break;case m.Bunny:this.batteryPitCount=3;break;case m.Kaktus:this.batteryPitCount=4;break;case m.Musicbox:this.batteryPitCount=3;break;case m.SawBlade:break;case m.SawBlade_Move:this.isColliderStatic=!1;break;case m.Obstacle:this.self.getComponent(Laya.Animator).play("Obstacle",0,0);let e=()=>{this.colliderActive=!0,Laya.timer.once(500,this,()=>{this.colliderActive=!1,Laya.timer.once(500,this,e)})};e();break;case m.Clapboard:break;default:console.log("关卡物品预设里没有该类型物件",t)}}colliderDo(t=null,e){let a,i,n=()=>{this.colliderActive&&(this.self.active=!1,dt.instance.addItem(),this.colliderActive=!1)},s=e=>{if(this.colliderActive&&(t=dt.instance.getItem())&&-1==this.hasColliderObj.indexOf(t)){this.hasColliderObj.push(t);let e=t.self.transform.position.clone(),a=t.self.transform.rotation.clone();W.dropItemsGrip.addChild(t.self),t.self.transform.position=e,t.self.transform.rotation=a,t.self.addComponent(ct),it.instance.vibrateShort(),$.play(d.Obstacle),K.instance.Hit(-.5),W.bornFxFromPool("B_Des",W.mainScene,2e3).transform.position=t.model.transform.position.clone()}},o=e=>{if(this.colliderActive&&(t=dt.instance.getItem())&&-1==this.hasColliderObj.indexOf(t)){this.batteryPitCount--,this.batteryPitCount<=0&&(this.colliderActive=!1),this.hasColliderObj.push(t);let a=new Laya.Vector3(0,0,0),i=1;e||(e=this.posSet.model,a.y-=.55,i=.2),tt.d3_addChildNotMove(t.self,e);let n=t.posSet.model.transform.position.clone();t.posSet.horizontal=0,t.posSet.go(),t.self.transform.position=n,t.clearSkinRot(),O.event(l.Game_AddMoneyCount_Event,Math.floor(1+nt.ReadNowSkin())),t.selfTween.toTween(t.self,{pos:a,rot:new Laya.Quaternion},250,()=>{W.bornFxFromPool("B_Fit",t.self,1e3),$.playSoundLimit(d.Fill)},null,!0),it.instance.vibrateShort(),K.instance.Hit(i)}},r=(t,e)=>{this.batteryPitCount<=0&&Laya.timer.once(300,this,()=>{let a=t.transform.localRotation.clone();t.transform.rotate(e,!0,!1);let i=t.transform.localRotation.clone();t.transform.localRotation=a,this.selfTween.toTween(t,{rot:i},150,()=>{let t=this.posSet.model.transform.localPosition.clone();t.y+=20,this.selfTween.toTween(this.posSet.model,{pos:t},600,()=>{this.posSet.model.active=!1},Laya.Ease.expoIn,!0)},Laya.Ease.linearIn,!0)})},h=()=>{if(this.colliderActive){let t,e=K.instance.posSet.horizontal-this.posSet.horizontal;t=z.itemHorizontalSize/2+.1-Math.abs(e),t*=e>=0?1:-1,K.instance.HitHorizontal(t),it.instance.vibrateShort()}},c=()=>{if(this.colliderActive){let t=this.posSet.model,e=t.transform.localPosition.clone();e.z+=.75,this.selfTween.toTween(t,{pos:e},200,null,null,!0)}};if(-1==this.hasColliderObj.indexOf(t)&&this.colliderActive){switch(this.obsType){case m.Obs1_Battery:case m.Obs2_Battery:n();break;case m.EndPoint:O.event(l.Game_RoadToEnd_Event);break;case m.Obs_BatteryPit:o();break;case m.PowerBank_1:o(tt.d3_FindNodeByName(this.self,"Grip"+(3-this.batteryPitCount))),a=3-this.batteryPitCount,Laya.timer.once(300,this,()=>{this.powerBankShow[a].active=!0}),c(),this.batteryPitCount<=0&&Laya.timer.once(300,this,()=>{$.play(d.Full)}),r(this.posSet.model.getChildAt(0).getChildAt(1),new Laya.Vector3(90,0,0));break;case m.PowerBank_2:o(tt.d3_FindNodeByName(this.self,"Grip"+(5-this.batteryPitCount))),a=Math.floor(this.batteryPitCount/5*4),Laya.timer.once(300,this,()=>{this.powerBankShow[a].active=!0}),c(),this.batteryPitCount<=0&&Laya.timer.once(300,this,()=>{$.play(d.Full)}),r(this.posSet.model.getChildAt(0).getChildAt(1),new Laya.Vector3(90,0,0));break;case m.RemoteControl:o(tt.d3_FindNodeByName(this.self,"Grip"+(6-this.batteryPitCount))),c(),this.batteryPitCount<=0&&Laya.timer.once(300,this,()=>{$.play(d.Full)}),r(this.posSet.model.getChildAt(0).getChildAt(1),new Laya.Vector3(90,0,0));break;case m.Bunny:o(tt.d3_FindNodeByName(this.self,"Grip"+(3-this.batteryPitCount))),c(),this.batteryPitCount<=0&&(Laya.timer.once(300,this,()=>{$.play(d.Full)}),Laya.timer.once(300,this,()=>{(i=this.posSet.model.getChildAt(0).getComponent(Laya.Animator)).play("Bunny",0,0)}),r(tt.d3_FindNodeByName(this.self,"Bunny_Door"),new Laya.Vector3(0,90,0)));break;case m.Kaktus:o(tt.d3_FindNodeByName(this.self,"Grip"+(4-this.batteryPitCount))),c(),this.batteryPitCount<=0&&(Laya.timer.once(300,this,()=>{i=this.posSet.model.getChildAt(0).getComponent(Laya.Animator),$.play(d.Full),i.play("Kaktus",0,0)}),r(tt.d3_FindNodeByName(this.self,"kaktus_Door"),new Laya.Vector3(0,120,0)));break;case m.Musicbox:o(tt.d3_FindNodeByName(this.self,"Grip"+(3-this.batteryPitCount))),c(),this.batteryPitCount<=0&&(Laya.timer.once(300,this,()=>{(i=this.posSet.model.getChildAt(0).getComponent(Laya.Animator)).play("MusicBox",0,0),$.play(d.Full)}),r(tt.d3_FindNodeByName(this.self,"Musicbox1_3"),new Laya.Vector3(0,90,0)));break;case m.SawBlade:case m.SawBlade_Move:s();break;case m.Obstacle:for(let t=0;t<3;t++)s();break;case m.Clapboard:h()}t&&this.hasColliderObj.push(t)}else switch(this.obsType){case m.Obs1_Battery:case m.Obs2_Battery:case m.Clapboard:}}colliderExit(t=null,e){switch(this.obsType){case m.Obs1_Battery:case m.Obs2_Battery:}let a=this.hasColliderObj.indexOf(t);this.hasColliderObj.splice(a,1)}changeSkin(){let t=nt.ReadNowSkin()%7,e=this.posSet.model.getChildByName("Skin");for(let a=0;a<e.numChildren;a++)e.getChildAt(a).active=a==t}playLoopSound(t){this.loopSoundChannel&&!this.loopSoundChannel.isStopped||(this.loopSoundChannel=$.play(t,!0)),this.loopSoundChannel&&(this.loopSoundChannel.volume=$.isSound?1:0),Laya.timer.frameOnce(1,this,this.soundStop)}soundStop(){this.loopSoundChannel&&(this.loopSoundChannel.volume=0)}playCloseSound(t){let e=Math.abs(this.self.transform.position.z-K.instance.player.transform.position.z),a=e<this.soundRange?e/this.soundRange:1;this.loopSoundChannel&&!this.loopSoundChannel.isStopped||(this.loopSoundChannel=$.play(t,!0)),this.loopSoundChannel&&(this.loopSoundChannel.volume=$.isSound?1-a:0)}}class mt{static addLoadRes(t){this.loadingList.push(t),this.loadingCount++}static removeLoadRes(t){let e=this.loadingList.indexOf(t);-1==e?console.log("完成了不存在的资源加载"):this.loadingList.splice(e,1),O.event(l.Progress_Load_Update)}}mt.loadingList=[],mt.loadingCount=0;class gt{constructor(){this.dropObjs=[],this.colliders=[],this.moneyCount=0,this.nowRound=0,this.playCount=0,this.levelScale=1,this.roadLength=50*this.levelScale,this.colliderRange=50,this.isWin=!1,this.isEnd=!1,this.isFxOn=!0,this.isReadJsonOrScene=!0,this.isBornStage=!0,this.isStart=!1,this.lastValue=0,this.isItemColliderOn=!1,this.isPressed=!1,this.orignal=0,gt.instance=this,this.init()}init(){this.initEvent(),this.readJson()}createShadow(t){t.shadowMode=Laya.ShadowMode.SoftLow,t.shadowDistance=100,t.shadowResolution=2048,t.shadowCascadesMode=Laya.ShadowCascadesMode.NoCascades,t.shadowNormalBias=.6,t.shadowStrength=.4}hideShadow(t){t.shadowMode=Laya.ShadowMode.None}useRetinalCanvas(){Laya.stage.useRetinalCanvas=!0}disabelRetinalCanvas(){Laya.stage.useRetinalCanvas=!1}setFog(t,e,a){e.enableFog=t,t&&(e.fogColor=a,e.fogStart=10,e.fogRange=30)}readJson(){mt.addLoadRes("关卡");let t=["res/json/stageInfo.json"],e=()=>{Laya.loader.load(t,Laya.Handler.create(this,a=>{if(a){for(let e=0;e<t.length;e++)Laya.loader.load(t[e],Laya.Handler.create(this,t=>{switch(e){case 0:this.stageJson=t,this.allSet=[];for(let t=0;t<this.stageJson.length;t++){let e=this.stageJson[t].setInfo;for(let t=0;t<e.length;t++)this.allSet.push(e[t])}console.log(this.allSet),console.log(t);break;default:console.log(t)}}),null,Laya.Loader.JSON);mt.removeLoadRes("关卡")}else console.log("load json fail,reload after 1s"),Laya.timer.once(1e3,this,e)}),null,Laya.Loader.JSON)};t.length>0&&e()}JsonV3(t,e){if(e){let a=Math.round(parseFloat(t.x)*Math.pow(10,e))/Math.pow(10,e),i=Math.round(parseFloat(t.y)*Math.pow(10,e))/Math.pow(10,e),n=Math.round(parseFloat(t.z)*Math.pow(10,e))/Math.pow(10,e);return new Laya.Vector3(a,i,n)}return new Laya.Vector3(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z))}V3ToJson(t){return{x:t.x.toString(),y:t.y.toString(),z:t.z.toString()}}JsonV4(t,e){if(e){let a=Math.round(parseFloat(t.x)*Math.pow(10,e))/Math.pow(10,e),i=Math.round(parseFloat(t.y)*Math.pow(10,e))/Math.pow(10,e),n=Math.round(parseFloat(t.z)*Math.pow(10,e))/Math.pow(10,e),s=Math.round(parseFloat(t.w)*Math.pow(10,e))/Math.pow(10,e);return new Laya.Vector4(a,i,n,s)}return new Laya.Vector4(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z),parseFloat(t.w))}V4ToJson(t){return{x:t.x.toString(),y:t.y.toString(),z:t.z.toString(),w:t.w.toString()}}firstIn(){console.log("首次进入处理"),W.mainScene=this.mainScene;for(let t=0;t<this.mainScene.numChildren;t++){let e=this.mainScene.getChildAt(t);switch(e.name){case"Prefabs":W.prefabs=e,W.prefabs.active=!1;break;case"Light":this.light=e;break;case"Fxs":W.fxs=e,Laya.timer.once(1e3,this,()=>{W.fxs.active=!1});break;case"Stage":this.stage=e,this.player=this.stage.getChildByName("Player"),this.player.addComponent(Z),this.runMoveComp=this.player.addComponent(K),this.itemsComp=this.player.addComponent(dt),this.camPoint=this.player.getChildByName("CamPoint"),this.mainCam=this.camPoint.getChildByName("MainCam"),this.mainCamera=this.mainCam.getChildByName("Main Camera"),this.runMoveComp.mainCamera=this.mainCamera,this.start=this.stage.getChildByName("Start"),this.end=this.stage.getChildByName("End"),this.dropItemGrip=this.stage.getChildByName("DropItemGrip"),W.dropItemsGrip=this.dropItemGrip,W.dropItemsGrip=this.dropItemGrip}}this.useRetinalCanvas(),this.createShadow(this.light);let t=tt.d3_FindNodeByName(this.stage,"Water_1"),e=t.meshRenderer.material.clone();Laya.timer.frameLoop(1,this,()=>{let a=Laya.timer.delta/1e3;e.tilingOffset.w-=.25*a,e.tilingOffset.z+=.25*a,t.meshRenderer.material=e})}initEvent(){O.on(l.Game_SkinChange_Event,this,()=>{W.bornFxDestroy("B_Up",this.mainScene,3e3,1,this.player.transform.position.clone())}),O.on(l.Game_CountChange_Event,this,()=>{let t=nt.ReadCountLevel()>99?99:nt.ReadCountLevel();console.log(t),this.itemsComp.reset(3*t+1)}),O.on(l.Game_AddMoneyCount_Event,this,this.addMoenyCount)}levelInit(){this.isEnd=!1,this.isStart=!1,Laya.timer.clear(this,this.gameUpdate),W.stageObjClear(),this.dropObjs=[],this.colliders=[],this.nowRound=0,this.moneyCount=0;new Laya.Vector3,new Laya.Vector3;if(this.isBornStage){let t;if(this.isReadJsonOrScene)t=this.stageJson;else{let e=this.stage.getChildByName("Level"),a=[];for(let t=0;t<e.numChildren;t++){let i=e.getChildAt(t),n={name:"",setInfo:[]};n.name=i.name;for(let t=0;t<i.numChildren;t++){let e=i.getChildAt(t),a={name:"",roads:[],objs:[]};a.name=e.name;let s=e.getChildByName("Roads");for(let t=0;t<s.numChildren;t++)a.roads.push(s.getChildAt(t).name);let o=e.getChildByName("Objs");for(let t=0;t<o.numChildren;t++){let e=o.getChildAt(t),i=tt.d3_FindNodeHasName(e,"PosSet").name.split("_"),n={name:e.name,axis:i[1],horizontal:i[2]};a.objs.push(n)}n.setInfo.push(a)}a.push(n)}console.log(JSON.stringify(a)),t=a}let e=nt.ReadGrade()-1;console.log("当前关卡序号",e),t=e>=t.length?t[tt.randomInt(5,t.length-1)].setInfo:t[e].setInfo,console.log(t);let a=new Laya.Sprite3D("Stage");W.stageObj.push(a),W.stage=a;let i=a.addComponent(Q);this.stage.addChild(a),a.transform.localPosition=new Laya.Vector3,a.transform.localRotation=new Laya.Quaternion;for(let e=0;e<t.length;e++){let n=new Laya.Sprite3D(t[e].name),s=n.addComponent(q);a.addChild(n);let o=new Laya.Sprite3D("Roads");n.addChild(o),o.transform.localPosition=new Laya.Vector3,o.transform.localRotation=new Laya.Quaternion;for(let a=0;a<t[e].roads.length;a++){W.bornStageObj(t[e].roads[a],o).getChildByName("Path").addComponent(Y).updateCul()}s.updateLength(),Laya.timer.frameOnce(1,this,()=>{let a=new Laya.Sprite3D("Objs");n.addChild(a),a.transform.localPosition=new Laya.Vector3,a.transform.localRotation=new Laya.Quaternion;for(let n=0;n<t[e].objs.length;n++){let s=W.bornStageObj(t[e].objs[n].name,a),o=s.addComponent(Z),r=s.addComponent(ut);o.axis=parseFloat(t[e].objs[n].axis),o.horizontal=parseFloat(t[e].objs[n].horizontal),r.setData(t[e].objs[n].name);let h=this.colliderIndexJudge(o);this.colliders[h].push(r),o.stage=i,o.go()}})}i.setUpdate();let n=Math.ceil(i.endAxis/this.colliderRange);for(let t=0;t<n;t++)this.colliders.push([]);this.stageComp=i;let s=W.bornStageObj("EndBoard",this.mainScene),o=s.addComponent(Z);o.stage=i,o.axis=i.endAxis,o.go();let r=s.getChildByName("Model").getChildByName("box");this.endGrips=[];let h=r.getChildAt(0);for(let t=0;t<3;t++)this.endGrips.push(h.getChildByName("Grip"+t));for(let t=1;t<=39;t++){let e=h.clone();W.stageObj.push(e),r.addChild(e),e.transform.localPosition=new Laya.Vector3(0,2.47*t,0);for(let t=0;t<3;t++)this.endGrips.push(e.getChildByName("Grip"+t));let a=1;(a=Math.ceil(t/2)+1)>8&&(a=8);let i="res/scene/Texture/Name_"+a.toString()+".png",n=e.getChildByName("Name1_1"),s=e.getChildByName("Name1_2");Laya.Texture2D.load(i,Laya.Handler.create(this,t=>{let e=n.meshRenderer.material.clone();e.albedoTexture=t,n.meshRenderer.material=e,s.meshRenderer.material=e}))}this.endBoard=s}else this.moneyCount=100;this.camPoint.transform.localPosition=this.runMoveComp.startCamPoint.transform.localPosition.clone(),this.camPoint.transform.localRotation=this.runMoveComp.startCamPoint.transform.localRotation.clone(),this.runMoveComp.posSet.stage=this.stageComp,Laya.timer.frameOnce(2,this,()=>{let t=nt.ReadCountLevel()>99?99:nt.ReadCountLevel();this.itemsComp.reset(3*t+1)}),this.runMoveComp.isCamCtrl=!0,Laya.timer.frameLoop(1,this,this.gameUpdate)}gameStart(){this.isStart=!0,this.controlOn(),this.roundInit(),this.playCount++,Laya.timer.loop(16,this,this.fixUpdate),this.runMoveComp.isMove=!0}levelEnd(t){this.isEnd=!0,this.isWin=t,this.runMoveComp.isMove=!1,this.runMoveComp.isCamCtrl=!1,this.controlOff(),this.onMouseUp(),this.nowRound=9999,Laya.timer.clear(this,this.fixUpdate),t?$.play(d.Win):$.play(d.Fail),Laya.timer.once(1e3,this,()=>{O.event(l.Scene_GoOver)})}roundInit(){let t;switch(this.nowRound){case 0:O.on(l.Game_RoadToEnd_Event,this,this.roundEnd),O.on(l.Game_Over_Event,this,this.Lose);break;case 1:O.off(l.Game_RoadToEnd_Event,this,this.roundEnd),O.off(l.Game_Over_Event,this,this.Lose),this.controlOff(),this.onMouseUp(),this.runMoveComp.targetHorizontal=0,this.runMoveComp.isCamCtrl=!1,(t=new V).toTween(K.instance.camPoint,{pos:K.instance.endCamPoint.transform.localPosition.clone(),rot:K.instance.endCamPoint.transform.localRotation.clone()},1e3,null,null,!0);break;case 2:this.runMoveComp.isMove=!1,this.runMoveComp.isCamCtrl=!1,this.moneyCount>9999&&(this.moneyCount=9999),this.moneyCount>nt.ReadHighScore()&&nt.WriteHighScore(this.moneyCount);let e=dt.instance.items.numChildren;this.moneyCount+=Math.floor(e*(1+nt.ReadNowSkin())*(1+.2*nt.ReadIncomeLevel())),t=new V;let a=K.instance.endCamPoint.transform.localPosition.clone();e>15&&(a.y+=2.47*(e-15)/2);let i=2e3/(100*e);i>1&&(i=1),t.toTween(K.instance.camPoint,{pos:a},100*e*i,()=>{},null,!0);let n=0,s=()=>{if(n>=this.endGrips.length)return;let t=dt.instance.getItem();if(!t)return void Laya.timer.once(1e3,this,()=>{this.roundEnd()});let e=this.endGrips[n];tt.d3_addChildNotMove(t.self,e);let a=t.posSet.model.transform.position.clone();if(t.posSet.horizontal=0,t.posSet.go(),t.self.transform.position=a,++n%3==0){let t=tt.d3_FindNodeByName(e.parent,"Bulb_1"),a=tt.d3_FindNodeByName(e.parent,"Bulb_2");tt.d3_swtichMatColor(t,tt.d3_getRgbByHex("#FFFF00")),tt.d3_swtichMatColor(a,tt.d3_getRgbByHex("#FFFF00")),W.bornFxFromPool("BulbLight",t,1e3),W.bornFxFromPool("BulbLight",a,1e3)}it.instance.vibrateShort(),t.clearSkinRot(),t.selfTween.toTween(t.self,{pos:new Laya.Vector3,rot:new Laya.Quaternion},100*i,()=>{W.bornFxFromPool("B_Fit",t.self,1e3),$.playSoundLimit(d.Fill),s()},null,!0)};s();break;case 3:this.levelEnd(!0);break;default:console.log("多次触发跳关了")}}roundEnd(){this.isEnd||(this.nowRound++,this.roundInit())}Lose(){this.levelEnd(!1)}gameUpdate(){Laya.timer.delta;let t=()=>{let t=tt.d3_getSpritePosBySprite3DPoint(this.mainCamera,this.runMoveComp.model,new Laya.Vector3(1.5,0,0));F.instance&&(F.instance.showClip.x=t.x,F.instance.showClip.y=t.y)};switch(this.nowRound){case 0:t(),O.event(l.Game_Progress_Event,this.runMoveComp.posSet.axis/this.stageComp.endAxis);break;case 1:this.runMoveComp.posSet.axis>this.stageComp.endAxis-z.itemAxisSize&&this.roundEnd()}}fixUpdate(){{this.nowRound;let t,e,a,i=this.itemsComp.items,n=this.runMoveComp.posSet,s=n.model.transform.position.clone(),o={axis:n.axis,horizontal:n.horizontal};if(o.axis+=dt.instance.offsetZ-3*z.itemAxisSize,a=this.colliderIndexJudge(o),!this.runMoveComp.isHit&&a>=0&&a<this.colliders.length)for(let t=0;t<this.colliders[a].length;t++){let e,i=this.colliders[a][t];for(let n=0;n<this.colliders[a][t].colliderSprite.length;n++){let r=this.colliders[a][t].colliderSprite[n];if(r&&!r.destroyed){let t=r.getComponent(Z);if(i.isColliderStatic)e=i.isCircle?tt.CircleCheck_2D(o.axis,o.horizontal,(4*z.itemAxisSize+z.itemHorizontalSize)/4,t.axis,t.horizontal,i.raidus):tt.BoxCheck_2D_Normal(o.axis,o.horizontal,4*z.itemAxisSize,z.itemHorizontalSize,t.axis,t.horizontal,i.range,i.width);else{let t=r.transform.position.clone();e=tt.CircleCheck_2D(s.z,s.x,(4*z.itemAxisSize+z.itemHorizontalSize)/4,t.z,t.x,i.raidus)}e.isHit&&i.colliderDo()}}}if(this.isItemColliderOn)for(let n=0;n<i.numChildren;n++)if((t=i.getChildAt(n))&&!t.destroyed){if(o=t.getComponent(Z),!(e=t.getComponent(lt)).colliderActive)continue;if((a=this.colliderIndexJudge(o))>=0&&a<this.colliders.length)for(let t=0;t<this.colliders[a].length;t++){let i,n=this.colliders[a][t];for(let s=0;s<this.colliders[a][t].colliderSprite.length;s++){let r=this.colliders[a][t].colliderSprite[s];if(r&&!r.destroyed){let t=r.transform.position.clone();if((i=n.isCircle?tt.CircleCheck_2D(o.axis,o.horizontal,e.raidus,t.z,t.x,n.raidus):tt.BoxCheck_2D_Normal(o.axis,o.horizontal,e.range,e.width,t.z,t.x,n.range,n.width)).isHit)break}}if(i&&i.isHit){n.colliderDo(e);break}i&&!i.isHit&&-1!=n.hasColliderObj.indexOf(e)&&n.colliderExit(e)}}for(let n=0;n<this.dropItemGrip.numChildren;n++){let r=this.dropItemGrip.getChildAt(n);if(r&&!r.destroyed){let n=r.getComponent(ct);if(n.isColliderActive){let h,l=r.getComponent(Z),d={axis:l.axis,horizontal:l.horizontal},c=this.colliderIndexJudge(d),u=l.model.transform.position.clone();if(a=this.colliderIndexJudge(o),Laya.Vector3.distanceSquared(s,u)<z.itemHorizontalSize*z.itemHorizontalSize){n.colliderDo();break}if(this.isItemColliderOn)for(let s=0;s<i.numChildren;s++)if((t=i.getChildAt(s))&&!t.destroyed){if(o=t.getComponent(Z),!(e=t.getComponent(lt)).colliderActive)continue;if(a=this.colliderIndexJudge(o),Math.abs(c-a)<=1&&(h=tt.BoxCheck_2D_Normal(o.axis,o.horizontal,z.itemAxisSize,z.itemAxisSize,d.axis,d.horizontal,z.itemAxisSize,z.itemAxisSize)).isHit){n.colliderDo();break}}}}}}}colliderIndexJudge(t){return Math.floor(t.axis/this.colliderRange)}addMoenyCount(t){this.moneyCount+=t}changeSkin(){O.event(l.Game_SkinChange_Event)}controlOn(){O.on(y.singleTouchStart,this,this.onMouseDown),O.on(y.singleTouchMove,this,this.onMouseMove),O.on(y.singleTouchEnd,this,this.onMouseUp)}controlOff(){O.off(y.singleTouchStart,this,this.onMouseDown),O.off(y.singleTouchMove,this,this.onMouseMove),O.off(y.singleTouchEnd,this,this.onMouseUp)}onMouseDown(t){this.isPressed=!0,this.orignal=t.stageX/Laya.stage.width,this.runMoveComp&&this.runMoveComp.checkOut()}onMouseMove(t){if(this.isPressed){let e=t.stageX/Laya.stage.width-this.orignal;this.runMoveComp&&this.runMoveComp.checkWay(2*e)&&(this.orignal=t.stageX/Laya.stage.width)}}onMouseUp(){this.isPressed=!1,this.runMoveComp&&this.runMoveComp.checkOut()}}class yt extends R{constructor(){super(...arguments),this.coinBtnUrl="ui/game/ksjm_jm_dk.png",this.videoBtnUrl="ui/game/ksjm_mf_dk.png"}init(){gt.instance.playCount,this.upgradeBtnUpdate()}initEvent(){tt.d2_AddClickEvent(this.btnStart,this,this.onBtnStartClick),tt.d2_AddClickEvent(this.btnCount,this,this.onBtnCountClick),tt.d2_AddClickEvent(this.btnSkin,this,this.onBtnSkinClick),tt.d2_AddClickEvent(this.btnIncome,this,this.onBtnIncomClick),tt.d2_AddClickEvent(this.btnMore,this,()=>{S.Instance.clickHomeMoreGame()}),tt.d2_AddClickEvent(this.btnDraw,this,()=>{S.Instance.clickHomeMoreGame()})}onBtnStartClick(){S.Instance.clickStartGame(()=>{O.event(l.Scene_GoGame),S.Instance.showGameBanner()})}onBtnCountClick(){let t=nt.ReadCountLevel()>6?6:nt.ReadCountLevel(),e=z.upgradeCost[t],a=this.btnCount.getChildByName("video").visible,i=()=>{nt.AddCountLevel(),this.upgradeBtnUpdate()};a?it.instance.showVideo(()=>{it.instance.showToast("视频升级成功"),i()},()=>{it.instance.showToast("视频升级失败")}):nt.ReadCoin()>=e&&(nt.AddCoin(-e),i())}onBtnSkinClick(){let t=nt.ReadNowSkin()>6?6:nt.ReadNowSkin(),e=z.upgradeCost[t],a=this.btnSkin.getChildByName("video").visible,i=()=>{nt.AddNowSkin(),this.upgradeBtnUpdate()};a?it.instance.showVideo(()=>{it.instance.showToast("视频升级成功"),i()},()=>{it.instance.showToast("视频升级失败")}):nt.ReadCoin()>=e&&(nt.AddCoin(-e),i())}onBtnIncomClick(){let t=nt.ReadIncomeLevel()>6?6:nt.ReadIncomeLevel(),e=z.upgradeCost[t],a=this.btnIncome.getChildByName("video").visible,i=()=>{nt.AddIncomeLevel(),this.upgradeBtnUpdate()};a?it.instance.showVideo(()=>{it.instance.showToast("视频升级成功"),i()},()=>{it.instance.showToast("视频升级失败")}):nt.ReadCoin()>=e&&(nt.AddCoin(-e),i())}upgradeBtnUpdate(){let t=[nt.ReadCountLevel(),nt.ReadNowSkin(),nt.ReadIncomeLevel()],e=nt.ReadCoin(),a=-1,i=99999;for(let n=0;n<t.length;n++){let s=t[n]>6?6:t[n],o=z.upgradeCost[s],r=this.getUpgradeBtn(n),h=r.getChildByName("money");h.getChildByName("value").value=o.toString(),h.set_visible(!0),r.getChildByName("video").set_visible(!1);let l=r.getChildByName("black");l.set_visible(!1),r.skin=this.coinBtnUrl,r.getChildByName("level").getChildByName("value").value=(t[n]+1).toString(),e<o&&(o<i?(i=o,a=n):o==i&&tt.halfPercent()&&(i=o,a=n),l.set_visible(!0))}if(-1!=a){let t=this.getUpgradeBtn(a);t.skin=this.videoBtnUrl,t.getChildByName("money").set_visible(!1),t.getChildByName("video").set_visible(!0),t.getChildByName("black").set_visible(!1)}}getUpgradeBtn(t){switch(t){case 0:return this.btnCount;case 1:return this.btnSkin;case 2:return this.btnIncome}}}class ft extends Laya.Script{onEnable(){let t=this.owner;G.toScale(t,.9,1.1,500,null,()=>{},!1,!0)}onDisable(){let t=this.owner;G.clearTween(t),t.scale(1,1)}}class wt extends R{init(){Laya.timer.frameOnce(1,this,this.loadProgressUpdate)}initEvent(){O.on(l.Progress_Load_Update,this,this.loadProgressUpdate)}loadProgressUpdate(){let t=mt.loadingList;0==t.length?(console.log("加载完毕"),O.event(l.Scene_GoHome)):console.log("正在加载",t[0]),this.loadBar.value=(mt.loadingCount-t.length)/mt.loadingCount}}class pt extends R{constructor(){super(...arguments),this.coinUrl=z.coinUrl}init(){let t=this.btnContinue.getChildByName("coinValue");gt.instance.isWin?t.value=(this.videoCheckBox.selected?5*gt.instance.moneyCount:gt.instance.moneyCount).toString():(t.set_visible(!1),this.videoCheckBox.set_visible(!1)),this.btnContinue.skin=gt.instance.isWin?"ui/game/sljm_gold_button.png":"ui/game/sbjm_cxks_button.png",this.icon.skin=gt.instance.isWin?"ui/game/sljm_yxsl.png":"ui/game/sljm_yxsb.png",G.toScale(this.icon,0,1,500,Laya.Ease.elasticOut),S.Instance.showFinishUI(this,this.btnDraw)}initEvent(){this.videoCheckBox.on("change",this,()=>{this.btnContinue.getChildByName("coinValue").value=(this.videoCheckBox.selected?5*gt.instance.moneyCount:gt.instance.moneyCount).toString()}),tt.d2_AddClickEvent(this.btnContinue,this,this.onBtnContinueClick),tt.d2_AddClickEvent(this.btnDraw,this,()=>{S.Instance.clickFinishMoreGame()})}onBtnContinueClick(){let t=this,e=e=>{this.btnContinue.offAllCaller(this),gt.instance.isWin&&(e?nt.AddCoin(5*gt.instance.moneyCount):nt.AddCoin(gt.instance.moneyCount)),gt.instance.isWin?tt.d2_coinCollectAnim(this.coinUrl,new Laya.Vector2(t.btnContinue.x,t.btnContinue.y),new Laya.Vector2(t.coin.x,t.coin.y),t.scene,10,1,()=>{$.play(d.GetMoney),nt.AddGrade(),S.Instance.closeFinishUI(()=>{O.event(l.Scene_GoHome)})}):S.Instance.closeFinishUI(()=>{O.event(l.Scene_GoHome)})};this.videoCheckBox.selected&&gt.instance.isWin?it.instance.showVideo(()=>{e(!0)},()=>{it.instance.showToast("未看完视频，没有奖励")}):e(!1)}}class Ct extends Laya.Script{constructor(){super(...arguments),this.delayTime=0}onEnable(){let t=this.owner,e=t.y;Laya.timer.once(this.delayTime,this,()=>{G.toPosition(t,{y:e+15},1e3,Laya.Ease.sineInOut,()=>{},!0)})}onDisable(){let t=this.owner;G.clearTween(t),Laya.timer.clearAll(this)}}!function(t){t[t.has=0]="has",t[t.choose=1]="choose",t[t.coin=2]="coin",t[t.video=3]="video"}(f||(f={})),function(t){t[t.cup=0]="cup",t[t.hand=1]="hand",t[t.levelUp=2]="levelUp"}(p||(p={}));class Lt extends st{constructor(){super(...arguments),this.bgUrl=["ui/game/Shop/sd_bz_bj.png","ui/game/Shop/sd_sb_bj.png","ui/game/Shop/sd_ys_bj.png"],this.showUrl=["ui/game/Shop/sd_bz_zst.png","ui/game/Shop/sd_sb_zst.png","ui/game/Shop/sd_ys_zst.png"],this.itemUrl=["ui/game/Shop/skin.png","ui/game/Shop/skin_selected.png","ui/game/Shop/skin_buy.png","ui/game/Shop/skin_buy.png"],this.nowType=p.cup}init(){this.self.width=Laya.stage.width,this.self.height=Laya.stage.height,this.self.x=0,this.self.y=0,this.mainPanel=this.self.getChildByName("mainPanel"),this.closeBtn=this.self.getChildByName("closeBtn"),this.bg=this.self.getChildByName("bg"),this.showImage=this.self.getChildByName("showImage"),this.cupType=this.mainPanel.getChildByName("cupType"),this.handType=this.mainPanel.getChildByName("handType"),this.levelUpType=this.mainPanel.getChildByName("levelUpType"),this.nowType=p.cup,this.switchType(this.nowType),this.initEvent()}initEvent(){tt.d2_AddClickEvent(this.closeBtn,this,this.onCloseClick),tt.d2_AddClickEvent(this.cupType,this,this.switchType,[p.cup],!1,!0,!1),tt.d2_AddClickEvent(this.handType,this,this.switchType,[p.hand],!1,!0,!1),tt.d2_AddClickEvent(this.levelUpType,this,this.switchType,[p.levelUp],!1,!0,!1)}onCloseClick(){this.self.set_visible(!1),this.closeCB&&this.closeCB()}switchType(t){this.nowType=t;let e=this.cupType.getChildAt(0),a=this.handType.getChildAt(0),i=this.levelUpType.getChildAt(0);switch(e.set_visible(!0),a.set_visible(!0),i.set_visible(!0),this.bg.skin=this.bgUrl[t],this.showImage.skin=this.showUrl[t],this.nowType){case p.cup:e.set_visible(!1);break;case p.hand:a.set_visible(!1);break;case p.levelUp:i.set_visible(!1);break;default:console.error("选择错误的类型",t)}this.initList(),this.updateShow()}initList(){this.list=this.mainPanel.getChildByName("list"),this.list.selectEnable=!1,this.list.renderHandler=Laya.Handler.create(this,this.onListRender,null,!1),this.list.hScrollBarSkin="",this.list.repeatX=3,this.list.repeatY=2}onListRender(t,e){let a,i=t.getChildByName("Item"),n=i.getChildByName("icon"),s=i.getChildByName("coin"),o=i.getChildByName("video"),r=f.has;switch(s.set_visible(!1),o.set_visible(!1),this.nowType){case p.cup:n.skin="ui/game/Shop/Cup/buck"+(e+1)+".png";break;case p.hand:n.skin="ui/game/Shop/Hand/hand0"+e+".png";break;case p.levelUp:n.skin="ui/game/Shop/LevelUp/frap0"+(e+1)+".png"}switch(r){case f.coin:s.set_visible(!0),a=s.getChildAt(0);break;case f.video:o.set_visible(!0),a=o.getChildAt(0)}i.skin=this.itemUrl[r],i.scale(1,1)}clickEvent(t){let e=t.id,a=t.type,i=t.unlockType,n=t=>{this.nowChooseIndex=t};switch(i){case f.has:n(e);break;case f.choose:break;case f.coin:nt.CostCoin(t.unlockCount)&&((e,a)=>{t[e][a]=-1,n(a)})(a,e);break;case f.video:it.instance.showVideo(()=>{},()=>{it.instance.showToast("视频解锁失败")})}this.updateShow(),this.list.refresh()}updateShow(){let t,e=this.nowChooseIndex;switch(this.nowType){case p.cup:t="ui/game/Shop/Cup/buck"+(e+1)+".png";break;case p.hand:t="ui/game/Shop/Hand/hand0"+e+".png";break;case p.levelUp:t="ui/game/Shop/LevelUp/frap0"+(e+1)+".png";break;default:t=""}this.showImage.getChildByName("icon").skin=t}}class vt{constructor(){}static init(){var t=Laya.ClassUtils.regClass;t("JJExport/View/EndBoxUI.ts",I),t("JJExport/Component/ScaleLoop.ts",B),t("JJExport/Common/RotateLoop.ts",k),t("JJExport/View/FinishExportUI.ts",M),t("JJExport/View/FinishScrollUI.ts",P),t("JJExport/View/GridUI.ts",T),t("JJExport/View/GridUI2.ts",E),t("JJExport/View/GridUI3.ts",N),t("JJExport/View/GridUI4.ts",J),t("JJExport/View/RunUI.ts",D),t("JJExport/View/StartBoxUI.ts",H),t("Scenes/Game.ts",F),t("Tools/ctrl/TouchCtrl.ts",at),t("Tools/ctrl/TouchScan.ts",et),t("UIComps/CoinComp.ts",ot),t("UIComps/StageComp.ts",rt),t("Scenes/Home.ts",yt),t("Tools/uiTween/ScaleUITween.ts",ft),t("Scenes/Load.ts",wt),t("Scenes/Over.ts",pt),t("Tools/uiTween/PosUITween.ts",Ct),t("UIComps/ShopComp.ts",Lt)}}vt.width=750,vt.height=1334,vt.scaleMode="fixedwidth",vt.screenMode="vertical",vt.alignV="middle",vt.alignH="center",vt.startScene="JJExport/EndBoxUI.scene",vt.sceneRoot="",vt.debug=!1,vt.stat=!1,vt.physicsDebug=!1,vt.exportSceneToJson=!0,vt.init();class _t extends it{init(){super.init(),this.platformApi=Laya.Browser.window.wx,this.showShareMenuWithTicket(!0),this.regisiterWXShareCallback()}showToast(t,e=1500){Laya.Browser.window.wx.showToast({title:t,icon:"none",duration:e})}showShareMenuWithTicket(t){wx.showShareMenu({withShareTicket:t,success:function(){},fail:function(){},complete:function(){}})}regisiterWXShareCallback(){if(Laya.Browser.onWeiXin){var t={title:"分享",image:""};Laya.Browser.window.wx.onShareAppMessage(function(){return console.log("用户点击了转发按钮"),{title:t.title,imageUrl:t.image,query:"share_id=1"}})}}showVideo(t,e){_.Instance.showVideoAd(()=>{},a=>{a?t&&t():e&&e()})}}class St{static init(){this.isStatShow&&(Laya.Stat.show(),$.muiscSwitch(!1)),this.game=new gt,this.goLoad(),mt.addLoadRes(h.SubPackage),mt.addLoadRes(h.Scene3D),Laya.Browser.onWeiXin&&(mt.addLoadRes(h.SDK),x.instance.initJJ(()=>{S.Instance.Level=nt.ReadGrade(),mt.removeLoadRes(h.SDK)})),$.init(),nt.CheckPlayerData(),Laya.Browser.onWeiXin?this.platform=new _t:this.platform=new it,this.platform.init();this.platform.loadSubPackage(this.subPackageName,t=>{t&&(mt.removeLoadRes(h.SubPackage),this.load3DRes(this.scene3DUrl))})}static sceneEventOn(){O.on(l.Scene_GoHome,this,this.goHome),O.on(l.Scene_GoGame,this,this.goGame),O.on(l.Scene_GoOver,this,this.goOver)}static goLoad(){this.sceneEventOn(),this.openScene(r.Load)}static goHome(){this.closeScene(r.Load),this.closeScene(r.Over),this.openScene(r.Home),this.game.levelInit()}static goGame(){0==this.game.playCount&&$.randomPlayMusic(),this.closeScene(r.Home),this.openScene(r.Game),this.game.gameStart()}static goOver(){this.closeScene(r.Game),S.Instance.showGameOver(()=>{this.openScene(r.Over)})}static load3DRes(t){var e=[{url:t,clas:Laya.Scene3D,priority:1}];Laya.loader.create(e,Laya.Handler.create(this,this.onLoadFinished,[{target:"3dRes"}],!1),Laya.Handler.create(this,this.onLoading,null,!1)),Laya.loader.on(Laya.Event.ERROR,this,e=>{console.error("资源加载失败",e),this.load3DRes(t)})}static onLoadFinished(t){console.log("资源加载完成",t),this.loadSceneRes(),mt.removeLoadRes(h.Scene3D)}static onLoading(t){}static loadSceneRes(){let t=Laya.loader.getRes(this.scene3DUrl);Laya.stage.addChild(t),Laya.stage.setChildIndex(t,0),this.game.mainScene=t,this.game.firstIn()}static openScene(t,e){Laya.Scene.open(t,!1,null,Laya.Handler.create(this,t=>{Laya.stage.addChild(t),e&&e()}))}static closeScene(t,e){Laya.Scene.close(t)&&e&&e()}static checkPerformance(t,e,a){let i=0,n=100,s=n;Laya.timer.loop(100,this,function addValue(){i+=1e3/Laya.timer.delta;s--;if(s<=0){Laya.timer.clear(this,addValue);let s=i/n;s>50?t&&t():s>40?e&&e():a&&a()}})}}St.subPackageName="scene",St.scene3DUrl="res/scene/Conventional/ResScene.ls",St.isStatShow=!1;new class{constructor(){window.Laya3D?Laya3D.init(vt.width,vt.height):Laya.init(vt.width,vt.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=vt.scaleMode,Laya.stage.screenMode=vt.screenMode,Laya.stage.alignV=vt.alignV,Laya.stage.alignH=vt.alignH,Laya.URL.exportSceneToJson=vt.exportSceneToJson,(vt.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),vt.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),vt.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){St.init()}}}();