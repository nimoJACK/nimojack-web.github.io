!function(){"use strict";class e{static on(e,t,a){this.eventDispatcher.on(e,t,a)}static event(e,t){this.eventDispatcher.event(e,t)}static off(e,t,a){this.eventDispatcher.off(e,t,a)}static offAllCaller(e){this.eventDispatcher.offAllCaller(e)}}e.eventDispatcher=new Laya.EventDispatcher;class t extends Laya.Scene{onAwake(){this.size(Laya.stage.width,Laya.stage.height),this.init(),this.initEvent()}onClosed(){e.offAllCaller(this),Laya.timer.clearAll(this)}init(){}initEvent(){}}class a extends t{init(){a.instance=this}initEvent(){}}var i,s,o,n,r,l,h,d,c,y;!function(e){e.Load="scenes/Load.scene",e.Home="scenes/Home.scene",e.Game="scenes/Game.scene",e.Over="scenes/Over.scene"}(i||(i={})),function(e){e.SubPackage="分包",e.Scene3D="3D场景",e.SDK="SDK"}(s||(s={})),function(e){e.Scene_GoHome="Scene_GoHome",e.Scene_GoGame="Scene_GoGame",e.Scene_GoOver="Scene_GoOver",e.Progress_Load_Update="Progress_Load_Update",e.Platform_Wake_Do="Platform_Wake_Do",e.Platform_Hide_Do="Platform_Hide_Do",e.Game_Coin_Update="Game_Coin_Update",e.Game_BoradEnd_Event="Game_BoradEnd_Event",e.Game_BoradUpdate_Event="Game_BoradUpdate_Event",e.Game_FightOver_Event="Game_FightOver_Event",e.Game_HealthUpgrde_Event="Game_HealthUpgrde_Event",e.Game_addMoneyCount_Event="Game_addMoneyCount_Event"}(o||(o={})),function(e){e.Bgm="Bgm",e.Button="Button",e.Get="Get",e.Water="Water",e.Cool="Cool",e.Press="Press",e.Polish="Polish",e.Obstacle="Obstacle",e.Upgrade="Upgrade",e.Merge="Merge",e.PlayerAttack="PlayerAttack",e.BossAttack="BossAttack",e.Ending="Ending",e.Win="Win",e.Fail="Fail",e.GetMoney="GetMoney",e.Landing="Landing"}(n||(n={})),function(e){e.Item_Box="Item_Box"}(r||(r={})),function(e){e[e.Box=0]="Box",e[e.Water=1]="Water",e[e.Cool=2]="Cool",e[e.Steel=3]="Steel",e[e.Blade=4]="Blade"}(l||(l={})),function(e){e.Obs_Box="Obs_Box",e.Obs_Water="Obs_Water",e.Obs_Cool="Obs_Cool",e.Obs_Press="Obs_Press",e.Obs_Polish="Obs_Polish",e.Obs_1="Obs_1",e.Obs_2="Obs_2",e.Door_1="Door_1"}(h||(h={}));class m{constructor(){this.tween=new Laya.Tween,this.tweens=[]}getTimeByFrame(e){return Math.round(10*e)}toTween(e,t,a,i,s,o=!0){if(this.target=e,this.isLocal=o,e&&!e.destroyed){var n={},r={};if(t.pos){var l=o?e.transform.localPosition.clone():e.transform.position.clone();n.posX=l.x,n.posY=l.y,n.posZ=l.z,r.posX=t.pos.x,r.posY=t.pos.y,r.posZ=t.pos.z}if(t.rot){var h=o?e.transform.localRotation.clone():e.transform.rotation.clone();n.rotX=h.x,n.rotY=h.y,n.rotZ=h.z,n.rotW=h.w,r.rotX=t.rot.x,r.rotY=t.rot.y,r.rotZ=t.rot.z,r.rotW=t.rot.w}if(t.sca){var d=e.transform.getWorldLossyScale().clone();n.scaX=d.x,n.scaY=d.y,n.scaZ=d.z,r.scaX=t.sca.x,r.scaY=t.sca.y,r.scaZ=t.sca.z}this.tween.to(n,{posX:r.posX,posY:r.posY,posZ:r.posZ,rotX:r.rotX,rotY:r.rotY,rotZ:r.rotZ,rotW:r.rotW,scaX:r.scaX,scaY:r.scaY,scaZ:r.scaZ},a,s,Laya.Handler.create(this,()=>{i&&i();var t=this.tweens.shift();e&&!e.destroyed&&(t?this.toTween(this.target,t.value,t.time,t.completeFun,s):this.updateTweenCallback&&(this.updateTweenCallback=null))}));var c=0;return this.tween.update=new Laya.Handler(this,()=>{if(!e||e.destroyed)return;let i=(c+=Laya.timer.delta)/a;i>1&&(i=1),t.pos&&(o?e.transform.localPosition=new Laya.Vector3(n.posX,n.posY,n.posZ):e.transform.position=new Laya.Vector3(n.posX,n.posY,n.posZ)),t.rot&&(o?e.transform.localRotation=new Laya.Quaternion(n.rotX,n.rotY,n.rotZ,n.rotW):e.transform.rotation=new Laya.Quaternion(n.rotX,n.rotY,n.rotZ,n.rotW)),t.sca&&e.transform.setWorldLossyScale(new Laya.Vector3(n.scaX,n.scaY,n.scaZ)),this.updateTweenCallback&&this.updateTweenCallback(i)}),this}}clearTween(e){this.tweens=[],this.tween.clear(),this.target&&e&&(e.pos&&(this.isLocal?this.target.transform.localPosition=new Laya.Vector3(e.pos.x,e.pos.y,e.pos.z):this.target.transform.position=new Laya.Vector3(e.pos.x,e.pos.y,e.pos.z)),e.rot&&(this.target.transform.rotation=new Laya.Quaternion(e.rot.x,e.rot.y,e.rot.z,e.rot.w)),e.sca&&this.target.transform.setWorldLossyScale(new Laya.Vector3(e.sca.x,e.sca.y,e.sca.z)))}then(e,t,a){return this.tweens.push({value:e,time:t,completeFun:a}),this}toScaleTween(e,t,a,i,s,o=Laya.Ease.elasticOut){e&&!e.destroyed&&(e.transform.localScale=t,this.toTween(e,{sca:a},i,s,o))}}class p extends Laya.Script3D{onAwake(){this.self=this.owner,this.selfTween=new m,this.init()}init(...e){}onDestroy(){Laya.timer.clearAll(this),this.selfTween.clearTween(),e.offAllCaller(this)}tweenBornDo(){let e=this.selfTween;e.clearTween(),this.self.transform.localScale=new Laya.Vector3(0,0,0),e.toTween(this.self,{sca:new Laya.Vector3(1,1,1)},500,null,Laya.Ease.elasticOut)}}class g extends p{constructor(){super(...arguments),this.forwardSpeed_Data=2,this.speedAxis=1,this.isCamCtrl=!0,this.isMove=!1,this.axis=0,this.horizontal=0,this.modelMoveRange=12,this.camPointMoveRange=6,this.forwardSpeed=0,this.horizontalSensity=.12,this.forwardSensity=.15,this.wayAxis=0,this.targetYpos=0,this.targetHorizontal=0,this.inHorizontal=0}init(){g.instance=this,this.player=this.self,this.model=this.player.getChildByName("Model"),this.camPoint=this.player.getChildByName("CamPoint"),this.startCamPoint=this.player.getChildByName("CamStartPoint"),this.forwardSpeed=this.forwardSpeed_Data}reset(e,t){this.axis=e,this.horizontal=t,this.targetHorizontal=t,this.speedAxis=1;let a=this.player.transform.localPosition.clone();a.z=this.axis,this.player.transform.localPosition=a;let i=this.model.transform.localPosition.clone();i.x=-this.modelMoveRange*this.horizontal,this.model.transform.localPosition=i;let s=this.camPoint.transform.localPosition.clone();s.x=-this.camPointMoveRange*this.horizontal,this.camPoint.transform.localPosition=s;let o=this.player.transform.position.clone();o.y=0,this.targetYpos=0,this.player.transform.position=o}onUpdate(){let e=Laya.timer.delta/16;this.forwardSpeed>=0?this.isMove&&(this.axis+=this.forwardSpeed*this.forwardSensity*e*this.speedAxis):this.forwardSpeed<0&&(this.axis+=this.forwardSpeed*this.forwardSensity*e*this.speedAxis),this.wayAxis=this.targetHorizontal-this.horizontal,this.horizontal+=this.wayAxis*this.horizontalSensity*e;let t=this.player.transform.localPosition.clone();t.z=this.axis,this.isMove&&(this.player.transform.localPosition=t);let a=this.model.transform.localPosition.clone();if(a.x=-this.modelMoveRange*this.horizontal,this.model.transform.localPosition=a,this.isCamCtrl){let e=this.camPoint.transform.localPosition.clone();e.x=this.startCamPoint.transform.localPosition.x-this.camPointMoveRange*this.horizontal,this.camPoint.transform.localPosition=e}if(this.isMove){let e=this.player.transform.position.clone(),t=Laya.timer.delta/1e3*15;t>1&&(t=1),e.y=Laya.MathUtil.lerp(e.y,this.targetYpos,t),this.player.transform.position=e}}changeHegiht(e){this.targetYpos=e}checkWay(e){let t=!1;return this.targetHorizontal=this.inHorizontal+e,this.targetHorizontal>.5?(this.targetHorizontal=.5,this.checkOut(),t=!0):this.targetHorizontal<-.5&&(this.targetHorizontal=-.5,this.checkOut(),t=!0),t}checkOut(){this.inHorizontal=this.targetHorizontal}Hit(e=1){this.forwardSpeed=-1*e,Laya.timer.frameLoop(1,this,this.HitUpdate)}HitUpdate(){this.forwardSpeed+=.2*Laya.timer.delta/16,this.forwardSpeed>=this.forwardSpeed_Data&&(Laya.timer.clear(this,this.HitUpdate),this.forwardSpeed=this.forwardSpeed_Data)}onDisable(){}}class u{}u.itemSize=4,u.coinUrl="ui/game/yxy_cp_1.png",u.musicTime=72e3,u.typesLevel=[0,0],u.maxLevel=[8,8],u.playerHp=[100],u.playerAtk=[50],u.playerAtkSpeed=[1],u.enemyHp=[100],u.enemyAtk=[10],u.enemyAtkSpeed=[1],u.enemyThinkTime=[500],u.enemyWeapon=[[0,0]],u.atkSpeed=[.7,.8,.9,1,1.1,1.2,1.3,1.4,1.5],u.atk=[10,20,30,40,50,60,70,80,90],u.hp=[1e3,1125,1250,1375,1500,1625,1750,1875,2e3];class f{static init(){for(var t in this._soundCtx={},this._soundFile=[],this.loopSounds=[],n){let e=n[t];this._soundFile.push(e)}console.log("音效：",this._soundFile);let a=this._pathRoot,i="",s=this._soundFile,r=this._soundFile.length;for(let e=0;e<r;++e){i=s[e];let t=new Laya.SoundChannel;t.url=a+i+this.soundType,Laya.SoundManager.addChannel(t),this._soundCtx[i]=!0}Laya.SoundManager.autoStopMusic=!0,Laya.Browser.onWeiXin&&(e.on(o.Platform_Wake_Do,this,this.randomPlayMusic),Laya.timer.once(1e3,this,this.randomPlayMusic))}static setSoundVolume(e,t){this._soundCtx[e]&&Laya.SoundManager.setSoundVolume(t,this._pathRoot+e+this.soundType)}static play(e,t=!1){if(this._soundCtx[e])return t&&-1==this.loopSounds.indexOf(e)?(this.loopSounds.push(e),Laya.SoundManager.playSound(this._pathRoot+e+this.soundType,0)):Laya.SoundManager.playSound(this._pathRoot+e+this.soundType)}static stop(e,t=!1){if(this._soundCtx[e]){if(t){let t=this.loopSounds.indexOf(e);-1!=t&&this.loopSounds.splice(t,1)}Laya.SoundManager.stopSound(this._pathRoot+e+this.soundType)}}static playMusic(e){let t;return Laya.SoundManager.stopMusic(),e?(t=Laya.SoundManager.playMusic(this._pathRoot+e+this.soundType,0),this.currentBgm=e):t=this.currentBgm?Laya.SoundManager.playMusic(this._pathRoot+this.currentBgm+this.soundType,0):Laya.SoundManager.playMusic(this._pathRoot+n.Bgm+this.soundType,0),t}static stopMusic(){Laya.SoundManager.stopMusic()}static randomPlayMusic(){let e=n.Bgm,t=(f.playMusic(e),u.musicTime);Laya.timer.once(t,this,this.randomPlayMusic)}static soundSwitch(e){this.isSound=e,Laya.SoundManager.soundMuted=!this.isSound}static muiscSwitch(e){this.isMusic=e,Laya.SoundManager.musicMuted=!this.isMusic}static playSoundLimit(e){let t=!0;if(this.CDs[e]&&0!=this.CDs[e]&&(t=!1),t){let t=this.play(e);t&&(this.CDs[e]=200*t.duration),Laya.timer.once(this.CDs[e],this,()=>{this.CDs[e]=0})}}}f._pathRoot="res/sounds/",f.soundType=".mp3",f.isSound=!0,f.isMusic=!0,f.CDs={};class L{static add(e,t){var a=new Laya.Vector3;return Laya.Vector3.add(e,t,a),a.clone()}static subtract(e,t){var a=new Laya.Vector3;return Laya.Vector3.subtract(e,t,a),a.clone()}static mull(e,t){var a=new Laya.Vector3;return Laya.Vector3.scale(e,t,a),a.clone()}static dot(e,t){return Laya.Vector3.dot(e,t)}static cross(e,t){var a=new Laya.Vector3;return Laya.Vector3.cross(e,t,a),a.clone()}static normalized(e){var t=new Laya.Vector3;return Laya.Vector3.normalize(e,t),t.clone()}static distance(e,t){var a=L.subtract(e,t);return Laya.Vector3.scalarLength(a)}}class C{static d3_getSpritePosBySprite3DPoint(e,t,a=new Laya.Vector3(0,0,0)){var i=t.transform.position.clone();i.x+=a.x,i.y+=a.y,i.z+=a.z;var s=new Laya.Vector4;e.viewport.project(i,e.projectionViewMatrix,s);var o=new Laya.Vector2(s.x/Laya.stage.clientScaleX,s.y/Laya.stage.clientScaleY);return new Laya.Point(o.x,o.y)}static d3_FindNodeByName(e,t){let a=null,i=e=>{for(let s=0;s<e.numChildren;s++){if(e.getChildAt(s).name==t)return void(a=e.getChildAt(s));i(e.getChildAt(s))}};return i(e),a}static d3_FindNodeHasName(e,t){let a=null,i=e=>{for(let s=0;s<e.numChildren;s++){if(-1!=e.getChildAt(s).name.indexOf(t))return void(a=e.getChildAt(s));i(e.getChildAt(s))}};return i(e),a}static d3_switchAllMathInChildren(e,t){if(e.meshRenderer){let a=e.meshRenderer.material.clone();a.albedoColor=C.d3_getRgbByHex(t),e.meshRenderer.material=a}for(let a=0;a<e.numChildren;a++){let i=e.getChildAt(a);if(i.meshRenderer){let e=new Laya.BlinnPhongMaterial,a=C.d3_getRgbByHex(t);e.albedoColor=new Laya.Vector4(a.x,a.y,a.z,1),e.specularColor=new Laya.Vector4(0,0,0,1),i.meshRenderer.material=e}this.d3_switchAllMathInChildren(i,t)}}static d3_unactiveAllChildren(e){for(let t=0;t<e.numChildren;t++)e.getChildAt(t).active=!1}static d3_swtichMatColor(e,t){let a=e.meshRenderer.material.clone();a.albedoColor=t,e.meshRenderer.material=a}static d3_addChildNotMove(e,t){let a=e.transform.position.clone(),i=e.transform.rotation.clone();t.addChild(e),e.transform.position=a,e.transform.rotation=i}static d3_getRgbByHex(e){var t=[],a=[];let i=e.replace(/#/,"");if(3==i.length){for(var s=[],o=0;o<3;o++)s.push(i.charAt(o)+i.charAt(o));i=s.join("")}for(o=0;o<3;o++)t[o]="0x"+i.substr(2*o,2),a.push(parseInt(t[o]));return new Laya.Vector4(a[0]/255,a[1]/255,a[2]/255,0)}static d3_objectShake(e,t=1,a=.7){var i=t,s=1,o=e.transform.localPosition.clone();Laya.timer.frameLoop(1,this,function updateShake(){if(i>0){var t=new Laya.Vector3;Laya.Vector3.scale((n=Math.random()>.5?Math.random():-Math.random(),r=Math.random()>.5?Math.random():-Math.random(),new Laya.Vector3(n,r,0)),a,t),Laya.Vector3.add(o,t,t),e.transform.localPosition=t,i-=.02*s}else i=0,e.transform.localPosition=o,Laya.timer.clear(this,updateShake);var n,r})}static getAngle(e,t){var a=Laya.Vector3.dot(e,t),i=Laya.Vector3.scalarLength(e)*Laya.Vector3.scalarLength(t);if(0==i){if(e.z>t.z)return 0;if(e.z<t.z)return 180;if(e.y>t.y)return 90;if(e.y<t.y)return-90}var s=a/i;return s<-1&&(s=-1),s>1&&(s=1),180*Math.acos(s)/Math.PI}static getAngleUp(e,t,a){let i=C.getAngle(e,t),s=new Laya.Vector3;return Laya.Vector3.cross(t,e,s),C.getAngle(a,s)>90&&(i*=-1),i}static getProjection(e,t){let a=L.mull(t,L.dot(e,t));return L.subtract(e,a)}static d2_AddClickEvent(e,t,a,i,s=!1,o=!0,r=!0){e.offAllCaller(t);let l=e.scaleX,h=.9*l,d=!1;e.on(Laya.Event.MOUSE_DOWN,t,t=>{d=!0,r&&Laya.Tween.to(e,{scaleX:h,scaleY:h},60),s&&t.stopPropagation},i);e.on(Laya.Event.MOUSE_UP,t,i=>{0!=d&&(d=!1,s&&i.stopPropagation,r&&Laya.Tween.to(e,{scaleX:l,scaleY:l},60),a&&a.call(t,i),o&&f.play(n.Button))},i);e.on(Laya.Event.MOUSE_OUT,t,t=>{0!=d&&(d=!1,r&&Laya.Tween.to(e,{scaleX:l,scaleY:l},60),s&&t.stopPropagation)},i)}static getAngle2DWay(e,t){var a=Laya.Vector2.dot(e,t),i=Laya.Vector2.scalarLength(e)*Laya.Vector2.scalarLength(t),s=180*Math.acos(a/i)/Math.PI,o=e.x*t.y-t.x*e.y;return o>0?s*=1:o<0?s*=-1:s=0,s}static d2_numberLabelToast(e,t){let a=e>=0?this.greenColor:this.redColor,i=e>=0?"+":"-",s=C.d3_getSpritePosBySprite3DPoint(g.instance.mainCamera,t,new Laya.Vector3(0,.2,0));C.d2_labelToast(i+e,a,Laya.stage,1,new Laya.Vector2(s.x,s.y))}static d2_coinCollectAnim(e,t,a,i,s=15,o=1,n=null,r=null){for(var l=s,h=0;h<s;h++){let s=Laya.Pool.getItemByClass("coin",Laya.Image);s.skin=e,s.x=t.x,s.y=t.y,s.scale(o,o),i.addChild(s);let h=300+100*Math.random()-50;Laya.Tween.to(s,{x:s.x+250*Math.random()-125,y:s.y+250*Math.random()-125},h),Laya.timer.once(h+50,this,function(){Laya.Tween.to(s,{x:a.x,y:a.y},400,null,new Laya.Handler(this,function(){i.removeChild(s),Laya.Pool.recover("coin",s),l--,r&&r(),0==l&&n&&n(i)}))})}}static d2_coinCollectAnimAni(e,t,a,i,s=15,o=null){for(var n=s,r=0;r<s;r++){let s=Laya.Pool.getItemByClass("coinAnim",Laya.Clip);s.skin=e.skin,s.index=e.index,s.clipX=e.clipX,s.clipY=e.clipY,s.autoPlay=e.autoPlay,s.x=t.x,s.y=t.y,s.scale(.8,.8),i.addChild(s);let r=300+100*Math.random()-50;Laya.Tween.to(s,{x:s.x+250*Math.random()-125,y:s.y+250*Math.random()-125},r),Laya.timer.once(r+50,this,function(){Laya.Tween.to(s,{x:a.x,y:a.y},400,null,new Laya.Handler(this,function(){i.removeChild(s),Laya.Pool.recover("coinAnim",s),0==--n&&o&&o(i)}))})}}static faceToast(e,t,a,i){let s=new Laya.Image(e);s.anchorX=.5,s.anchorY=.5,s.alpha=1,s.scaleX=.3,s.scaleY=.3,t.addChild(s),s.x=a.x,s.y=a.y,Laya.Tween.to(s,{x:i.x,y:i.y,alpha:.9},1e3,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{s&&!s.destroyed&&Laya.Tween.to(s,{x:i.x,y:i.y-100,alpha:0},1e3,null,Laya.Handler.create(this,()=>{s&&!s.destroyed&&s.destroy()}))}))}static d2_fontClipToast(e,t,a,i,s){if(!this.wordToastOk)return;let o=Laya.Pool.getItemByClass("fontClip_d2",Laya.FontClip);o.skin=e,o.sheet="0123456789",o.value=t,o.anchorX=.5,o.anchorY=.5,o.alpha=1,o.scaleX=i,o.scaleY=i,a.addChild(o),o.x=s.x,o.y=s.y;let n=new Laya.Vector2(s.x+(C.halfPercent()?C.randomInt(-100,-75):C.randomInt(75,100)),s.y-50);Laya.Tween.to(o,{x:n.x,y:n.y,alpha:.9},500,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{Laya.Tween.to(o,{x:n.x,y:n.y-90,alpha:0},500,null,Laya.Handler.create(this,()=>{a.removeChild(o),Laya.Pool.recover("fontClip_d2",o)}))}))}static d2_imageToast(e,t,a){if(!this.wordToastOk)return;C.wordToastOk=!1;let i=new Laya.Image(e);i.anchorX=.5,i.anchorY=.5,i.alpha=1,t.addChild(i),i.top=300,i.centerX=0;i.scaleX=0,i.scaleY=0,Laya.Tween.to(i,{scaleX:1,scaleY:1},500,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{C.wordToastOk=!0,i&&!i.destroyed&&Laya.Tween.to(i,{top:200,alpha:0},500,null,Laya.Handler.create(this,()=>{i&&!i.destroyed&&i.destroy()}))}))}static d2_labelToast(e,t,a,i,s){let o=Laya.Pool.getItemByClass("label_d2",Laya.Label);o.text=e,o.color=t,o.anchorX=.5,o.anchorY=.5,o.alpha=1,o.scaleX=i,o.scaleY=i,o.font="Microsoft YaHei",o.fontSize=50,o.bold=!0,a.addChild(o),o.x=s.x,o.y=s.y;let n=new Laya.Vector2(s.x+(C.halfPercent()?C.randomInt(-100,-75):C.randomInt(75,100)),s.y-50);Laya.Tween.to(o,{x:n.x,y:n.y,alpha:.9},500,Laya.Ease.strongOut,Laya.Handler.create(this,()=>{Laya.Tween.to(o,{x:n.x,y:n.y-90,alpha:0},500,null,Laya.Handler.create(this,()=>{a.removeChild(o),Laya.Pool.recover("label_d2",o)}))}))}static clamp01(e){return e>1?1:e<0?0:e}static clamp(e,t,a){return e<t?t:e>a?a:e}static get getCurrentTime(){return(new Date).getTime()}static get getCurrentTime_Second(){return Math.floor(Date.parse((new Date).toString())/1e3)}static math_gcd(e,t){return 0==t?e:this.math_gcd(t,e%t)}static numberTo(e,t,a){return Math.abs(t-e)<a?e=t:e<t?e+=a:e>t&&(e-=a),e}static randomNumber(e,t){return e+(t-e)*Math.random()}static randomInt(e,t){return Math.floor(e+(t+1-e)*Math.random())}static halfPercent(){return Math.random()<.5}static percent(e){return Math.random()<e}static cloneArray(e){return[].concat(e)}static getRandomInArray(e){if(e.length){let t=Math.random()*e.length;return e[t=Math.floor(t)]}return console.error("传入错误参数,返回空"),null}static takeRandomInArray(e){if(e.length){let t=Math.random()*e.length,a=e[t=Math.floor(t)];return e.splice(t,1),a}return console.error("传入错误参数,返回空"),null}static randomArray(e){let t=new Array(e.length),a=t.length;for(let i=0;i<a;i++){let a=this.takeRandomInArray(e);t[i]=a}return t}static BoxCheck_2D_Normal(e,t,a,i,s,o,n,r){let l=s-e,h=o-t,d=Math.abs(h),c=Math.abs(l),y=(i+r)/2,m=(a+n)/2;return{isHit:d<y&&c<m,axisDis:c,axisRange:m,horizontalDis:d,horizontalRange:y,axisWay:l,horizontalWay:h}}static CircleCheck_2D(e,t,a,i,s,o){let n=Math.pow(e-i,2)+Math.pow(t-s,2),r=Math.pow(a+o,2);return{isHit:n<r,distancePow2:n,rangePow2:r}}}C.greenColor="#00FF00",C.redColor="#FF0000",C.wordToastOk=!0,function(e){e.start="touchStart",e.move="touchMove",e.end="touchEnd",e.getAxis="GetAxis",e.slideWay="slideWay",e.singleTouchStart="singleTouchStart",e.singleTouchMove="singleTouchMove",e.singleTouchEnd="singleTouchEnd",e.secondTouchStart="secondTouchStart",e.secondTouchMove="secondTouchMove",e.secondTouchEnd="secondTouchEnd",e.getAxisAlways="getAxisAlways",e.keyDown="keyDown"}(d||(d={}));class w extends Laya.Script{constructor(){super(...arguments),this.isPressed=!1,this.hOriginal=0,this.vOriginal=0,this.hAxis=0,this.vAxis=0,this.outAxis=0,this.touchId=-1}onEnable(){w.instance=this}onMouseDown(t){e.event(d.start,[t])}onMouseMove(t){e.event(d.move,[t])}onMouseOut(t){e.event(d.end,[t])}onMouseOver(t){e.event(d.end,[t])}onMouseUp(t){e.event(d.end,[t])}}class v extends Laya.Script{constructor(){super(...arguments),this.calls=[],this.firstId=-1,this.secondId=-1,this.firstOriginalPoint=new Laya.Vector2,this.secondOriginalPoint=new Laya.Vector2,this.isSecond=!1,this.orignalHorizontal=0,this.orignalAxis=0,this.orignalHorizontalAlways=0,this.orignalAxisAlways=0,this.offset=new Laya.Vector3}onEnable(){e.on(d.start,this,this.onMouseDown),e.on(d.move,this,this.onMouseMove),e.on(d.end,this,this.onMouseUp)}onDisable(){e.off(d.start,this,this.onMouseDown),e.off(d.move,this,this.onMouseMove),e.off(d.end,this,this.onMouseUp)}onMouseDown(t){0==this.isSecond?-1==this.firstId?(this.checkOut(t),this.firstId=t.touchId,e.event(d.singleTouchStart,t),this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):this.firstId!=t.touchId&&-1==this.secondId&&(this.secondId=t.touchId,this.isSecond=!0,e.event(d.secondTouchStart,t),this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):-1==this.firstId?(this.firstId=t.touchId,this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):-1==this.secondId&&(this.secondId=t.touchId,this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),this.checkOutAlways(t)}onMouseMove(t){if(0==this.isSecond)t.touchId==this.firstId&&(this.checkWay(t),this.checkOut(t),e.event(d.singleTouchMove,t));else if(-1!=this.firstId&&-1!=this.secondId){let a,i={distance:0,angle:0},s=this.Vector2Reduce(this.secondOriginalPoint,this.firstOriginalPoint),o=Laya.Vector2.scalarLength(s);if(t.touchId==this.firstId?a=this.Vector2Reduce(this.secondOriginalPoint,new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)):t.touchId==this.secondId&&(a=this.Vector2Reduce(new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height),this.firstOriginalPoint)),a){let t=Laya.Vector2.scalarLength(a);i.distance=t-o,i.angle=C.getAngle2DWay(s,a),e.event(d.secondTouchMove,i)}}t.touchId==this.firstId&&(this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),t.touchId==this.secondId&&(this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),this.checkWayAlways(t)}onMouseUp(t){this.checkOutAlways(t),t.touchId==this.firstId&&(this.firstOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),t.touchId==this.secondId&&(this.secondOriginalPoint=new Laya.Vector2(t.stageX/Laya.stage.width,t.stageY/Laya.stage.height)),0==this.isSecond?t.touchId==this.firstId&&(this.checkOut(t),e.event(d.singleTouchEnd,t),this.firstId=-1):(t.touchId==this.firstId&&(this.firstId=-1),t.touchId==this.secondId&&(this.secondId=-1),-1==this.firstId&&-1==this.secondId&&(this.isSecond=!1))}WayCheck(){let e=this.Vector2Reduce(this.nowPos,this.startPos);if(Laya.Vector2.scalarLength(e)>100){let t=Math.atan2(e.y,e.x)/Math.PI*180,a="none";t>-135&&t<-45?a="up":t>-45&&t<45?a="right":t<135&&t>45?a="down":(t<-135||t>135)&&(a="left"),this.isDown=!1}this.startPos=this.nowPos}onDestroy(){this.touchTimer&&clearTimeout(this.touchTimer)}checkWay(t){let a=t.stageX-this.orignalHorizontal,i=t.stageY-this.orignalAxis;e.event(d.getAxis,[{x:a,y:i}])}checkOut(e){this.orignalHorizontal=e.stageX,this.orignalAxis=e.stageY}checkWayAlways(t){let a=t.stageX/Laya.stage.width-this.orignalHorizontalAlways,i=t.stageY/Laya.stage.height-this.orignalAxisAlways;this.checkOutAlways(t),e.event(d.getAxisAlways,[{x:a,y:i}])}checkOutAlways(e){this.orignalHorizontalAlways=e.stageX/Laya.stage.width,this.orignalAxisAlways=e.stageY/Laya.stage.height}modelRotateControlDown(){let e=new Laya.Vector3(Laya.MouseManager.instance.mouseX,Laya.MouseManager.instance.mouseY,0);this.startPosition=e.clone(),this.prePosition=e.clone()}modelRotateControlMove(){let e=new Laya.Vector3(Laya.MouseManager.instance.mouseX,Laya.MouseManager.instance.mouseY,0);Laya.Vector3.subtract(e,this.prePosition,this.offset),this.prePosition=e.clone();var t=new Laya.Vector3(this.offset.x,this.offset.y,0);let a=new Laya.Vector3;Laya.Vector3.cross(t,new Laya.Vector3(0,0,1),a),Laya.Vector3.normalize(a,a)}modelRotateControlUp(){new Laya.Vector3(Laya.MouseManager.instance.mouseX,Laya.MouseManager.instance.mouseY,0)}onKeyDown(t){e.event(d.keyDown,t)}Vector2Reduce(e,t){return new Laya.Vector2(e.x-t.x,e.y-t.y)}}class S{constructor(){this.isSubPackage=!0,this.isVibrate=!0}init(){S.instance=this}loadSubPackage(e,t){if(this.platformApi&&this.isSubPackage){this.platformApi.loadSubpackage({name:e,success:function(a){console.log("分包加载成功：",e),t.call(!0,a)},fail:function(a){console.error("分包加载失败：",e,JSON.stringify(a)),t.call(!1,a)}})}else console.log("没有平台API"),t(!0)}showToast(e,t=1e3){console.log(e,t.toString()+"ms")}vibrateShort(){this.platformApi&&this.isVibrate&&this.platformApi.vibrateShort()}vibrateLong(){this.platformApi&&this.isVibrate&&this.platformApi.vibrateLong()}regisiterCallback(){this.platformApi&&(this.platformApi.offShow(this.onShowEvent),this.platformApi.onShow(this.onShowEvent),this.platformApi.offHide(this.onHideEvent),this.platformApi.onHide(this.onHideEvent))}onShowEvent(t){e.event(o.Platform_Wake_Do,t)}onHideEvent(t){e.event(o.Platform_Hide_Do,t)}showVideo(e,t){this.showToast("无视频，默认发放奖励"),e&&e()}}class b{static AddGrade(){let e=this.GetPlayerData();e.grade++,parseInt(e.grade)>99&&(e.grade=99),this.SavePlayerData(e)}static ReadGrade(){let e=this.GetPlayerData();return parseInt(e.grade)}static addSpeedLevel(){let e=this.GetPlayerData();e.speedLevel++,e.speedLevel>99&&(e.speedLevel=99),this.SavePlayerData(e)}static readSpeedLevel(){return this.GetPlayerData().speedLevel}static addAttackLevel(){let e=this.GetPlayerData();e.attackLevel++,e.attackLevel>99&&(e.attackLevel=99),this.SavePlayerData(e)}static readAttackLevel(){return this.GetPlayerData().attackLevel}static addHealthLevel(){let e=this.GetPlayerData();e.healthLevel++,e.healthLevel>99&&(e.healthLevel=99),this.SavePlayerData(e)}static readHealthLevel(){return this.GetPlayerData().healthLevel}static AddCoin(t){let a=this.GetPlayerData();a.coin+=t,a.coin>99999&&(a.coin=99999),Math.floor(a.coin),this.SavePlayerData(a),e.event(o.Game_Coin_Update)}static CostCoin(e){let t=!1;return this.ReadCoin()>=e?(this.AddCoin(-e),t=!0):S.instance.showToast("金币不足"),t}static ReadCoin(){let e=this.GetPlayerData();return Math.floor(e.coin)}static GetPlayerData(){let e;return(e=Laya.LocalStorage.getJSON("PlayerData"))||(e=this.data,Laya.LocalStorage.setJSON("PlayerData",e),e)}static SavePlayerData(e){Laya.LocalStorage.setJSON("PlayerData",e)}static ClearPlayerData(){Laya.LocalStorage.clear()}static CheckPlayerData(){let e;(e=Laya.LocalStorage.getJSON("PlayerData"))&&e.ver&&e.ver==this.data.ver||(e=this.data,Laya.LocalStorage.setJSON("PlayerData",e),console.log("触发存档重置条件")),console.log(this.GetPlayerData())}}b.data={ver:"Blade_1.0.0",grade:1,coin:0,speedLevel:0,attackLevel:0,healthLevel:0};class x extends Laya.Script{onAwake(){this.self=this.owner,this.init()}init(...e){}onDestroy(){Laya.timer.clearAll(this),e.offAllCaller(this)}}class _ extends x{init(...t){this.value=this.self.getChildByName("value"),this.coinUpdate(),e.on(o.Game_Coin_Update,this,this.coinUpdate)}coinUpdate(){this.value.value=b.ReadCoin().toString()}}class k extends x{init(...e){this.value=this.self.getChildByName("value"),this.value.value=b.ReadGrade().toString()}}class M{static toAlpha(e,t,a,i,s,o,n=!1,r=!1){function alpha1(){let t=r||n?new Laya.Handler(this,alpha2):new Laya.Handler(this,()=>{o&&o(),o=null});Laya.Tween.to(e,{alpha:a},i,s,t)}function alpha2(){let a=r?new Laya.Handler(this,alpha1):new Laya.Handler(this,()=>{o&&o(),o=null});Laya.Tween.to(e,{alpha:t},i,s,a)}e&&!e.destroyed&&(this.clearTween(e),e.alpha=t,alpha1())}static toScale(e,t,a,i,s,o,n=!1,r=!1){function scale1(){let t=r||n?new Laya.Handler(this,scale2):new Laya.Handler(this,()=>{o&&o(),o=null});Laya.Tween.to(e,{scaleX:a,scaleY:a},i,s,t)}function scale2(){let a=r?new Laya.Handler(this,scale1):new Laya.Handler(this,()=>{o&&o(),o=null});Laya.Tween.to(e,{scaleX:t,scaleY:t},i,s,a)}e&&!e.destroyed&&(this.clearTween(e),e.scale(t,t),scale1())}static toPosition(e,t,a,i,s,o=!1,n=0){if(!e||e.destroyed)return;this.clearTween(e);let r={},l={};function pos1(){if(o)var t=0==n?new Laya.Handler(this,pos2):new Laya.Handler(this,pos3);else t=new Laya.Handler(this,()=>{s&&s(),s=null});Laya.Tween.to(e,l,a,i,t)}function pos2(){Laya.Tween.to(e,r,a,i,Laya.Handler.create(this,pos1))}function pos3(){e.pos(r.x,r.y),pos1()}null!=t.x&&(r.x=e.x,l.x=t.x),null!=t.y&&(r.y=e.y,l.y=t.y),pos1()}static toRotaion(e,t,a,i,s,o=!1,n=!1){if(!e||e.destroyed)return;this.clearTween(e);let r=e.rotation,l=r+t,h=r-t+r;function rotate2(){Laya.Tween.to(e,{rotation:h},2*a,i,Laya.Handler.create(this,rotate3))}function rotate3(){Laya.Tween.to(e,{rotation:l},2*a,i,Laya.Handler.create(this,rotate2))}function rotate4(){let t=new Laya.Handler(this,()=>{s&&s(),s=null});Laya.Tween.to(e,{rotation:r},a,i,t)}!function(){let t=n?new Laya.Handler(this,rotate2):o?new Laya.Handler(this,rotate4):new Laya.Handler(this,()=>{s&&s(),s=null});Laya.Tween.to(e,{rotation:l},a,i,t)}()}static showViewByScale(e,t,a=1,i=200){this.toScale(e,0,a,i,Laya.Ease.bounceOut,t,!0,!1)}static clearTween(e){Laya.Tween.clearAll(e)}}class P extends Laya.Script{onEnable(){let e=this.owner;M.toScale(e,.9,1.1,500,null,()=>{},!1,!0)}onDisable(){let e=this.owner;M.clearTween(e),e.scale(1,1)}}class B{static bornStageObj(e,t=this.mainScene){let a=this.prefabs.getChildByName(e);if(!a)return console.warn("生成物体不存在",e),null;let i=Laya.Sprite3D.instantiate(a,t);return i.transform.localPosition=new Laya.Vector3,this.stageObj.push(i),this.fxPool=[],i}static stageObjClear(){for(let e=this.stageObj.length-1;e>=0;e--)this.stageObj[e]&&!this.stageObj[e].destroyed&&this.stageObj[e].destroy();this.stageObj=[]}static bornFxDestroy(e,t,a=1e3,i=1,s=new Laya.Vector3){if(!this.isFxOn)return null;let o=this.fxs.getChildByName(e).clone();return t.addChild(o),o.transform.localPosition=s,o.transform.localRotationEuler=new Laya.Vector3,o.transform.localScale=new Laya.Vector3(i,i,i),Laya.timer.once(a,this,()=>{o.destroy()}),o}static bornFxFromPool(e,t,a=1e3,i=1,s=new Laya.Vector3){let o;for(let t=this.fxPool.length-1;t>=0;t--)if(this.fxPool[t].name==e){(o=this.fxPool.splice(t,1)[0]).active=!0;break}if(!o){let t=this.fxs.getChildByName(e);o=t.clone()}return t.addChild(o),this.stageObj.push(o),o.transform.localPosition=s,o.transform.localRotationEuler=new Laya.Vector3,o.transform.localScale=new Laya.Vector3(i,i,i),Laya.timer.once(a,this,()=>{o&&!o.destroyed&&(this.mainScene.addChild(o),o.active=!1,this.fxPool.push(o))}),o}static bornFxStage(e,t,a=1,i=new Laya.Vector3){let s=this.fxs.getChildByName(e).clone();return t.addChild(s),s.transform.localPosition=i,s.transform.localRotationEuler=new Laya.Vector3,s.transform.localScale=new Laya.Vector3(a,a,a),this.stageObj.push(s),s}}B.stageObj=[],B.isFxOn=!0,B.fxPool=[];class A extends p{constructor(){super(...arguments),this.yForceMin=1,this.yForceMax=2,this.xForceMin=.5,this.xForceMax=1,this.zForceMin=15,this.zForceMax=25,this.dir=new Laya.Vector3(0,1,0),this.gravity=0,this.yforce=0,this.xForce=0,this.zForce=0,this.rotate=new Laya.Vector3,this.dorpDeadY=-2,this.dropDeadChangeX=4,this.isDestory=!0,this.isActive=!0}init(){this.setData()}changeDropData(e,t,a,i,s,o){this.yForceMin=e.x,this.yForceMax=e.y,this.xForceMin=t.x,this.xForceMax=t.y,this.zForceMin=a.x,this.zForceMax=a.y,this.rotate=s,this.dir=i,this.gravity=o,this.setData()}setTimeDestroy(e=1e3){Laya.timer.once(e,this,()=>{this.self.destroy()})}setData(){this.xForce=C.randomNumber(this.xForceMin,this.xForceMax),this.yforce=C.randomNumber(this.yForceMin,this.yForceMax),this.zForce=C.randomNumber(this.zForceMin,this.zForceMax)}onUpdate(){if(!this.isActive)return;let e=Laya.timer.delta/1e3;this.yforce-=this.gravity*e;let t=this.self;t&&!t.destroyed&&(t.transform.translate(new Laya.Vector3(this.dir.x*this.xForce*e,this.yforce*e,this.dir.z*this.zForce*e),!1),Math.abs(this.self.transform.position.x)>this.dropDeadChangeX&&(this.dorpDeadY=-19.5),this.self.transform.position.y<this.dorpDeadY&&(this.isDestory?this.self.destroy():this.isActive=!1))}}class T extends p{constructor(){super(...arguments),this.range=1,this.width=1,this.raidus=1,this.colliderActive=!0,this.isBullet=!1,this.itemState=l.Box,this.isLib=!1,this.isSleeve=!1}init(...e){this.model=this.self.getChildAt(0).getChildByName("Model")}setData(e,t,a=!1){this.range=e,this.width=t,this.raidus=this.range>this.width?this.range:this.width,this.colliderActive=!0,this.isBullet=a}changeState(e){this.self.getChildAt(0);this.itemState=e;let t=this.model.getChildByName("Box"),a=this.model.getChildByName("Cool"),i=this.model.getChildByName("Press"),s=this.model.getChildByName("Blade"),o=this.model.getChildByName("Light");switch(e){case l.Box:t.active=!0,t.getChildAt(1).active=!1,a.active=!1,i.active=!1,s.active=!1,o.active=!1;break;case l.Water:let n=t.getChildAt(1);n.active=!0,o.active=!0,o.transform.localPosition=new Laya.Vector3(0,2.75,1.75);let r=C.halfPercent()?1:-1;Laya.timer.frameLoop(1,this,()=>{let e=n.meshRenderer.material.clone(),t=e.tilingOffset.clone();t.z+=r*Laya.timer.delta/8e3,t.w+=r*Laya.timer.delta/8e3,t.z>1?(t.z=1,t.w=1,r*=-1):t.z<.9&&(t.z=.9,t.w=.9,r*=-1),e.tilingOffset=t,n.meshRenderer.material=e});break;case l.Cool:t.active=!1,a.active=!0,o.transform.localPosition=new Laya.Vector3(0,2.75,1.75);break;case l.Steel:a.active=!1,i.active=!0,o.transform.localPosition=new Laya.Vector3(0,1.69,1.75);break;case l.Blade:i.active=!1,s.active=!0,o.active=!1,this.width=u.itemSize/2}(()=>{this.tweenBornDo()})()}changeHegiht(e){let t=this.self.transform.position.clone();t.y=e,this.self.transform.position=t}getValue(){return 10+10*this.itemState}}class D extends p{constructor(){super(...arguments),this.offsetX=0,this.offsetZ=0,this.itemLerpAxis=30,this.nowType=[]}init(...e){D.instance=this,this.items=this.self.getChildByName("Items"),this.model=this.self.getChildByName("Model"),this.size=u.itemSize,Laya.timer.loop(8,this,this.update)}reset(){this.items.active=!0,this.nowType=[];for(let e=this.items.numChildren-1;e>=0;e--)this.items.getChildAt(e).destroy();for(let e=0;e<0;e++)this.addItem()}addItem(){let e=new Laya.Sprite3D("item");B.stageObj.push(e),this.items.addChild(e),e.transform.localPosition=new Laya.Vector3,B.bornStageObj(r.Item_Box,e).transform.localPosition=new Laya.Vector3;let t=e.addComponent(T);t.setData(this.size,this.size),t.changeState(l.Box),f.playSoundLimit(n.Get)}addOldItem(e){C.d3_addChildNotMove(e.self,this.items),e.self.transform.localPosition=new Laya.Vector3,e.tweenBornDo(),f.playSoundLimit(n.Get)}update(){let e,t=this.model.transform.position.clone();t.x+=this.offsetX,t.z+=this.offsetZ;for(let a=0;a<this.items.numChildren;a++)if((e=this.items.getChildAt(a))&&!e.destroyed){let i=new Laya.Vector3,s=0==a?1:.008*this.itemLerpAxis;s>1&&(s=1),Laya.Vector3.lerp(e.transform.position.clone(),t,s,i),i.z=this.model.transform.position.z+this.offsetZ+a*this.size,e.transform.position=new Laya.Vector3(i.x,e.transform.position.clone().y,i.z),t=e.transform.position.clone()}}}class O extends A{constructor(){super(...arguments),this.isColliderActive=!1,this.isLandRotate=!0,this.hitGroundAxis=.6,this.blockAxis=.05}init(){super.init(),this.dorpDeadY=this.self.transform.position.clone().y,this.isDestory=!1,this.dropDeadChangeX=g.instance.modelMoveRange/2+u.itemSize/2,this.isLandRotate=!0,this.isActive=!0,this.yforce=0,this.changeDropData(new Laya.Vector2(30,40),new Laya.Vector2(-7.5,7.5),new Laya.Vector2(20,40),new Laya.Vector3(1,1,1),new Laya.Vector3(C.randomNumber(-10,10),C.randomNumber(-10,10),C.randomNumber(-10,10)),125)}onUpdate(){let e=Laya.timer.delta/1e3;if(this.isActive){this.yforce-=this.gravity*e;let t=this.self;this.self.getChildAt(0).getChildByName("Model");if(t&&!t.destroyed&&(t.transform.translate(new Laya.Vector3(this.dir.x*this.xForce*e,this.yforce*this.dir.y*e,this.dir.z*this.zForce*e),!1),Math.abs(this.self.transform.position.x)>this.dropDeadChangeX&&(this.dorpDeadY=-19.5,this.isDestory=!0),this.self.transform.position.y<=this.dorpDeadY))if(this.isColliderActive=!0,this.isDestory)this.self.destroy();else{let e=-(this.self.transform.position.y-this.dorpDeadY);this.yforce*=-this.hitGroundAxis,this.xForce*=this.hitGroundAxis,this.zForce*=this.hitGroundAxis,this.xForce+this.zForce+this.yforce<=this.blockAxis&&(this.isActive=!1),t.transform.position=new Laya.Vector3(this.self.transform.position.x,this.dorpDeadY+e,this.self.transform.position.z)}}}colliderDo(){this.isColliderActive&&(D.instance.addOldItem(this.self.getComponent(T)),S.instance.vibrateShort(),this.destroy())}}class N extends p{constructor(){super(...arguments),this.isCircle=!1,this.range=1,this.width=1,this.raidus=1,this.soundRange=100,this.colliderActive=!0,this.colliderSprite=[],this.obsType=h.Obs_Box,this.rewardAdd=0,this.hasColliderObj=[]}init(...e){}setData(e){this.obsType=e,this.isCircle=!1;let t=C.d3_FindNodeHasName(this.self,"collider");this.range=parseFloat(t.name.split("_")[2]),this.width=parseFloat(t.name.split("_")[3]),this.raidus=(this.range+this.width)/2,this.raidus*=.5,this.colliderSprite.push(t);let a=()=>{let e=C.d3_FindNodeByName(this.self,"Liquid");if(e){let t=e.meshRenderer.material.clone();Laya.timer.frameLoop(1,this,()=>{let a=Laya.timer.delta/1e3,i=t.tilingOffset.clone();i.w+=.25*a,t.tilingOffset=i,e.meshRenderer.material=t})}},i=()=>{let e=C.d3_FindNodeByName(this.self,"Right"),t=C.d3_FindNodeByName(this.self,"Wrong");e.active=!1,t.active=!1};switch(e){case h.Obs_Box:break;case h.Obs_Water:a();break;case h.Obs_Cool:a(),i();break;case h.Obs_Press:case h.Obs_Polish:i();break;case h.Obs_1:case h.Obs_2:break;case h.Door_1:this.self.transform.localScale=new Laya.Vector3(1,1,1),this.boardUpdate();break;default:console.log("关卡物品预设里没有该类型物件",e)}}colliderDo(t=null,a){let i=()=>{this.colliderActive&&(this.self.active=!1,D.instance.addItem(),this.colliderActive=!1,S.instance.vibrateShort(),C.d2_numberLabelToast(10,this.self))},s=e=>{if(this.colliderActive)if(!t&&e)g.instance.Hit();else if(t&&-1==this.hasColliderObj.indexOf(t)){this.hasColliderObj.push(t);let e=t.self.transform.position.clone();B.dropItemsGrip.addChild(t.self),t.self.transform.position=e,t.self.addComponent(O),S.instance.vibrateShort(),f.playSoundLimit(n.Obstacle),C.d2_numberLabelToast(-t.getValue(),this.self)}},r=e=>{if(this.colliderActive&&t&&-1==this.hasColliderObj.indexOf(t)){let a;switch(this.hasColliderObj.push(t),t.changeState(e),S.instance.vibrateShort(),e){case l.Water:f.playSoundLimit(n.Water),C.d2_numberLabelToast(10,this.self);break;case l.Cool:a=B.bornFxDestroy("CooldownFX",t.self),f.playSoundLimit(n.Cool),C.d2_numberLabelToast(10,this.self);break;case l.Steel:f.playSoundLimit(n.Press),C.d2_numberLabelToast(10,this.self);break;case l.Blade:a=B.bornFxDestroy("PolishSpark",t.self),f.playSoundLimit(n.Polish),C.d2_numberLabelToast(10,this.self)}}},d=e=>{let t=C.d3_FindNodeByName(this.self,"Right"),a=C.d3_FindNodeByName(this.self,"Wrong");if(t.transform.rotation=new Laya.Quaternion,a.transform.rotation=new Laya.Quaternion,t.active=e,a.active=!e,e){let e=t.getComponent(p);e||(e=t.addComponent(p)),e.tweenBornDo()}else{let e=a.getComponent(p);e||(e=a.addComponent(p)),e.tweenBornDo()}},c=()=>{let a=()=>{this.colliderActive=!1,this.selfTween.toTween(this.self,{sca:new Laya.Vector3(0,0,0)},300,()=>{},Laya.Ease.backIn),e.event(o.Game_BoradEnd_Event),this.boardUpdate(),g.instance.selfTween.toTween(g.instance.model,{sca:new Laya.Vector3(0,0,0)},300,()=>{},Laya.Ease.backIn)};if(this.colliderActive)if(t){let i;t.colliderActive=!1,S.instance.vibrateShort(),g.instance.Hit(.25),i=t.self.transform.position.x>=0?0:1,t.itemState==l.Blade?(u.typesLevel[i]++,u.typesLevel[i]>u.maxLevel[i]?(u.typesLevel[i]=u.maxLevel[i],t.colliderActive=!0):(B.mainScene.addChild(t.self),t.self.active=!1,f.playSoundLimit(n.Upgrade),e.event(o.Game_BoradUpdate_Event),e.event(o.Game_addMoneyCount_Event,t.getValue()))):(B.mainScene.addChild(t.self),t.self.active=!1,f.playSoundLimit(n.Obstacle)),this.boardUpdate();let s=!0;for(let e=0;e<u.typesLevel.length;e++)if(u.typesLevel[e]<u.maxLevel[e]){s=!1;break}(0==D.instance.items.numChildren||s)&&a()}else S.instance.vibrateShort(),g.instance.Hit(),f.playSoundLimit(n.Upgrade),0==D.instance.items.numChildren&&a()};if(-1==this.hasColliderObj.indexOf(t)){switch(this.obsType){case h.Obs_Box:i();break;case h.Obs_Water:t&&0==t.itemState&&r(1);break;case h.Obs_Cool:t&&(1==t.itemState?(r(2),d(!0)):d(!1));break;case h.Obs_Press:t&&(2==t.itemState?(r(3),d(!0)):d(!1));break;case h.Obs_Polish:t&&(3==t.itemState?(r(4),d(!0)):d(!1));break;case h.Obs_1:case h.Obs_2:s(!0);break;case h.Door_1:c()}t&&this.hasColliderObj.push(t)}else switch(this.obsType){case h.Obs_Box:}}colliderExit(e=null,t){switch(this.obsType){case h.Obs_Box:}let a=this.hasColliderObj.indexOf(e);this.hasColliderObj.splice(a,1)}boardUpdate(){let e=u.typesLevel[0],t=u.typesLevel[1];for(let t=0;t<8;t++){let a="Door1_N"+(t+1).toString(),i=C.d3_FindNodeByName(this.self,a);C.d3_swtichMatColor(i,C.d3_getRgbByHex(t<e?"#FFFFFF":"#969696"))}for(let e=0;e<8;e++){let a="Door2_N"+(e+1).toString(),i=C.d3_FindNodeByName(this.self,a);C.d3_swtichMatColor(i,C.d3_getRgbByHex(e<t?"#FFFFFF":"#969696"))}}playLoopSound(e){this.loopSoundChannel&&!this.loopSoundChannel.isStopped||(this.loopSoundChannel=f.play(e,!0)),this.loopSoundChannel&&(this.loopSoundChannel.volume=f.isSound?1:0),Laya.timer.frameOnce(1,this,this.soundStop)}soundStop(){this.loopSoundChannel&&(this.loopSoundChannel.volume=0)}playCloseSound(e){let t=Math.abs(this.self.transform.position.z-g.instance.player.transform.position.z),a=t<this.soundRange?t/this.soundRange:1;this.loopSoundChannel&&!this.loopSoundChannel.isStopped||(this.loopSoundChannel=f.play(e,!0)),this.loopSoundChannel&&(this.loopSoundChannel.volume=f.isSound?1-a:0)}}class V{static addLoadRes(e){this.loadingList.push(e),this.loadingCount++}static removeLoadRes(t){let a=this.loadingList.indexOf(t);-1==a?console.log("完成了不存在的资源加载"):this.loadingList.splice(a,1),e.event(o.Progress_Load_Update)}}V.loadingList=[],V.loadingCount=0;class E extends p{init(){this.heroComp=this.self.getComponent(H)}startThinking(){Laya.timer.loop(1e3,this,this.think)}think(){C.percent(.8)&&this.heroComp.attack()}stopThinking(){Laya.timer.clear(this,this.think)}}class H extends p{constructor(){super(...arguments),this.nowHp=0,this.maxHp=100,this.atk=10,this.atkSpeed=1,this.isPlayer=!0,this.attackCount=0,this.attackDoAxis=[16/30,14/30,23/31],this.isAttacking=!1}init(...e){this.anim=this.self.getComponent(Laya.Animator)}reset(e,t,a){this.idle(),this.controlOff(),this.maxHp=e,this.nowHp=this.maxHp,this.atk=t,this.atkSpeed=a}controlOn(){if(this.controlOff(),this.nowHp>0)if(this.isPlayer)e.on(d.singleTouchStart,this,this.attack);else{this.self.getComponent(E).startThinking()}}controlOff(){if(this.isPlayer)e.off(d.singleTouchStart,this,this.attack);else{this.self.getComponent(E).stopThinking()}}idle(){this.anim.crossFade("idle",.1,0,0),this.anim.speed=1}keepIdle(){Laya.timer.clear(this,this.attackDo),Laya.timer.clear(this,this.attackEnd),Laya.timer.clear(this,this.idle),Laya.timer.clear(this,this.controlOn),this.controlOff(),this.anim.crossFade("idle",.1,0,0),this.anim.speed=1}hurt(e=1){Laya.timer.clear(this,this.attackDo),Laya.timer.clear(this,this.attackEnd),Laya.timer.clear(this,this.idle),this.isAttacking=!1,this.anim.speed=1,this.controlOff(),this.nowHp-=e,B.bornFxDestroy("HitFX",this.self,1e3),this.nowHp>0?(this.anim.crossFade("hit",.1,0,0),Laya.timer.once(667,this,this.idle),Laya.timer.once(667,this,this.controlOn),S.instance.vibrateShort(),C.d3_objectShake(g.instance.mainCamera,.15,1)):this.isPlayer?this.Death():this.Fly()}attack(){if(this.isAttacking)return;this.isPlayer&&a.instance&&a.instance.endTips.set_visible(!1);let e=!1;this.atk>=this.target.nowHp&&this.isPlayer&&(e=!0,this.target.keepIdle(),a.instance.playerBar.set_visible(!1),a.instance.playerStat.set_visible(!1),a.instance.enemyBar.set_visible(!1),a.instance.enemyStat.set_visible(!1)),this.isAttacking=!0,Laya.timer.once(2e3,this,this.combeClear),this.attackCount++,this.attackCount>3&&(this.attackCount=1);let t="Attack"+this.attackCount.toString(),i=1e3*this.anim.getControllerLayer(0).getAnimatorState(t).clip.duration()/(this.atkSpeed*(e?.3:1)),s=i*this.attackDoAxis[this.attackCount-1];this.anim.crossFade(t,.1,0,0),this.anim.speed=this.atkSpeed*(e?.3:1),Laya.timer.once(i,this,this.attackEnd),Laya.timer.once(s,this,this.attackDo)}attackDo(){this.target&&(f.play(this.isPlayer?n.PlayerAttack:n.BossAttack),this.target.hurt(this.atk)),this.isAttacking=!1}attackEnd(){this.idle()}combeClear(){this.attackCount=0}Fly(){B.bornFxDestroy("HitFX",this.self,1e3),e.event(o.Game_FightOver_Event),S.instance.vibrateLong(),C.d3_objectShake(g.instance.mainCamera,.5,2.5),this.anim.speed=.8,this.anim.crossFade("Fly1",.1,0,0),f.play(n.Ending)}Death(){this.anim.speed=1,this.anim.crossFade("Death",.1,0,0),this.target.Celebrate(),e.event(o.Game_FightOver_Event)}Celebrate(){this.anim.speed=1,this.anim.crossFade("Celebrate",.1,0,0)}}class F{constructor(){this.dropObjs=[],this.colliders=[],this.moneyCount=0,this.nowRound=0,this.playCount=0,this.levelScale=1,this.roadLength=200*this.levelScale,this.colliderRange=50,this.isWin=!1,this.isEnd=!1,this.isFxOn=!0,this.isObjToJson=!1,this.isBornStage=!0,this.isJsonBorn=!0,this.endBoxColor=["#FD3A36","#FEDA2E","#69FF0E","#32E5F9","#17BCF6","#737CFF","#AF40DD"],this.isStart=!1,this.lastValue=0,this.isPressed=!1,this.orignal=0,F.instance=this,this.init()}init(){this.initEvent(),this.isJsonBorn&&this.readJson()}createShadow(e){e.shadowMode=Laya.ShadowMode.SoftLow,e.shadowDistance=50,e.shadowResolution=2048,e.shadowCascadesMode=Laya.ShadowCascadesMode.NoCascades,e.shadowNormalBias=.6,e.shadowStrength=.4}hideShadow(e){e.shadowMode=Laya.ShadowMode.None}useRetinalCanvas(){Laya.stage.useRetinalCanvas=!0}disabelRetinalCanvas(){Laya.stage.useRetinalCanvas=!1}setFog(e,t,a){t.enableFog=e,e&&(t.fogColor=a,t.fogStart=100,t.fogRange=300)}readJson(){V.addLoadRes("关卡");let e=["res/json/stageInfo.json"],t=()=>{Laya.loader.load(e,Laya.Handler.create(this,a=>{if(a){for(let t=0;t<e.length;t++)Laya.loader.load(e[t],Laya.Handler.create(this,e=>{switch(t){case 0:this.stageJson=e,this.allSet=[];for(let e=0;e<this.stageJson.length;e++){let t=this.stageJson[e].setInfo;for(let e=0;e<t.length;e++)this.allSet.push(t[e])}console.log(this.allSet),console.log(e);break;default:console.log(e)}}),null,Laya.Loader.JSON);V.removeLoadRes("关卡")}else console.log("load json fail,reload after 1s"),Laya.timer.once(1e3,this,t)}),null,Laya.Loader.JSON)};e.length>0&&t()}JsonV3(e,t){if(t){let a=Math.round(parseFloat(e.x)*Math.pow(10,t))/Math.pow(10,t),i=Math.round(parseFloat(e.y)*Math.pow(10,t))/Math.pow(10,t),s=Math.round(parseFloat(e.z)*Math.pow(10,t))/Math.pow(10,t);return new Laya.Vector3(a,i,s)}return new Laya.Vector3(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z))}V3ToJson(e){return{x:e.x.toString(),y:e.y.toString(),z:e.z.toString()}}JsonV4(e,t){if(t){let a=Math.round(parseFloat(e.x)*Math.pow(10,t))/Math.pow(10,t),i=Math.round(parseFloat(e.y)*Math.pow(10,t))/Math.pow(10,t),s=Math.round(parseFloat(e.z)*Math.pow(10,t))/Math.pow(10,t),o=Math.round(parseFloat(e.w)*Math.pow(10,t))/Math.pow(10,t);return new Laya.Vector4(a,i,s,o)}return new Laya.Vector4(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z),parseFloat(e.w))}V4ToJson(e){return{x:e.x.toString(),y:e.y.toString(),z:e.z.toString(),w:e.w.toString()}}firstIn(){console.log("首次进入处理"),B.mainScene=this.mainScene;for(let e=0;e<this.mainScene.numChildren;e++){let t=this.mainScene.getChildAt(e);switch(t.name){case"Prefabs":B.prefabs=t,B.prefabs.active=!1;break;case"Light":this.light=t;break;case"Fxs":B.fxs=t,Laya.timer.once(1e3,this,()=>{B.fxs.active=!1});break;case"Stage":this.stage=t,this.player=this.stage.getChildByName("Player"),this.runMoveComp=this.player.addComponent(g),this.itemsComp=this.player.addComponent(D),this.camPoint=this.player.getChildByName("CamPoint"),this.mainCam=this.camPoint.getChildByName("MainCam"),this.mainCamera=this.mainCam.getChildByName("Main Camera"),this.runMoveComp.mainCamera=this.mainCamera,this.start=this.stage.getChildByName("Start"),this.end=this.stage.getChildByName("End"),this.dropItemGrip=this.stage.getChildByName("DropItemGrip"),B.dropItemsGrip=this.dropItemGrip,B.dropItemsGrip=this.dropItemGrip,this.camEndPoint1=C.d3_FindNodeByName(this.end,"CamEndPoint1"),this.camEndPoint2=C.d3_FindNodeByName(this.end,"CamEndPoint2")}}this.useRetinalCanvas(),this.createShadow(this.light);let e=this.end.getChildByName("End2").getChildByName("Player"),t=this.end.getChildByName("End2").getChildByName("Enemy"),a=e.addComponent(H),i=t.addComponent(H);a.isPlayer=!0,i.isPlayer=!1,a.target=i,i.target=a,t.addComponent(E);let s=C.d3_getRgbByHex("#73AAFA");this.setFog(!0,B.mainScene,new Laya.Vector3(s.x,s.y,s.z)),Laya.timer.loop(16,this,()=>{let e=B.mainScene.skyRenderer.material.clone();e.rotation+=.016,B.mainScene.skyRenderer.material=e});let o=this.end.getChildByName("End3"),n=o.getChildAt(0);for(let e=1;e<=14;e++){let t=n.clone();o.addChild(t),t.transform.localPosition=new Laya.Vector3(0,0,40*e)}for(let e=0;e<o.numChildren;e++){let t=o.getChildAt(e),a=t.getChildAt(0),i=t.getChildAt(1);C.d3_swtichMatColor(a,C.d3_getRgbByHex(this.endBoxColor[e%7])),this.numberDeal(i,60*(e+1))}let r=this.stage.getChildByName("bg");for(let e=0;e<r.numChildren;e++){let t=r.getChildAt(e);if(-1!=t.name.indexOf("Ground")){let e=t.meshRenderer.material.clone();Laya.timer.frameLoop(1,this,()=>{let a=e.tilingOffset.clone();a.z+=Laya.timer.delta/8e3,a.w+=Laya.timer.delta/8e3,e.tilingOffset=a,t.meshRenderer.material=e})}if(-1!=t.name.indexOf("Mountain")){let e=t.getChildAt(0),a=t.getChildAt(1),i=e.meshRenderer.material.clone(),s=a.meshRenderer.material.clone();Laya.timer.frameLoop(1,this,()=>{let t=i.tilingOffset.clone();t.w+=Laya.timer.delta/8e3*Math.random(),i.tilingOffset=t,e.meshRenderer.material=i,(t=s.tilingOffset.clone()).w+=Laya.timer.delta/8e3,s.tilingOffset=t,a.meshRenderer.material=s})}}}initEvent(){e.on(o.Game_HealthUpgrde_Event,this,this.skinChange),e.on(o.Game_addMoneyCount_Event,this,this.addMoenyCount)}levelInit(){this.isEnd=!1,this.isStart=!1,Laya.timer.clear(this,this.gameUpdate),B.stageObjClear(),this.dropObjs=[],this.colliders=[],this.nowRound=0,this.moneyCount=0,this.lastValue=0,u.typesLevel=[0,0],u.maxLevel=[8,8];let e=b.ReadGrade()-1,t=new Laya.Vector3,a=new Laya.Vector3(0,0,this.roadLength),i=L.add(t,a);this.start.transform.position=t;let s=this.isBornStage,o=this.isJsonBorn;if(s){let t,s,n,r=this.stage.getChildByName("Level");if(this.isObjToJson){let e=[];for(let t=0;t<r.numChildren;t++){let a=r.getChildAt(t),i={name:"",setInfo:[]};i.name=a.name;for(let e=0;e<a.numChildren;e++){let t=a.getChildAt(e),s={name:"",objInfo:[]};s.name=t.name;for(let e=0;e<t.numChildren;e++){let a=t.getChildAt(e),i=a.name,o=a.transform.localPosition.clone(),n=a.transform.rotation.clone(),r={name:i,pos:this.V3ToJson(o),rot:this.V4ToJson(n)};s.objInfo.push(r)}i.setInfo.push(s)}e.push(i)}console.log(JSON.stringify(e))}if(o)if(e>=this.stageJson.length){let e=1;s=[];for(let t=0;t<e;t++)s.push(C.getRandomInArray(this.allSet));n=s.length}else n=(s=this.stageJson[e].setInfo).length;else t=e%(r=this.stage.getChildByName("Level")).numChildren,n=(s=r.getChildAt(t)).numChildren;for(let e=0;e<n;e++){let t,n;n=o?(t=s[e]).objInfo.length:(t=s.getChildAt(e)).numChildren;let r=new Laya.Sprite3D(t.name);this.stage.addChild(r),r.transform.position=i;let l=i;for(let e=0;e<n;e++){let s,n,h,d,c,y,m;if(o){n=(s=t.objInfo[e]).name.split(" ")[0];let a=this.JsonV3(s.pos);a.z*=this.levelScale,h=L.add(a,r.transform.position.clone()),d=this.JsonV4(s.rot)}else{n=(s=t.getChildAt(e)).name.split(" ")[0];let a=s.transform.localPosition.clone();a.z*=this.levelScale,h=L.add(a,r.transform.position.clone()),d=s.transform.rotation.clone()}let p=e=>{a=new Laya.Vector3(0,0,e),i=L.add(i,a)},g=e=>{(m=c.addComponent(N)).setData(e),y=this.colliderIndexJudge(h),this.colliders[y].push(m)};switch(c=B.bornStageObj(n,r),h.z<=l.z?h.y=r.transform.position.y:h.y=i.y,c.transform.position=h,c.transform.rotation=d,n){case"Road":p(this.roadLength);break;default:Laya.timer.frameOnce(1,this,g,[n],!1)}}}}else this.moneyCount=100;this.end.transform.position=i;let n=Math.ceil((i.z+this.roadLength)/this.colliderRange);for(let e=0;e<n;e++)this.colliders.push([]);let r=C.d3_FindNodeByName(this.end,"Door_1"),l=r.addComponent(N);l.setData(h.Door_1);let d=this.colliderIndexJudge(r.transform.position.clone());this.colliders[d].push(l),this.boradUpdate();let c=this.end.getChildByName("End2").getChildByName("Player"),y=this.end.getChildByName("End2").getChildByName("Enemy"),m=(c.getComponent(H),y.getComponent(H)),p=this.end.getChildByName("End1").getChildByName("Weapons"),f=p.getChildByName("Hilt"),w=p.getChildByName("Blade"),v=p.transform.position.clone();v.y=20,p.transform.position=v;let S=f.transform.localPosition.clone();S.x=4;let x=w.transform.localPosition.clone();x.x=-2,f.transform.localPosition=S,w.transform.localPosition=x;let _=r.transform.position.clone();_.y+=80,c.transform.position=_;let k=this.end.getChildByName("End2").getChildByName("PlayerPoint").transform.position.clone();k.z+=26,y.transform.position=k,c=this.end.getChildByName("End2").getChildByName("Player");let M=C.d3_FindNodeByName(c,"Hilt"),P=C.d3_FindNodeByName(c,"Blade");for(let e=0;e<M.numChildren;e++)M.getChildAt(e).active=u.typesLevel[0]==e;for(let e=0;e<P.numChildren;e++)P.getChildAt(e).active=u.typesLevel[1]==e;y=this.end.getChildByName("End2").getChildByName("Enemy"),m.idle();let A=C.d3_FindNodeByName(y,"Hilt"),T=C.d3_FindNodeByName(y,"Blade");for(let e=0;e<A.numChildren;e++)A.getChildAt(e).active=(b.ReadGrade()-1)%9==e;for(let e=0;e<T.numChildren;e++)T.getChildAt(e).active=(b.ReadGrade()-1)%9==e;let D=this.end.getChildByName("End3");for(let e=0;e<D.numChildren;e++){let t=D.getChildAt(e).getChildAt(1);this.numberDeal(t,60*(e+1))}c.active=!1,this.skinChange(),this.player.transform.position=t,g.instance.model.transform.localScale=new Laya.Vector3(1,1,1),this.player.addChild(this.camPoint),this.camPoint.transform.localPosition=this.runMoveComp.startCamPoint.transform.localPosition.clone(),this.camPoint.transform.localRotation=this.runMoveComp.startCamPoint.transform.localRotation.clone(),this.runMoveComp.reset(.75*this.roadLength*this.levelScale,0),this.runMoveComp.model.transform.localPosition=new Laya.Vector3(0,0,0),this.runMoveComp.model.transform.localRotationEuler=new Laya.Vector3(0,0,0),this.itemsComp.reset(),this.runMoveComp.isCamCtrl=!0,Laya.timer.frameLoop(1,this,this.gameUpdate)}gameStart(){this.isStart=!0,this.controlOn(),this.roundInit(),this.playCount++,Laya.timer.loop(16,this,this.fixUpdate),this.runMoveComp.isMove=!0}levelEnd(t){this.isEnd=!0,this.isWin=t,f.play(this.isWin?n.Win:n.Fail),Laya.timer.clear(this,this.fixUpdate),e.event(o.Scene_GoOver)}roundInit(){let t,i,s,r,l;switch(this.nowRound){case 0:break;case 1:this.runMoveComp.isCamCtrl=!1,C.d3_addChildNotMove(this.camPoint,B.mainScene),(t=new m).toTween(this.camPoint,{pos:this.camEndPoint1.transform.position.clone(),rot:this.camEndPoint1.transform.rotation.clone()},750,()=>{},null,!1),this.runMoveComp.speedAxis=.5,e.on(o.Game_BoradEnd_Event,this,this.roundEnd),e.on(o.Game_BoradUpdate_Event,this,this.boradUpdate);break;case 2:e.off(o.Game_BoradEnd_Event,this,this.roundEnd),e.off(o.Game_BoradUpdate_Event,this,this.boradUpdate),this.runMoveComp.isMove=!1,this.moneyCount>9999&&(this.moneyCount=9999),this.roundEnd();break;case 3:this.controlOff(),this.onMouseUp();let h=this.end.getChildByName("End1").getChildByName("Weapons"),d=h.getChildByName("Hilt"),c=h.getChildByName("Blade"),y=new m,p=new m,L=new m,w=h.transform.position.clone();w.y-=10,p.toTween(d,{pos:new Laya.Vector3},250,null,null,!0),L.toTween(c,{pos:new Laya.Vector3},250,null,null,!0),i=this.end.getChildByName("End2").getChildByName("Player");let v=C.d3_FindNodeByName(i,"Hilt"),x=C.d3_FindNodeByName(i,"Blade");for(let e=0;e<v.numChildren;e++)v.getChildAt(e).active=u.typesLevel[0]==e;for(let e=0;e<x.numChildren;e++)x.getChildAt(e).active=u.typesLevel[1]==e;i.active=!0;let _=i.getComponent(Laya.Animator),k=this.end.getChildByName("End2").getChildByName("PlayerPoint"),M=new m,P=i.transform.position.clone();P.y=0,Laya.timer.once(250,this,()=>{B.bornFxDestroy("InstallFX",h,2e3);f.play(n.Merge)}),Laya.timer.once(750,this,()=>{w.y+=50,y.toTween(h,{pos:w},750,()=>{_.play("jump",0,0),_.speed=.6,M.toTween(i,{pos:P},750,()=>{S.instance.vibrateLong(),C.d3_objectShake(g.instance.mainCamera,.4,2),f.play(n.Landing),B.bornFxDestroy("LandingFX",B.mainScene,3e3).transform.position=P},null,!1)},Laya.Ease.expoIn,!1)}),Laya.timer.once(2750,this,()=>{_.crossFade("run",.4,0,0),M.toTween(i,{pos:k.transform.position.clone()},2e3,()=>{_.speed=1,_.crossFade("idle",.5,0,0)},null,!1),(t=new m).toTween(this.camPoint,{pos:this.camEndPoint2.transform.position.clone(),rot:this.camEndPoint2.transform.rotation.clone()},2e3,()=>{this.roundEnd()},null,!1)});break;case 4:i=this.end.getChildByName("End2").getChildByName("Player"),s=this.end.getChildByName("End2").getChildByName("Enemy"),r=i.getComponent(H),l=s.getComponent(H);let A=500+50*b.readHealthLevel(),T=10+10*u.typesLevel[1]+10*b.readAttackLevel(),D=.7+.1*u.typesLevel[0]+.1*b.readSpeedLevel(),O=C.randomInt(400,500)+50*b.ReadGrade(),N=50+5*b.ReadGrade(),V=.7+.1*b.ReadGrade();V>2&&(V=2),r.reset(A,T,D),l.reset(O,N,V),r.controlOn(),l.controlOn(),e.on(o.Game_FightOver_Event,this,this.roundEnd),a.instance.endTips.set_visible(!0);break;case 5:a.instance.endTips.set_visible(!1),e.off(o.Game_FightOver_Event,this,this.roundEnd),i=this.end.getChildByName("End2").getChildByName("Player"),s=this.end.getChildByName("End2").getChildByName("Enemy"),r=i.getComponent(H),l=s.getComponent(H),r.controlOff(),l.controlOff();let E=()=>{r.nowHp>0?this.roundEnd():this.levelEnd(!1)};if(r.nowHp>0){let e=(u.typesLevel[0]+1)*(u.typesLevel[1]+1)*10;this.moneyCount+=e;let a=Math.floor(e/60),i=this.end.getChildByName("End3").getChildAt(a).getChildAt(1);this.numberDeal(i,e);let o=s.transform.position.clone();o.z+=20+40*a;let n=this.camPoint.transform.position.clone();n.z+=37.5+40*a;let r=new m,h=e/400*3500;h<750&&(h=750),h>3500&&(h=3500),Laya.timer.once(.9*h,this,()=>{l.Death()}),r.toTween(s,{pos:o},h,()=>{Laya.timer.once(1e3,this,E)},Laya.Ease.sineOut,!1),(t=new m).toTween(this.camPoint,{pos:n},h,null,Laya.Ease.sineOut,!1)}else E();break;case 6:this.levelEnd(!0);break;default:console.log("多次触发跳关了")}}roundEnd(){this.isEnd||(this.nowRound++,this.roundInit())}gameUpdate(){Laya.timer.delta,this.end.transform.position.z;switch(this.nowRound){case 0:this.player.transform.position.z>this.end.transform.position.z&&this.roundEnd();break;case 1:this.runMoveComp.isMove=this.isPressed||this.player.transform.position.z<this.end.transform.position.z+15;break;case 2:case 3:break;case 4:let e=this.end.getChildByName("End2").getChildByName("Player"),t=this.end.getChildByName("End2").getChildByName("Enemy"),i=e.getComponent(H),s=t.getComponent(H),o=C.d3_getSpritePosBySprite3DPoint(this.mainCamera,e,new Laya.Vector3(0,-10,0)),n=C.d3_getSpritePosBySprite3DPoint(this.mainCamera,t,new Laya.Vector3(0,-10,0));a.instance.playerBar.x=o.x,a.instance.playerBar.y=o.y,a.instance.playerStat.x=o.x,a.instance.playerStat.y=o.y,a.instance.enemyBar.x=n.x,a.instance.enemyBar.y=n.y,a.instance.enemyStat.x=n.x,a.instance.enemyStat.y=n.y;let r=a.instance.playerBar.getChildByName("bar"),l=a.instance.playerBar.getChildByName("value"),h=a.instance.playerStat.getChildByName("speedValue"),d=a.instance.playerStat.getChildByName("attackValue");r.value=i.nowHp/i.maxHp,l.value=i.nowHp.toString(),h.value=Math.floor((i.atkSpeed-.6)/.1).toString(),d.value=i.atk.toString();let c=a.instance.enemyBar.getChildByName("bar"),y=a.instance.enemyBar.getChildByName("value"),m=a.instance.enemyStat.getChildByName("speedValue"),p=a.instance.enemyStat.getChildByName("attackValue");c.value=s.nowHp/s.maxHp,y.value=s.nowHp.toString(),m.value=Math.floor((s.atkSpeed-.6)/.1).toString(),p.value=s.atk.toString()}}fixUpdate(){{this.nowRound;let e,t,a,i=this.itemsComp.items,s=new Laya.Vector3;if((s=this.runMoveComp.model.transform.position.clone()).z+=D.instance.offsetZ,(a=this.colliderIndexJudge(s))>=0&&a<this.colliders.length)for(let e=0;e<this.colliders[a].length;e++){let t,i=this.colliders[a][e];for(let o=0;o<this.colliders[a][e].colliderSprite.length;o++){let n=this.colliders[a][e].colliderSprite[o];if(n&&!n.destroyed){let e=n.transform.position.clone();if((t=i.isCircle?C.CircleCheck_2D(s.z,s.x,u.itemSize/2,e.z,e.x,i.raidus):C.BoxCheck_2D_Normal(s.z,s.x,u.itemSize,u.itemSize,e.z,e.x,i.range,i.width)).isHit)break}}if(t&&t.isHit){i.colliderDo();break}}for(let o=0;o<i.numChildren;o++)if((e=i.getChildAt(o))&&!e.destroyed){if(s=e.transform.position.clone(),!(t=e.getComponent(T)).colliderActive)continue;if((a=this.colliderIndexJudge(s))>=0&&a<this.colliders.length)for(let e=0;e<this.colliders[a].length;e++){let i,o=this.colliders[a][e];for(let n=0;n<this.colliders[a][e].colliderSprite.length;n++){let r=this.colliders[a][e].colliderSprite[n];if(r&&!r.destroyed){let e=r.transform.position.clone();if((i=o.isCircle?C.CircleCheck_2D(s.z,s.x,t.raidus,e.z,e.x,o.raidus):C.BoxCheck_2D_Normal(s.z,s.x,t.range,t.width,e.z,e.x,o.range,o.width)).isHit)break}}if(i&&i.isHit){o.colliderDo(t);break}i&&!i.isHit&&-1!=o.hasColliderObj.indexOf(t)&&o.colliderExit(t)}}for(let o=0;o<this.dropItemGrip.numChildren;o++){let n=this.dropItemGrip.getChildAt(o);if(n&&!n.destroyed){let o=n.getComponent(O);if(o.isColliderActive){let r,l=n.transform.position.clone(),h=this.colliderIndexJudge(l);if(s=this.runMoveComp.model.transform.position.clone(),a=this.colliderIndexJudge(s),Math.abs(h-a)<=2&&(r=C.BoxCheck_2D_Normal(s.z,s.x,u.itemSize,u.itemSize,l.z,l.x,u.itemSize,u.itemSize)).isHit){o.colliderDo();break}for(let n=0;n<i.numChildren;n++)if((e=i.getChildAt(n))&&!e.destroyed){if(s=e.transform.position.clone(),!(t=e.getComponent(T)).colliderActive)continue;if(a=this.colliderIndexJudge(s),Math.abs(h-a)<=1&&(r=C.BoxCheck_2D_Normal(s.z,s.x,u.itemSize,u.itemSize,l.z,l.x,u.itemSize,u.itemSize)).isHit){o.colliderDo();break}}}}}}}colliderIndexJudge(e){return Math.floor((e.z-this.roadLength)/this.colliderRange)}addMoenyCount(e){this.moneyCount+=e}boradUpdate(){let e=this.end.getChildByName("End1").getChildByName("Weapons"),t=e.getChildByName("Hilt"),a=e.getChildByName("Blade");for(let e=0;e<t.numChildren;e++){let a=e==u.typesLevel[0],i=t.getChildAt(e);if(a!=i.active){let e=t.getComponent(p);e||(e=t.addComponent(p)),e.tweenBornDo()}i.active=a}for(let e=0;e<a.numChildren;e++){let t=e==u.typesLevel[1],i=a.getChildAt(e);if(t!=i.active){let e=a.getComponent(p);e||(e=a.addComponent(p)),e.tweenBornDo()}i.active=t}}numberShow(e,t,a){let i=a%4*.25,s=.25*Math.floor(a/4),o=e.getChildAt(t),n=o.meshRenderer.material.clone(),r=new Laya.Vector4(1,1,i,-s);n.tilingOffset=r,o.meshRenderer.material=n}numberDeal(e,t){let a,i=Math.floor(t/1e3),s=Math.floor(t%1e3/100),o=Math.floor(t%100/10),n=Math.floor(t%10),r=(t,a)=>{this.numberShow(e,t,a)},l=1;switch(0!=i?(l=4,r(0,i),r(1,s),r(2,o)):0!=s?(l=3,r(1,s),r(2,o)):0!=o&&(l=2,r(2,o)),r(3,n),C.d3_unactiveAllChildren(e),l){case 1:(a=e.getChildAt(3)).transform.localPosition=new Laya.Vector3(0,.2,20),a.active=!0;break;case 2:for(let t=0;t<2;t++)(a=e.getChildAt(2+t)).transform.localPosition=new Laya.Vector3(5-10*t,.2,20),a.active=!0;break;case 3:for(let t=0;t<3;t++)(a=e.getChildAt(1+t)).transform.localPosition=new Laya.Vector3(10-10*t,.2,20),a.active=!0;break;case 4:for(let t=0;t<4;t++)(a=e.getChildAt(t)).transform.localPosition=new Laya.Vector3(15-10*t,.2,20),a.active=!0}}skinChange(){let e=Math.floor(b.readHealthLevel()/2);e>4&&(e=4),e++;let t=this.end.getChildByName("End2").getChildByName("Player");for(let a=1;a<=5;a++){t.getChildAt(a).active=a==e}}controlOn(){e.on(d.singleTouchStart,this,this.onMouseDown),e.on(d.singleTouchMove,this,this.onMouseMove),e.on(d.singleTouchEnd,this,this.onMouseUp)}controlOff(){e.off(d.singleTouchStart,this,this.onMouseDown),e.off(d.singleTouchMove,this,this.onMouseMove),e.off(d.singleTouchEnd,this,this.onMouseUp)}onMouseDown(e){this.isPressed=!0,this.orignal=e.stageX/Laya.stage.width,this.nowRound<2&&this.runMoveComp&&this.runMoveComp.checkOut()}onMouseMove(e){if(this.isPressed){let t=e.stageX/Laya.stage.width-this.orignal;this.nowRound<2&&this.runMoveComp&&this.runMoveComp.checkWay(2*t)&&(this.orignal=e.stageX/Laya.stage.width)}}onMouseUp(){this.isPressed=!1,this.nowRound<2&&this.runMoveComp&&this.runMoveComp.checkOut()}}class z extends t{init(){F.instance.playCount,this.btnUpdate()}initEvent(){C.d2_AddClickEvent(this.btnStart,this,this.onBtnStartClick),C.d2_AddClickEvent(this.speedBtn,this,this.onBtnSpeedClick),C.d2_AddClickEvent(this.attackBtn,this,this.onBtnAtkClick),C.d2_AddClickEvent(this.healthBtn,this,this.onBtnHealthClick)}onBtnStartClick(){e.event(o.Scene_GoGame)}onBtnSpeedClick(){let e=b.ReadCoin(),t=100*(b.readSpeedLevel()+1);e>=t?(b.AddCoin(-t),b.addSpeedLevel(),this.btnUpdate()):S.instance.showToast("不够钱")}onBtnAtkClick(){let e=b.ReadCoin(),t=100*(b.readAttackLevel()+1);e>=t?(b.AddCoin(-t),b.addAttackLevel(),this.btnUpdate()):S.instance.showToast("不够钱")}onBtnHealthClick(){let t=b.ReadCoin(),a=150*(b.readHealthLevel()+1);t>=a?(b.AddCoin(-a),b.addHealthLevel(),this.btnUpdate(),e.event(o.Game_HealthUpgrde_Event)):S.instance.showToast("不够钱")}btnUpdate(){let e=[b.readSpeedLevel(),b.readAttackLevel(),b.readHealthLevel()],t=b.ReadCoin();for(let a=0;a<e.length;a++){let i;i=a<2?100*(e[a]+1):150*(e[a]+1);let s=this.getUpgradeBtn(a);s.getChildByName("black").set_visible(t<i),s.getChildByName("levelValue").value=(e[a]+1).toString(),s.getChildByName("moneyValue").value=i.toString()}}getUpgradeBtn(e){switch(e){case 0:return this.speedBtn;case 1:return this.attackBtn;case 2:return this.healthBtn}}}class I extends t{init(){Laya.timer.frameOnce(1,this,this.loadProgressUpdate)}initEvent(){e.on(o.Progress_Load_Update,this,this.loadProgressUpdate)}loadProgressUpdate(){let t=V.loadingList;0==t.length?(console.log("加载完毕"),e.event(o.Scene_GoHome)):console.log("正在加载",t[0]),this.loadBar.value=(V.loadingCount-t.length)/V.loadingCount}}class R extends t{constructor(){super(...arguments),this.coinUrl=u.coinUrl}init(){this.btnContinue.getChildByName("coinValue").value=(this.videoCheckBox.selected?5*F.instance.moneyCount:F.instance.moneyCount).toString(),M.toScale(this.icon,0,1,500,Laya.Ease.elasticOut)}initEvent(){this.videoCheckBox.on("change",this,()=>{this.btnContinue.getChildByName("coinValue").value=(this.videoCheckBox.selected?5*F.instance.moneyCount:F.instance.moneyCount).toString()}),C.d2_AddClickEvent(this.btnContinue,this,this.onBtnContinueClick)}onBtnContinueClick(){let t=this,a=a=>{this.btnContinue.offAllCaller(this),a?b.AddCoin(5*F.instance.moneyCount):b.AddCoin(F.instance.moneyCount),C.d2_coinCollectAnim(this.coinUrl,new Laya.Vector2(t.btnContinue.x,t.btnContinue.y),new Laya.Vector2(t.coin.x,t.coin.y),t.scene,10,1,()=>{F.instance.isWin&&b.AddGrade(),e.event(o.Scene_GoHome)})};this.videoCheckBox.selected?S.instance.showVideo(()=>{a(!0)},()=>{S.instance.showToast("未看完视频，没有奖励")}):a(!1)}}class U extends Laya.Script{constructor(){super(...arguments),this.delayTime=0}onEnable(){let e=this.owner,t=e.y;Laya.timer.once(this.delayTime,this,()=>{M.toPosition(e,{y:t+15},1e3,Laya.Ease.sineInOut,()=>{},!0)})}onDisable(){let e=this.owner;M.clearTween(e),Laya.timer.clearAll(this)}}!function(e){e[e.has=0]="has",e[e.choose=1]="choose",e[e.coin=2]="coin",e[e.video=3]="video"}(c||(c={})),function(e){e[e.cup=0]="cup",e[e.hand=1]="hand",e[e.levelUp=2]="levelUp"}(y||(y={}));class G extends x{constructor(){super(...arguments),this.bgUrl=["ui/game/Shop/sd_bz_bj.png","ui/game/Shop/sd_sb_bj.png","ui/game/Shop/sd_ys_bj.png"],this.showUrl=["ui/game/Shop/sd_bz_zst.png","ui/game/Shop/sd_sb_zst.png","ui/game/Shop/sd_ys_zst.png"],this.itemUrl=["ui/game/Shop/skin.png","ui/game/Shop/skin_selected.png","ui/game/Shop/skin_buy.png","ui/game/Shop/skin_buy.png"],this.nowType=y.cup}init(){this.self.width=Laya.stage.width,this.self.height=Laya.stage.height,this.self.x=0,this.self.y=0,this.mainPanel=this.self.getChildByName("mainPanel"),this.closeBtn=this.self.getChildByName("closeBtn"),this.bg=this.self.getChildByName("bg"),this.showImage=this.self.getChildByName("showImage"),this.cupType=this.mainPanel.getChildByName("cupType"),this.handType=this.mainPanel.getChildByName("handType"),this.levelUpType=this.mainPanel.getChildByName("levelUpType"),this.nowType=y.cup,this.switchType(this.nowType),this.initEvent()}initEvent(){C.d2_AddClickEvent(this.closeBtn,this,this.onCloseClick),C.d2_AddClickEvent(this.cupType,this,this.switchType,[y.cup],!1,!0,!1),C.d2_AddClickEvent(this.handType,this,this.switchType,[y.hand],!1,!0,!1),C.d2_AddClickEvent(this.levelUpType,this,this.switchType,[y.levelUp],!1,!0,!1)}onCloseClick(){this.self.set_visible(!1),this.closeCB&&this.closeCB()}switchType(e){this.nowType=e;let t=this.cupType.getChildAt(0),a=this.handType.getChildAt(0),i=this.levelUpType.getChildAt(0);switch(t.set_visible(!0),a.set_visible(!0),i.set_visible(!0),this.bg.skin=this.bgUrl[e],this.showImage.skin=this.showUrl[e],this.nowType){case y.cup:t.set_visible(!1);break;case y.hand:a.set_visible(!1);break;case y.levelUp:i.set_visible(!1);break;default:console.error("选择错误的类型",e)}this.initList(),this.updateShow()}initList(){this.list=this.mainPanel.getChildByName("list"),this.list.selectEnable=!1,this.list.renderHandler=Laya.Handler.create(this,this.onListRender,null,!1),this.list.hScrollBarSkin="",this.list.repeatX=3,this.list.repeatY=2}onListRender(e,t){let a,i=e.getChildByName("Item"),s=i.getChildByName("icon"),o=i.getChildByName("coin"),n=i.getChildByName("video"),r=c.has;switch(o.set_visible(!1),n.set_visible(!1),this.nowType){case y.cup:s.skin="ui/game/Shop/Cup/buck"+(t+1)+".png";break;case y.hand:s.skin="ui/game/Shop/Hand/hand0"+t+".png";break;case y.levelUp:s.skin="ui/game/Shop/LevelUp/frap0"+(t+1)+".png"}switch(r){case c.coin:o.set_visible(!0),a=o.getChildAt(0);break;case c.video:n.set_visible(!0),a=n.getChildAt(0)}i.skin=this.itemUrl[r],i.scale(1,1)}clickEvent(e){let t=e.id,a=e.type,i=e.unlockType,s=e=>{this.nowChooseIndex=e};switch(i){case c.has:s(t);break;case c.choose:break;case c.coin:b.CostCoin(e.unlockCount)&&((t,a)=>{e[t][a]=-1,s(a)})(a,t);break;case c.video:S.instance.showVideo(()=>{},()=>{S.instance.showToast("视频解锁失败")})}this.updateShow(),this.list.refresh()}updateShow(){let e,t=this.nowChooseIndex;switch(this.nowType){case y.cup:e="ui/game/Shop/Cup/buck"+(t+1)+".png";break;case y.hand:e="ui/game/Shop/Hand/hand0"+t+".png";break;case y.levelUp:e="ui/game/Shop/LevelUp/frap0"+(t+1)+".png";break;default:e=""}this.showImage.getChildByName("icon").skin=e}}class X{constructor(){}static init(){var e=Laya.ClassUtils.regClass;e("Scenes/Game.ts",a),e("Tools/ctrl/TouchCtrl.ts",v),e("Tools/ctrl/TouchScan.ts",w),e("UIComps/CoinComp.ts",_),e("UIComps/StageComp.ts",k),e("Tools/uiTween/ScaleUITween.ts",P),e("Scenes/Home.ts",z),e("Scenes/Load.ts",I),e("Scenes/Over.ts",R),e("Tools/uiTween/PosUITween.ts",U),e("UIComps/ShopComp.ts",G)}}X.width=750,X.height=1334,X.scaleMode="fixedwidth",X.screenMode="vertical",X.alignV="middle",X.alignH="center",X.startScene="scenes/Game.scene",X.sceneRoot="",X.debug=!1,X.stat=!1,X.physicsDebug=!1,X.exportSceneToJson=!0,X.init();class Y extends S{init(){super.init(),this.platformApi=Laya.Browser.window.wx,this.showShareMenuWithTicket(!0),this.regisiterWXShareCallback()}showToast(e,t=1500){Laya.Browser.window.wx.showToast({title:e,icon:"none",duration:t})}showShareMenuWithTicket(e){wx.showShareMenu({withShareTicket:e,success:function(){},fail:function(){},complete:function(){}})}regisiterWXShareCallback(){if(Laya.Browser.onWeiXin){var e={title:"分享",image:""};Laya.Browser.window.wx.onShareAppMessage(function(){return console.log("用户点击了转发按钮"),{title:e.title,imageUrl:e.image,query:"share_id=1"}})}}}class W{static init(){this.isStatShow&&(Laya.Stat.show(),f.muiscSwitch(!1)),this.game=new F,this.goLoad(),V.addLoadRes(s.SubPackage),V.addLoadRes(s.Scene3D),f.init(),b.CheckPlayerData(),Laya.Browser.onWeiXin?this.platform=new Y:this.platform=new S,this.platform.init();this.platform.loadSubPackage(this.subPackageName,e=>{e&&(V.removeLoadRes(s.SubPackage),this.load3DRes(this.scene3DUrl))})}static sceneEventOn(){e.on(o.Scene_GoHome,this,this.goHome),e.on(o.Scene_GoGame,this,this.goGame),e.on(o.Scene_GoOver,this,this.goOver)}static goLoad(){this.sceneEventOn(),this.openScene(i.Load)}static goHome(){this.closeScene(i.Load),this.closeScene(i.Over),this.openScene(i.Home),this.game.levelInit()}static goGame(){0==this.game.playCount&&f.randomPlayMusic(),this.closeScene(i.Home),this.openScene(i.Game),this.game.gameStart()}static goOver(){this.closeScene(i.Game),this.openScene(i.Over)}static load3DRes(e){var t=[{url:e,clas:Laya.Scene3D,priority:1}];Laya.loader.create(t,Laya.Handler.create(this,this.onLoadFinished,[{target:"3dRes"}],!1),Laya.Handler.create(this,this.onLoading,null,!1)),Laya.loader.on(Laya.Event.ERROR,this,t=>{console.error("资源加载失败",t),this.load3DRes(e)})}static onLoadFinished(e){console.log("资源加载完成",e),this.loadSceneRes(),V.removeLoadRes(s.Scene3D)}static onLoading(e){}static loadSceneRes(){let e=Laya.loader.getRes(this.scene3DUrl);Laya.stage.addChild(e),Laya.stage.setChildIndex(e,0),this.game.mainScene=e,this.game.firstIn()}static openScene(e,t){Laya.Scene.open(e,!1,null,Laya.Handler.create(this,e=>{Laya.stage.addChild(e),t&&t()}))}static closeScene(e,t){Laya.Scene.close(e)&&t&&t()}static checkPerformance(e,t,a){let i=0,s=100,o=s;Laya.timer.loop(100,this,function addValue(){i+=1e3/Laya.timer.delta;o--;if(o<=0){Laya.timer.clear(this,addValue);let o=i/s;o>50?e&&e():o>40?t&&t():a&&a()}})}}W.subPackageName="scene",W.scene3DUrl="res/scene/Conventional/ResScene.ls",W.isStatShow=!1;new class{constructor(){window.Laya3D?Laya3D.init(X.width,X.height):Laya.init(X.width,X.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=X.scaleMode,Laya.stage.screenMode=X.screenMode,Laya.stage.alignV=X.alignV,Laya.stage.alignH=X.alignH,Laya.URL.exportSceneToJson=X.exportSceneToJson,(X.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),X.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),X.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){W.init()}}}();