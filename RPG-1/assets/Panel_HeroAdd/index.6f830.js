window.__require=function e(t,a,o){function i(l,s){if(!a[l]){if(!t[l]){var r=l.split("/");if(r=r[r.length-1],!t[r]){var d="function"==typeof __require&&__require;if(!s&&d)return d(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+l+"'")}l=r}var c=a[l]={exports:{}};t[l][0].call(c.exports,function(e){return i(t[l][1][e]||e)},c,c.exports,e,t,a,o)}return a[l].exports}for(var n="function"==typeof __require&&__require,l=0;l<o.length;l++)i(o[l]);return i}({Panel_HeroAdd:[function(e,t,a){"use strict";cc._RF.push(t,"36abe60hXFNhpEUP9SimbAw","Panel_HeroAdd");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),n=this&&this.__decorate||function(e,t,a,o){var i,n=arguments.length,l=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,a):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,a,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(l=(n<3?i(l):n>3?i(t,a,l):i(t,a))||l);return n>3&&l&&Object.defineProperty(t,a,l),l};Object.defineProperty(a,"__esModule",{value:!0});var l=e("../../../Bundle1_Loading/Scripts/Config/EnumTypes"),s=e("../../../Bundle1_Loading/Scripts/Mgr/EventMgr"),r=e("../../../Bundle1_Loading/Scripts/Tool/Tool"),d=e("../../../Bundle2_Main/Scripts/Mgr/RoleMgr"),c=e("../../../Bundle2_Main/Scripts/Panel/Panel"),h=e("../../../Bundle2_Main/SeverTest/SeverMgr"),p=cc._decorator,f=p.ccclass,u=p.property,v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nameLabel=null,t.levelLabel=null,t.pointLabel=null,t.hpItem=null,t.mpItem=null,t.atkItem=null,t.defItem=null,t.nimbleItem=null,t.spritItem=null,t.recoverItem=null,t.massChange=null,t.strChange=null,t.agileChange=null,t.speedChange=null,t.mentalChange=null,t.refreshBtn=null,t.resetBtn=null,t.sureBtn=null,t}return i(t,e),t.prototype.init=function(){},t.prototype.openCb=function(){},t.prototype.closeCb=function(){},t.prototype.initData=function(e){this.roleData=e,this.fakeRoleData=JSON.parse(JSON.stringify(e));var t=d.default.getJsonData(e);this.nameLabel.string=t.name,this.levelLabel.string=e.level.toString()+"\u7ea7",this.updateShow(),this.changeInit(this.massChange,0),this.changeInit(this.strChange,1),this.changeInit(this.agileChange,2),this.changeInit(this.speedChange,3),this.changeInit(this.mentalChange,4),r.Tool.addClickEvent(this.sureBtn,this.confirm,this),r.Tool.addClickEvent(this.resetBtn,this.cancelClick,this),r.Tool.addClickEvent(this.refreshBtn,this.refreshClick,this),s.EventMgr.on(l.EventType.Role_Update_Event,this.refreshData,this)},t.prototype.refreshData=function(){var e=h.default.instance.localData.hasRoles[this.roleData.index];this.initData(e)},t.prototype.updateShow=function(){var e=this.roleData,t=this.fakeRoleData;this.pointLabel.string=t.BPPoint.toString(),this.itemDeal(this.hpItem,d.default.calHP(e),d.default.calHP(t)),this.itemDeal(this.mpItem,d.default.calMP(e),d.default.calMP(t)),this.itemDeal(this.atkItem,d.default.calAtk(e),d.default.calAtk(t)),this.itemDeal(this.defItem,d.default.calDef(e),d.default.calDef(t)),this.itemDeal(this.nimbleItem,d.default.calNimble(e),d.default.calNimble(t)),this.itemDeal(this.spritItem,d.default.calSpirt(e),d.default.calSpirt(t)),this.itemDeal(this.recoverItem,d.default.calRecovery(e),d.default.calRecovery(t)),this.changeDeal(this.massChange,d.default.calMass(e,!0),d.default.calMass(t,!0)),this.changeDeal(this.strChange,d.default.calStr(e,!0),d.default.calStr(t,!0)),this.changeDeal(this.agileChange,d.default.calAgile(e,!0),d.default.calAgile(t,!0)),this.changeDeal(this.speedChange,d.default.calSpeed(e,!0),d.default.calSpeed(t,!0)),this.changeDeal(this.mentalChange,d.default.calMental(e,!0),d.default.calMental(t,!0))},t.prototype.changeInit=function(e,t){var a=e.getChildByName("btn_add"),o=e.getChildByName("btn_reduce");r.Tool.addClickEvent(a,this.changeAddClick,this,[t]),r.Tool.addClickEvent(o,this.changeReduceClick,this,[t])},t.prototype.itemDeal=function(e,t,a){void 0===a&&(a=0),e.getChildByName("base").getComponent(cc.Label).string=Math.floor(a).toString();var o,i=e.getChildByName("add").getComponent(cc.Label),n=Math.floor(a-t);0==n?o="":n>0?(o="+"+n.toString(),i.node.color=r.Tool.getRgbByHex("#BDF710")):n<0&&(o=n.toString(),i.node.color=r.Tool.getRgbByHex("#FC4E66")),i.string=o},t.prototype.changeDeal=function(e,t,a){void 0===a&&(a=0);var o,i=e.getChildByName("value").getComponent(cc.Label),n=e.getChildByName("add").getComponent(cc.Label);i.string=Math.floor(a).toString();var l=Math.floor(a-t);0==l?o="":l>0?(o="+"+l.toString(),n.node.color=r.Tool.getRgbByHex("#BDF710")):l<0&&(o=l.toString(),n.node.color=r.Tool.getRgbByHex("#FC4E66")),n.string=o},t.prototype.changeAddClick=function(e){if(this.fakeRoleData.BPPoint<=0)s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6ca1\u6709\u53ef\u5206\u914d\u7684\u5c5e\u6027\u70b9");else{switch(this.fakeRoleData.BPPoint--,e[0]){case 0:this.fakeRoleData.massAdd++,d.default.calMass(this.fakeRoleData,!0)>d.default.calAllBPPoint(this.fakeRoleData)/2&&(this.fakeRoleData.massAdd--,this.fakeRoleData.BPPoint++,s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u5c5e\u6027\u70b9\u4e0d\u80fd\u8d85\u8fc7\u603b\u5c5e\u6027\u70b9\u7684\u4e00\u534a"));break;case 1:this.fakeRoleData.strAdd++,d.default.calStr(this.fakeRoleData,!0)>d.default.calAllBPPoint(this.fakeRoleData)/2&&(this.fakeRoleData.strAdd--,this.fakeRoleData.BPPoint++,s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u5c5e\u6027\u70b9\u4e0d\u80fd\u8d85\u8fc7\u603b\u5c5e\u6027\u70b9\u7684\u4e00\u534a"));break;case 2:this.fakeRoleData.agileAdd++,d.default.calAgile(this.fakeRoleData,!0)>d.default.calAllBPPoint(this.fakeRoleData)/2&&(this.fakeRoleData.agileAdd--,this.fakeRoleData.BPPoint++,s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u5c5e\u6027\u70b9\u4e0d\u80fd\u8d85\u8fc7\u603b\u5c5e\u6027\u70b9\u7684\u4e00\u534a"));break;case 3:this.fakeRoleData.speedAdd++,d.default.calSpeed(this.fakeRoleData,!0)>d.default.calAllBPPoint(this.fakeRoleData)/2&&(this.fakeRoleData.speedAdd--,this.fakeRoleData.BPPoint++,s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u5c5e\u6027\u70b9\u4e0d\u80fd\u8d85\u8fc7\u603b\u5c5e\u6027\u70b9\u7684\u4e00\u534a"));break;case 4:this.fakeRoleData.mentalAdd++,d.default.calMental(this.fakeRoleData,!0)>d.default.calAllBPPoint(this.fakeRoleData)/2&&(this.fakeRoleData.mentalAdd--,this.fakeRoleData.BPPoint++,s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u5c5e\u6027\u70b9\u4e0d\u80fd\u8d85\u8fc7\u603b\u5c5e\u6027\u70b9\u7684\u4e00\u534a"))}this.updateShow()}},t.prototype.changeReduceClick=function(e){if(this.fakeRoleData.BPPoint>=this.roleData.BPPoint)s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6ca1\u6709\u53ef\u51cf\u7684\u5c5e\u6027\u70b9");else{var t=this.fakeRoleData.massAdd-this.roleData.massAdd,a=this.fakeRoleData.strAdd-this.roleData.strAdd,o=this.fakeRoleData.agileAdd-this.roleData.agileAdd,i=this.fakeRoleData.speedAdd-this.roleData.speedAdd,n=this.fakeRoleData.mentalAdd-this.roleData.mentalAdd;switch(e[0]){case 0:if(t<=0)return void s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6ca1\u6709\u53ef\u51cf\u7684\u5c5e\u6027\u70b9");this.fakeRoleData.massAdd--;break;case 1:if(a<=0)return void s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6ca1\u6709\u53ef\u51cf\u7684\u5c5e\u6027\u70b9");this.fakeRoleData.strAdd--;break;case 2:if(o<=0)return void s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6ca1\u6709\u53ef\u51cf\u7684\u5c5e\u6027\u70b9");this.fakeRoleData.agileAdd--;break;case 3:if(i<=0)return void s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6ca1\u6709\u53ef\u51cf\u7684\u5c5e\u6027\u70b9");this.fakeRoleData.speedAdd--;break;case 4:if(n<=0)return void s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6ca1\u6709\u53ef\u51cf\u7684\u5c5e\u6027\u70b9");this.fakeRoleData.mentalAdd--}this.fakeRoleData.BPPoint++,this.updateShow()}},t.prototype.cancelClick=function(){this.fakeRoleData=JSON.parse(JSON.stringify(this.roleData)),this.updateShow()},t.prototype.confirm=function(){var e=this.fakeRoleData.massAdd-this.roleData.massAdd,t=this.fakeRoleData.strAdd-this.roleData.strAdd,a=this.fakeRoleData.agileAdd-this.roleData.agileAdd,o=this.fakeRoleData.speedAdd-this.roleData.speedAdd,i=this.fakeRoleData.mentalAdd-this.roleData.mentalAdd;h.default.instance.confirmAddPoint(this.roleData.index,e,t,a,o,i),s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u52a0\u70b9\u6210\u529f"),this.close()},t.prototype.refreshClick=function(){h.default.instance.refreshFreeAddPoint(this.roleData.index),s.EventMgr.event(l.EventType.Tips_Toast_Event,"\u6d17\u70b9\u6210\u529f")},n([u(cc.Label)],t.prototype,"nameLabel",void 0),n([u(cc.Label)],t.prototype,"levelLabel",void 0),n([u(cc.Label)],t.prototype,"pointLabel",void 0),n([u(cc.Node)],t.prototype,"hpItem",void 0),n([u(cc.Node)],t.prototype,"mpItem",void 0),n([u(cc.Node)],t.prototype,"atkItem",void 0),n([u(cc.Node)],t.prototype,"defItem",void 0),n([u(cc.Node)],t.prototype,"nimbleItem",void 0),n([u(cc.Node)],t.prototype,"spritItem",void 0),n([u(cc.Node)],t.prototype,"recoverItem",void 0),n([u(cc.Node)],t.prototype,"massChange",void 0),n([u(cc.Node)],t.prototype,"strChange",void 0),n([u(cc.Node)],t.prototype,"agileChange",void 0),n([u(cc.Node)],t.prototype,"speedChange",void 0),n([u(cc.Node)],t.prototype,"mentalChange",void 0),n([u(cc.Node)],t.prototype,"refreshBtn",void 0),n([u(cc.Node)],t.prototype,"resetBtn",void 0),n([u(cc.Node)],t.prototype,"sureBtn",void 0),n([f],t)}(c.default);a.default=v,cc._RF.pop()},{"../../../Bundle1_Loading/Scripts/Config/EnumTypes":void 0,"../../../Bundle1_Loading/Scripts/Mgr/EventMgr":void 0,"../../../Bundle1_Loading/Scripts/Tool/Tool":void 0,"../../../Bundle2_Main/Scripts/Mgr/RoleMgr":void 0,"../../../Bundle2_Main/Scripts/Panel/Panel":void 0,"../../../Bundle2_Main/SeverTest/SeverMgr":void 0}]},{},["Panel_HeroAdd"]);