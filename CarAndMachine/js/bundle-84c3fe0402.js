!function(){"use strict";var t,e,i,s,a,o,n,r,h,l;!function(t){t.WX="wx",t.OPPO="oppo",t.VIVO="vivo",t.PC="pc",t.TickTok="ticktok"}(t||(t={})),function(t){t.shortcut="prefab/qy_prefab/shortcut.prefab",t.moreGame="prefab/qy_prefab/moreGame.prefab",t.interNativeAd="prefab/qy_prefab/interNativeAd.prefab"}(e||(e={})),function(t){t.Load="uiScene/Load.scene",t.Home="uiScene/Home.scene",t.Game="uiScene/Game.scene",t.Over="uiScene/Over.scene",t.Pram="uiScene/Pram.scene"}(i||(i={})),function(t){t[t.Load_Res_Msg_Event=0]="Load_Res_Msg_Event",t[t.Init_Game_Event=1]="Init_Game_Event",t[t.Play_Game_Event=2]="Play_Game_Event",t[t.Over_Game_Event=3]="Over_Game_Event",t[t.Open_Ui_Event=4]="Open_Ui_Event",t[t.Close_Ui_Event=5]="Close_Ui_Event",t[t.Update_Coin_Event=6]="Update_Coin_Event",t[t.Update_Skin_Event=7]="Update_Skin_Event",t[t.Update_HpUI_Event=8]="Update_HpUI_Event",t[t.Close_Video_Event=9]="Close_Video_Event",t[t.Show_Video_Event=10]="Show_Video_Event",t[t.Platform_Wake_Event=11]="Platform_Wake_Event",t[t.Platform_Sleep_Event=12]="Platform_Sleep_Event",t[t.Skin_Unlock=13]="Skin_Unlock",t[t.Skin_Active=14]="Skin_Active",t[t.AirUI_On=15]="AirUI_On",t[t.AirUI_Off=16]="AirUI_Off",t[t.Player_Dead_Event=17]="Player_Dead_Event",t[t.Player_Reborn_Event=18]="Player_Reborn_Event",t[t.Player_GiveUp_Event=19]="Player_GiveUp_Event",t[t.Native_Visible_Event=20]="Native_Visible_Event",t[t.Coin_Less_Event=21]="Coin_Less_Event"}(s||(s={})),function(t){t.BGM="BG",t.CLICK="Click",t.PlayerHit="PlayerHit",t.PlayerSwordAttack="PlayerSwordAttack",t.PlayerSwordHit="PlayerSwordHit",t.Win="Win",t.Fail="Fail",t.CarFly="Boost",t.CarRuning="CarRuning",t.CarEnding="CarEnding",t.CarHit="Hit",t.Shout="Shout",t.SwordSkill="SwordSkill",t.Count="count",t.Go="go",t.Boom="Boom"}(a||(a={})),function(t){t[t.Low=0]="Low",t[t.Mid=1]="Mid",t[t.High=2]="High"}(o||(o={}));class c{static randTouchProgress(){this.wuchuProgressValue<.19?this.wuchuProgressValue=this.getRangeNumer(.08,.3):this.wuchuProgressValue=this.getRangeNumer(this.wuchuProgressValue-.19+.08,this.wuchuProgressValue-.19+.3)}static getRangeNumer(t,e){return Math.random()*(e-t)+t}static init(t){let e=new Laya.Scene;Laya.stage.addChild(e),e.size(Laya.stage.width,Laya.stage.height);let i=new Laya.Panel;e.addChild(i),i.size(1750,Laya.stage.height),i.bgColor="#ffffff";let s=new Laya.Image("ui/load/company_logo_black.png");e.addChild(s),s.centerX=0,s.centerY=0,this.loadScene=e,this.getConfig(()=>{t&&t()}),d.initAd(),this.randTouchProgress()}static loadGame(t){var e=()=>{this.showReMen(t),this.loadScene&&(this.loadScene.destroy(),this.loadScene=null)};this.canTrapAll?d.showVideoAd(e,e):e()}static showReMen(t){this.canTrapRemen?Laya.Scene.open(n.Remen,!1,null,Laya.Handler.create(this,e=>{Laya.stage.addChild(e),e.size(Laya.stage.width,Laya.stage.height),d.showGridAD()||d.initGridAD(()=>{d.showGridAD()},.5*Laya.Browser.clientWidth-200,0),this.bannerShowHide(),d.bannerIndex=0;let i=e.btnContinue;i.offAllCaller(this),i.on(Laya.Event.CLICK,this,()=>{Laya.timer.clearAll(this),Laya.Scene.close(n.Remen),d.hideGridAD(),d.showVideoAd(),this.showBox2(t,!0),this.refreshBanner()})})):t&&t()}static bannerShowHide(){d.hideNextBanner(),Laya.timer.once(1e3,this,()=>{d.showNextBanner(),Laya.timer.once(800,this,()=>{this.bannerShowHide()})})}static showBox1(t){this.canTrapBox?Laya.Scene.open(n.Box1,!1,{closeCB:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t),t.size(Laya.stage.width,Laya.stage.height)})):t&&t()}static showBox2(t,e=!1){this.canTrapBox?Laya.Scene.open(n.Box2,!1,{closeCB:t},Laya.Handler.create(this,t=>{Laya.stage.addChild(t),t.size(Laya.stage.width,Laya.stage.height),e&&d.showBannerAd()})):t&&t()}static showVitrualWxpage(t,e=0){if(this.canTrapVirtualWx){var i=()=>{this.showVitrualWxpage(t,1)},s=()=>{this.showVitrualWxpage(t,2)};if(this.virtualScene){let a=this.virtualScene,o=a.btnCancel,r=a.btnConfirm;1==e?(o.offAllCaller(this),o.on(Laya.Event.CLICK,this,()=>{d.showVideoAd(i,i)}),r.offAllCaller(this),r.on(Laya.Event.CLICK,this,()=>{this.virtualScene=null,Laya.Scene.close(n.VitrualWx),this.showBox1(t)})):2==e&&(r.offAllCaller(this),r.on(Laya.Event.CLICK,this,()=>{d.showVideoAd(s,s)}),o.offAllCaller(this),o.on(Laya.Event.CLICK,this,()=>{this.virtualScene=null,Laya.Scene.close(n.VitrualWx),this.showBox1(t)}))}else Laya.Scene.open(n.VitrualWx,!1,null,Laya.Handler.create(this,t=>{Laya.stage.addChild(t),t.size(Laya.stage.width,Laya.stage.height),this.virtualScene=t;let e=t.btnCancel,a=t.btnConfirm;e.offAllCaller(this),e.on(Laya.Event.CLICK,this,()=>{d.showVideoAd(i,i)}),a.offAllCaller(this),a.on(Laya.Event.CLICK,this,()=>{d.showVideoAd(s,s)})}))}else this.showBox1(t)}static inHomePage(t){this.canTrapAll?d.showVideoAd(t,t):t&&t()}static startGame(t){var e=()=>{this.showVitrualWxpage(t)};this.canTrapAll?d.showVideoAd(e,e):e()}static get allowScene(){if(Laya.Browser.onWeiXin){var t=Laya.Browser.window.wx.getLaunchOptionsSync();return console.log("当前场景：",t.scene),-1==this.scenes.indexOf(t.scene)}return!0}static getConfig(t){Laya.Browser.onWeiXin?(this.wxsdk=Laya.Browser.window.wxsdk,this.wxsdk.init({version:"1.0.0",appid:c.appid,secret:c.secret,share:{title:"你能过得了这一关吗？",image:"https://game-oss.smallshark.cn/game/20211119/125404654f888f.jpg?imageslim"}}),this.wxsdk.onInit(()=>{t&&t()}),this.wxsdk.onLoginFail(()=>{console.log("登录失败"),t&&t()}),this.wxsdk.login()):t&&t()}static httpRequest(t,e,i="get",s,a){var o=new Laya.HttpRequest;o.http.timeout=5e3,o.once(Laya.Event.COMPLETE,this,s),o.once(Laya.Event.ERROR,this,a,[t,e,i,s]),"get"==i?o.send(t+"?"+e,"",i,"text"):"post"==i&&o.send(t,JSON.stringify(e),i,"text")}static getConfigByKey(t){return!Laya.Browser.onWeiXin||Laya.Browser.window.wxsdk.conf[t]}static get canTrapAll(){return this.allowScene&&!this.getConfigByKey("isCloseAll")}static get canTrapVirtualWx(){return this.canTrapAll&&this.getConfigByKey("showVitualWx")}static get canTrapBox(){return this.canTrapAll&&this.getConfigByKey("showBox")}static get canTrapRemen(){return this.canTrapAll&&this.getConfigByKey("showRemen")}static refreshBanner(){this.refreshCount--,this.refreshCount<=0&&(this.refreshCount=3,d.createMoreBanner())}}c.appid="251",c.secret="woxlj1tm2ykbrpzngvfhmhsdu7dp0xhy",c.bannerId="adunit-85558ed5d274ac3e",c.videoId="adunit-0482e4b8570eba68",c.gridId="adunit-7b1d1801b2e37dac",c.wuchuProgressValue=0,c.wuchuProgressStepAdd=.1,c.wuchuProgressFrameSub=.0032,c.scenes=[1005,1006,1007,1008,1011,1012,1013,1014,1017,1020,1023,1024,1025,1027,1030,1031,1032,1036,1042,1044,1047,1048,1049,1053,1102,1129],c.refreshCount=3,function(t){t.Remen="FDScene/Remen.scene",t.VitrualWx="FDScene/VitrualWx.scene",t.Box1="FDScene/Box1.scene",t.Box2="FDScene/Box2.scene"}(n||(n={}));class d{static initAd(){this.createMoreBanner(),this.createVideoAd()}static getSystemInfoSync(){return this.sysInfo||(this.sysInfo=wx.getSystemInfoSync()),this.sysInfo}static createMoreBanner(){if(this.bannerAds.length>0){for(let t=0;t<this.bannerAds.length;t++)this.bannerAds[t].destroy();this.bannerAds=[]}for(let t=0;t<3;t++){let t=this.createBannerAd();this.bannerAds.push(t)}}static showNextBanner(t){t&&(this.bannerIndex=t);let e=this.bannerAds[this.bannerIndex];e&&e.show()}static hideNextBanner(){let t=this.bannerAds[this.bannerIndex];t&&(t.hide(),this.bannerIndex++,this.bannerIndex>=this.bannerAds.length&&(this.bannerIndex=0))}static createBannerAd(t=!1){if(!Laya.Browser.onWeiXin)return;let e=this.getSystemInfoSync(),i=Laya.Browser.window.wx.createBannerAd({adUnitId:c.bannerId,style:{top:.8*e.screenHeight,width:300,left:e.screenWidth/2-150},adIntervals:30});return i.onLoad(()=>{t&&d.showBannerAd(),console.log("Banner广告加载成功")}),i.onError(t=>{this.bannerAd=null,console.error("Banner广告加载失败",JSON.stringify(t))}),i.onResize(t=>{let s=i.style.realHeight+.1;i.style.top=e.screenHeight-s}),this.bannerAd=i,i}static showBannerAd(){this.bannerAd?this.bannerAd.show().then(()=>{}).catch(t=>{this.createBannerAd(!0)}):this.createBannerAd(!0)}static hideBannerAd(){this.bannerAd&&this.bannerAd.hide()}static destroyBannerAd(){this.bannerAd&&(this.bannerAd.destroy(),this.bannerAd=null)}static createVideoAd(){if(Laya.Browser.onWeiXin&&!this.isCreatingVideoAd){this.isCreatingVideoAd=!0;var t=Laya.Browser.window.wx.createRewardedVideoAd({adUnitId:c.videoId});t.onLoad(e=>{this.isCreatingVideoAd=!1,this.videoAd=t,console.log("激励视频广告加载成功"),this.isCreateAndShow&&(t.show(),this.isCreateAndShow=!1),this.canShowVideo=!0}),t.onError(e=>{t.destroy(),this.isCreatingVideoAd=!1,this.videoAd=null,console.error("激励视频广告加载失败",JSON.stringify(e)),console.log(this.videoCancelCallback),this.videoCancelCallback&&(this.videoCancelCallback(),this.videoCancelCallback=null,this.videoFinishCallback=null)}),t.onClose(t=>{t&&(t.isEnded?this.videoFinishCallback&&this.videoFinishCallback():this.videoCancelCallback&&this.videoCancelCallback(),this.videoFinishCallback=null,this.videoCancelCallback=null)})}}static showVideoAd(t,e){if(Laya.Browser.onWeiXin){if(this.videoFinishCallback=t,this.videoCancelCallback=e,!this.videoAd)return this.isCreateAndShow=!0,void this.createVideoAd();this.canShowVideo?(this.videoAd.show(),this.canShowVideo=!1):(e&&e(),this.videoFinishCallback=null,this.videoCancelCallback=null)}else t&&t()}static destroyVideoAd(){this.videoAd&&(this.videoAd.destroy(),this.videoAd=null)}static initGridAD(t,e=0,i=0){Laya.Browser.onWeiXin?(this.CreateGridAD(c.gridId,e,i),t&&(this.initGridCB=t)):t&&t(!1)}static CreateGridAD(t,e,i){try{if(Laya.Browser.window.wx.createCustomAd){var s=Laya.Browser.window.wx.createCustomAd({adUnitId:t,adIntervals:31,style:{left:e,top:i,width:Laya.Browser.clientWidth/2.2}});s.onLoad(t=>{d.gridAd=s,s.show(),d.initGridCB&&(d.initGridCB(!0),d.initGridCB=null)}),s.onError(t=>{console.error(t),d.initGridCB&&(d.initGridCB(!1),d.initGridCB=null)})}}catch(t){console.log("原生格子报错"+t),d.initGridCB&&(d.initGridCB(!1),d.initGridCB=null)}}static showGridAD(){return!!this.gridAd&&(this.gridAd.show(),!0)}static hideGridAD(){this.gridAd&&this.gridAd.hide(),Laya.timer.once(500,this,()=>{this.gridAd&&this.gridAd.hide()})}}d.bannerAds=[],d.bannerIndex=0,d.isCreatingVideoAd=!1,d.isCreateAndShow=!1,d.canShowVideo=!1;class p extends Laya.Scene{constructor(){super(...arguments),this.progressValue=0,this.wuchuCount=1}onAwake(){this.size(Laya.stage.width,Laya.stage.height)}onOpened(t){t&&t.count&&(this.wuchuCount=t.count),t&&t.closeCB&&(this.closeCB=t.closeCB),d.hideBannerAd(),Laya.timer.once(1e3,this,()=>{d.hideBannerAd()}),this.btnPress.on(Laya.Event.CLICK,this,this.onPress),Laya.timer.frameLoop(1,this,this.reFreshUI)}onClosed(){d.hideBannerAd(),Laya.timer.clearAll(this),this.closeCB&&this.closeCB()}onPress(){this.progressValue+=c.wuchuProgressStepAdd,Laya.Tween.to(this.btnPress,{scaleX:1.2,scaleY:1.2},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.btnPress,{scaleX:1,scaleY:1},100,null)})),this.progressValue>=c.wuchuProgressValue&&(d.showBannerAd(),c.randTouchProgress(),Laya.timer.once(2e3,this,()=>{this.wuchuCount--,this.wuchuCount>0?d.hideBannerAd():this.close()})),Laya.Tween.to(this.imgSushi,{rotation:30},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.imgSushi,{rotation:0},100)})),this.pressBar.value=this.progressValue}reFreshUI(){this.progressValue>c.wuchuProgressFrameSub&&(this.progressValue-=c.wuchuProgressFrameSub),this.pressBar.value=this.progressValue,this.light.rotation+=1}}class m extends Laya.Scene{constructor(){super(...arguments),this.progressValue=0,this.wuchuCount=1}onAwake(){this.size(Laya.stage.width,Laya.stage.height)}onOpened(t){t&&t.count&&(this.wuchuCount=t.count),t&&t.closeCB&&(this.closeCB=t.closeCB),d.hideGridAD(),this.btnPress.on(Laya.Event.CLICK,this,this.onPress),Laya.timer.frameLoop(1,this,this.reFreshUI),this.tweenScale()}onClosed(){d.hideGridAD(),d.hideBannerAd(),Laya.timer.clearAll(this),Laya.Tween.clearAll(this.imgEffect),this.closeCB&&this.closeCB()}onPress(){this.progressValue+=c.wuchuProgressStepAdd,Laya.Tween.to(this.imgGift,{scaleX:1.2,scaleY:1.2},100,null,Laya.Handler.create(this,()=>{Laya.Tween.to(this.imgGift,{scaleX:1,scaleY:1},100,null)})),this.progressValue>=c.wuchuProgressValue&&(d.showGridAD(),c.randTouchProgress(),Laya.timer.once(2e3,this,()=>{this.wuchuCount--,this.wuchuCount>0?d.hideGridAD():this.close()}))}reFreshUI(){this.progressValue>c.wuchuProgressFrameSub&&(this.progressValue-=c.wuchuProgressFrameSub),this.light.rotation+=1}tweenScale(){var t=200;Laya.Tween.to(this.imgEffect,{scaleX:1.2,scaleY:1.2,alpha:.8},t),Laya.timer.once(t,this,()=>{Laya.Tween.to(this.imgEffect,{scaleX:1,scaleY:1,alpha:1},t),Laya.timer.once(t,this,this.tweenScale)})}}class g{static toAlpha(t,e,i,s,a=null,o=null,n=!1,r=!1){if(t){var h=null;t.alpha=e,alpha1()}function alpha1(){h=r||n?new Laya.Handler(this,alpha2):new Laya.Handler(this,()=>{o&&o(),o=null}),Laya.Tween.to(t,{alpha:i},s,a,h)}function alpha2(){h=r?new Laya.Handler(this,alpha1):null,Laya.Tween.to(t,{alpha:e},s,a,h)}}static toScale(t,e,i,s,a,o,n,r=!1){if(t){var h=null;t.scale(e,e),scale1()}function scale1(){h=r||n?new Laya.Handler(this,scale2):new Laya.Handler(this,()=>{o&&o(),o=null}),Laya.Tween.to(t,{scaleX:i,scaleY:i},s,a,h)}function scale2(){h=r?new Laya.Handler(this,scale1):null,Laya.Tween.to(t,{scaleX:e,scaleY:e},s,a,h)}}static toPosition(t,e,i,s=null,a=null,o=!1,n=0){let r=new Laya.Vector2(t.x,t.y);function pos1(){if(o)switch(n){case 0:var r=new Laya.Handler(this,pos2);break;case 1:r=new Laya.Handler(this,pos3)}else r=new Laya.Handler(this,()=>{a&&a(),a=null});Laya.Tween.to(t,{x:e.x,y:e.y},i,s,r)}function pos2(){Laya.Tween.to(t,{x:r.x,y:r.y},i,s,Laya.Handler.create(this,pos1))}function pos3(){t.pos(r.x,r.y),pos1()}pos1()}static clearTween(t){Laya.Tween.clearAll(t)}}class u{}u.usingPrefabs=[],u.isSuccess=!1,u.maxScore=0,u.minCarHp=5e3,u.carHitReduceHp=500,u.stagesData=[[0,1,2,3,4]],u.minCamFov=40,u.camFovSpeedAxis=4,u.camLerpAxis=.2,u.carBaseAddSpeed=2,u.carSpeedUpSpeed=5,u.carHitHorizontal=2.5,u.PlayerHp=20,u.PlayerAttack=1,u.PlayerSkill1CD=6e3,u.PlayerSkill2CD=6e3,u.AIHp=[20],u.AIAttack=[1],u.AIAttackInterval=[100],u.AISkill1CD=[6e3],u.AISkill2CD=[6e3],u.AIAttackWeight=10,u.AIgoHealHpPrecent=.3;class f{static file_ExportVarByUIScene(t){Laya.loader.load(t,Laya.Handler.create(this,t=>{let e="遍历Var开始：\n",i=t=>{if(t&&t.props&&null!=t.props.var&&null!=t.props.var){let i=t.type,s=t.props.var;e+=s+":Laya."+i+"\n"}},s=t=>{let e=t.child?t.child:[];for(let t=0;t<e.length;t++){let a=e[t];i(a),a.child&&s(a)}};s(t),e+="遍历Var结束！",console.log(e)}),null,Laya.Loader.JSON)}static file_SaveForBrowser(t,e){console.log("浏览器");let i=new Blob([t],{type:"application/json"}),s=document.createElement("a");s.download=e,s.innerHTML="Download File",null!=window.webkitURL&&(s.href=window.webkitURL.createObjectURL(i)),s.click()}static file_LoadJson(t,e){Laya.loader.load(t,Laya.Handler.create(this,()=>{let i=Laya.Loader.getRes(t);e&&e(i)}),null,Laya.Loader.JSON)}static d3_FindNodeByName(t,e){let i=null,s=t=>{for(let a=0;a<t.numChildren;a++){if(t.getChildAt(a).name==e)return void(i=t.getChildAt(a));s(t.getChildAt(a))}};return s(t),i}static d3_GetRandomPointInCircle(t,e,i=0){let s=new Laya.Vector3,a=Math.random()*(t-i)+i;s.x=2*Math.random()-1,s.z=2*Math.random()-1,Laya.Vector3.normalize(s,s);let o=new Laya.Vector3;return Laya.Vector3.scale(s,a,s),Laya.Vector3.add(e,s,o),o}static d3_GetParticleSystem(t){return t.particleSystem}static d3_CloneSprite(t){return t&&t.clone?t.clone():null}static d2_AddClickEvent(t,e,i,s,o=!1,n=!0,r=!0){t.offAllCaller(e);let h=t.scaleX,l=.9*h,c=!1;t.on(Laya.Event.MOUSE_DOWN,e,e=>{c=!0,r&&Laya.Tween.to(t,{scaleX:l,scaleY:l},60),o&&e.stopPropagation},s);t.on(Laya.Event.MOUSE_UP,e,s=>{0!=c&&(c=!1,o&&s.stopPropagation,r&&Laya.Tween.to(t,{scaleX:h,scaleY:h},60),i&&i.call(e,s),n&&u.sound.play(a.CLICK))},s);t.on(Laya.Event.MOUSE_OUT,e,e=>{0!=c&&(c=!1,r&&Laya.Tween.to(t,{scaleX:h,scaleY:h},60),o&&e.stopPropagation)},s)}static clamp01(t){return t>1?1:t<0?0:t}static clamp(t,e,i){return t<e?e:t>i?i:t}static get getCurrentTime(){return(new Date).getTime()}}!function(t){t.GameRealStart="Nimo_GameRealStart",t.GameSpeed1On="Nimo_GameSpeed1On",t.GameSpeed1Off="Nimo_GameSpeed1Off",t.GameAttack1On="Nimo_GameAttack1On",t.GameAttack1Off="Nimo_GameAttack1Off",t.GameAttack2On="Nimo_GameAttack2On",t.GameAttack2Off="Nimo_GameAttack2Off",t.GameAttack3On="Nimo_GameAttack3On",t.GameAttack3Off="Nimo_GameAttack3Off",t.GameAIDead="Nimo_GameAIDead",t.GameCarSpeedChange="Nimo_GameCarSpeedChange",t.GameEmojiCool="GameEmojiCool",t.GameEmojiCry="GameEmojiCry",t.GameEmojiCryLaugh="GameEmojiCryLaugh"}(r||(r={}));class y{constructor(){this.bannerId="",this.videoId="",this.interId="",this.gridId="",this.nativeId="",this.boxPortalId="",this.canSubPackage=!1,this.initAd(),this.regisiterCallback()}initAd(){console.warn("未初始化广告组件")}createBannerAd(t){console.warn("暂不支持Banner广告")}createVideoAd(){console.warn("暂不支持激励视频广告")}createInterAd(){console.warn("暂不支持插屏广告")}createGridAd(){console.warn("暂不支持格子广告")}createNativeAd(t,e){return console.warn("暂不支持原生广告"),null}createBoxProtalAd(){console.warn("暂不支持九宫格广告")}showBannerAd(){}hideBannerAd(){}destroyBannerAd(){}showVideoAd(t,e){t&&t()}destroyVideoAd(){}showInterAd(){}destroyInterAd(){}showGridAd(){}hideGridAd(){}destroyGridAd(){}showNativeAd(t,e){}loadNativeAd(t,e){}destroyNativeAd(t){}showBoxProtalAd(t,e){e&&e()}destroyBoxProtalAd(){}initRecorder(){}recordStart(){}recordPause(){}recordResume(){}recordStop(t){}clipVideo(){}shareVideo(t,e=["",""]){}getSystemInfoSync(){return!this.sysInfo&&this.platformApi&&(this.sysInfo=this.platformApi.getSystemInfoSync()),this.sysInfo}showToast(t,e){}vibrateShort(){this.platformApi&&this.platformApi.vibrateShort()}vibrateLong(){this.platformApi&&this.platformApi.vibrateLong()}loadSubpackage(t,e,i){if(!this.platformApi)return;this.platformApi.loadSubpackage({name:t,success:function(s){bt.ConsoleLog("分包加载成功：",t),i.call(s,e,!0)},fail:function(s){bt.ConsoleError("分包加载失败：",t,JSON.stringify(s)),i.call(s,e,!1)}}).onProgressUpdate(t=>{bt.ConsoleLog("分包================",JSON.stringify(t))})}loadSubpackagesSync(t,e,i){if(this.platformApi){var s=t.length;for(let a=0;a<s;a++)this.loadSubpackage(t[a],e,(t,e)=>{e&&0==--s&&(bt.ConsoleLog("全部分包加载完成"),i.call(this,t,e))})}}regisiterCallback(){this.platformApi&&(this.platformApi.offShow(this.onShowEvent),this.platformApi.onShow(this.onShowEvent),this.platformApi.offHide(this.onHideEvent),this.platformApi.onHide(this.onHideEvent))}onShowEvent(t){bt.Event.event(s.Platform_Wake_Event,{param:t})}onHideEvent(t){bt.Event.event(s.Platform_Sleep_Event,{param:t})}createShortcut(t){}hasShortcut(t){}setEnableDebug(){}}class C{}class v extends y{initAd(){this.canSubPackage=!0,this.platformApi=Laya.Browser.window.qg,this.bannerId="",this.videoId="414463",this.nativeId="414461",this.boxPortalId="414464",this.createVideoAd(),this.createBoxProtalAd()}createBannerAd(t=!1){this.getPlatformVersionCode<1051?console.warn("版本过低暂不支持Banner广告组件"):(this.bannerAd&&this.destroyBannerAd(),this.bannerAd=Laya.Browser.window.qg.createBannerAd({adUnitId:this.bannerId}),this.bannerAd.onLoad(()=>{t&&this.bannerAd.show().then(()=>{}).catch(t=>{this.createBannerAd()}),console.log("Banner广告加载成功")}),this.bannerAd.onError(t=>{this.bannerAd=null,console.error("Banner广告加载失败",JSON.stringify(t))}),this.bannerAd.onResize(t=>{}))}showBannerAd(){this.bannerAd?this.bannerAd.show().then(()=>{}).catch(t=>{this.createBannerAd(!0)}):this.createBannerAd(!0)}hideBannerAd(){this.bannerAd&&this.bannerAd.hide()}destroyBannerAd(){this.bannerAd&&(this.bannerAd.destroy(),this.bannerAd=null)}createVideoAd(){this.getPlatformVersionCode<1051?console.warn("版本过低暂不支持激励视频广告组件"):(this.videoAd&&this.destroyVideoAd(),this.videoAd=Laya.Browser.window.qg.createRewardedVideoAd({adUnitId:this.videoId}),this.videoAd.onLoad(t=>{console.log("激励视频广告加载成功")}),this.videoAd.onError(t=>{this.videoAd=null,console.error("激励视频广告加载失败",JSON.stringify(t))}),this.videoAd.onClose(t=>{t&&(t.isEnded?this.videoFinishCallback&&this.videoFinishCallback():this.videoCancelCallback&&this.videoCancelCallback(),Laya.SoundManager.muted=!1,this.videoFinishCallback=null,this.videoCancelCallback=null,this.videoAd.load(),bt.Event.event(s.Close_Video_Event,{isEnded:t.isEnded}))}),this.videoAd.load())}showVideoAd(t,e){if(!this.videoAd)return this.createVideoAd(),void this.showToast("广告暂未准备好,请稍后再试",2e3);this.videoFinishCallback=t,this.videoCancelCallback=e,Laya.SoundManager.muted=!0,this.videoAd.show().then(()=>{}).catch(t=>{this.createVideoAd(),this.videoFinishCallback=null,this.videoCancelCallback=null,this.showToast("广告暂未准备好,请稍后再试",2e3),Laya.SoundManager.muted=!1}),bt.Event.event(s.Show_Video_Event)}destroyVideoAd(){this.videoAd&&(this.videoAd.destroy(),this.videoAd=null)}createBoxProtalAd(){this.getPlatformVersionCode<1076?console.warn("版本过低暂不支持九宫格广告组件"):(this.boxPortalAd=Laya.Browser.window.qg.createGamePortalAd({adUnitId:this.boxPortalId}),this.boxPortalAd.onLoad(()=>{console.log("九宫格广告加载成功"),Laya.timer.clear(this,this.resetBoxAd)}),this.boxPortalAd.onError(t=>{this.boxPortalAd=null,console.error("九宫格广告加载失败",JSON.stringify(t))}),this.boxPortalAd.onClose(()=>{this.boxPortalCloseCallback&&this.boxPortalCloseCallback(),this.boxPortalCloseCallback=null}),this.boxPortalAd.load(),Laya.timer.once(2e3,this,this.resetBoxAd))}resetBoxAd(){this.boxPortalAd=null}showBoxProtalAd(t,e){if(!this.boxPortalAd)return t&&t(),this.createBoxProtalAd(),void this.showToast("广告暂未准备好,请稍后再试",2e3);this.boxPortalAd.show().then(()=>{this.boxPortalCloseCallback=t,e&&e()}).catch(e=>{this.destroyBoxProtalAd(),t&&t(),this.showToast("广告暂未准备好,请稍后再试",2e3)})}destroyBoxProtalAd(){this.boxPortalAd&&(this.boxPortalAd.destroy(),this.boxPortalAd=null,this.createBoxProtalAd())}createNativeAd(t,e){if(!(this.getPlatformVersionCode<1051)){var i=new C,s=Laya.Browser.window.qg.createNativeAd({adUnitId:t||this.nativeId});return s.load(),s.onLoad(t=>{if(t&&t.adList){i.nativeAd=s;let a=t.adList.pop();i.title=a.title,i.adId=a.adId.toString(),i.imgUrl=a.imgUrlList[0],i.desc=a.desc,console.log("原生广告加载成功"),i.nativeAd.reportAdShow({adId:i.adId}),e&&e(i)}}),s.onError(t=>{console.error("原生广告加载失败",JSON.stringify(t)),e&&e(null)}),i}console.warn("版本过低暂不支持原生广告组件")}showNativeAd(t,e){t&&t.nativeAd&&(t.nativeAd.reportAdClick({adId:t.adId}),e&&e(!0)),e&&e(!1)}loadNativeAd(t,e){t&&t.nativeAd?t.nativeAd.load().then(()=>{e&&e(t)}).catch(t=>{e&&e(null)}):this.createNativeAd(null,e)}destroyNativeAd(t){t&&t.nativeAd&&t.nativeAd.destroy()}get getPlatformVersionCode(){return this.getSystemInfoSync().platformVersionCode}showToast(t,e=1500){Laya.Browser.window.qg.showToast({title:t,duration:e})}createShortcut(t){this.hasShortcut(e=>{0==e&&Laya.Browser.window.qg.installShortcut({success:function(){t&&t()},fail:function(t){},complete:function(){}})})}hasShortcut(t){Laya.Browser.window.qg.hasShortcutInstalled({success:function(e){t&&t(e)},fail:function(t){},complete:function(){}})}setEnableDebug(){qg.setEnableDebug({enableDebug:!0,success:function(){console.log("开启调试面板")},complete:function(){},fail:function(){}})}}class w extends y{initAd(){this.canSubPackage=!0,this.platformApi=Laya.Browser.window.wx,this.bannerId="adunit-13956b06e4d79f94",this.videoId="adunit-38c16dc5bb35fd3b",this.interId="adunit-6add71646b81ad4a",this.gridId="adunit-18242cdd0286c125",this.showShareMenuWithTicket(!0),this.regisiterWXShareCallback()}createBannerAd(t=!1){if(this.compareSDKVersion("2.0.4"))return void console.warn("版本过低暂不支持Banner广告组件");this.bannerAd&&this.destroyBannerAd();let e=this.getSystemInfoSync();this.bannerAd=Laya.Browser.window.wx.createBannerAd({adUnitId:this.bannerId,style:{top:.8*e.screenHeight,width:300,left:e.screenWidth/2-150},adIntervals:30}),this.bannerAd.onLoad(()=>{t&&this.bannerAd.show().then(()=>{}).catch(t=>{this.createBannerAd()}),console.log("Banner广告加载成功")}),this.bannerAd.onError(t=>{this.bannerAd=null,console.error("Banner广告加载失败",JSON.stringify(t))}),this.bannerAd.onResize(t=>{let i=this.bannerAd.style.realHeight+.1;e.model.startsWith("iPhone X")&&(i+=40/Laya.Browser.height*Gt.height),this.bannerAd.style.top=e.screenHeight-i})}showBannerAd(){this.bannerAd?this.bannerAd.show().then(()=>{}).catch(t=>{this.createBannerAd(!0)}):this.createBannerAd(!0)}hideBannerAd(){this.bannerAd&&this.bannerAd.hide()}destroyBannerAd(){this.bannerAd&&(this.bannerAd.destroy(),this.bannerAd=null)}createVideoAd(){this.compareSDKVersion("2.0.4")?console.warn("版本过低暂不支持激励视频广告组件"):(this.videoAd&&this.destroyVideoAd(),this.videoAd=Laya.Browser.window.wx.createRewardedVideoAd({adUnitId:this.videoId}),this.videoAd.onLoad(t=>{console.log("激励视频广告加载成功")}),this.videoAd.onError(t=>{this.videoAd=null,console.error("激励视频广告加载失败",JSON.stringify(t))}),this.videoAd.onClose(t=>{t&&(t.isEnded?this.videoFinishCallback&&this.videoFinishCallback():this.videoCancelCallback&&this.videoCancelCallback(),this.videoFinishCallback=null,this.videoCancelCallback=null,this.videoAd.load())}))}showVideoAd(t,e){if(!this.videoAd)return this.createVideoAd(),void(t&&t());this.videoFinishCallback=t,this.videoCancelCallback=e,Laya.SoundManager.muted=!0,this.videoAd.show().then(()=>{}).catch(e=>{t&&t(),this.createVideoAd(),this.videoFinishCallback=null,this.videoCancelCallback=null,Laya.SoundManager.muted=!1})}destroyVideoAd(){this.videoAd&&(this.videoAd.destroy(),this.videoAd=null)}get getPlatformVersionCode(){return this.getSystemInfoSync().SDKVersion}compareSDKVersion(t="1.0.0"){let e=this.getPlatformVersionCode.split("."),i=t.split("."),s=!1;for(let t=0;t<e.length&&!(e[t]>i[t]);t++)e[t]!=i[t]&&(s=!0);return s}showToast(t,e=1500){Laya.Browser.window.wx.showToast({title:t,duration:e})}showShareMenuWithTicket(t){wx.showShareMenu({withShareTicket:t,success:function(){},fail:function(){},complete:function(){}})}regisiterWXShareCallback(){if(Laya.Browser.onWeiXin){var t={title:"分享",image:""};Laya.Browser.window.wx.onShareAppMessage(function(){return console.log("用户点击了转发按钮"),{title:t.title,imageUrl:t.image,query:"share_id=1"}})}}}class L{constructor(){this.tween=new Laya.Tween,this.tweens=[]}getTimeByFrame(t){return Math.round(10*t)}toTween(t,e,i,s,a,o=!0){this.target=t,this.isLocal=o;var n={},r={};if(e.pos){var h=o?t.transform.localPosition.clone():t.transform.position.clone();n.posX=h.x,n.posY=h.y,n.posZ=h.z,r.posX=e.pos.x,r.posY=e.pos.y,r.posZ=e.pos.z}if(e.rot){var l=o?t.transform.localRotationEuler.clone():t.transform.rotationEuler.clone();n.rotX=l.x,n.rotY=l.y,n.rotZ=l.z,r.rotX=e.rot.x,r.rotY=e.rot.y,r.rotZ=e.rot.z}if(e.sca){var c=t.transform.getWorldLossyScale().clone();n.scaX=c.x,n.scaY=c.y,n.scaZ=c.z,r.scaX=e.sca.x,r.scaY=e.sca.y,r.scaZ=e.sca.z}this.tween.to(n,{posX:r.posX,posY:r.posY,posZ:r.posZ,rotX:r.rotX,rotY:r.rotY,rotZ:r.rotZ,scaX:r.scaX,scaY:r.scaY,scaZ:r.scaZ},i,a,Laya.Handler.create(this,()=>{s&&s();var t=this.tweens.shift();t?this.toTween(this.target,t.value,t.time,t.completeFun,a):this.updateTweenCallback&&(this.updateTweenCallback=null)}));var d=0;return this.tween.update=new Laya.Handler(this,()=>{let s=(d+=Laya.timer.delta)/i;s>1&&(s=1),e.pos&&(o?t.transform.localPosition=new Laya.Vector3(n.posX,n.posY,n.posZ):t.transform.position=new Laya.Vector3(n.posX,n.posY,n.posZ)),e.rot&&(o?t.transform.localRotationEuler=new Laya.Vector3(n.rotX,n.rotY,n.rotZ):t.transform.rotationEuler=new Laya.Vector3(n.rotX,n.rotY,n.rotZ)),e.sca&&t.transform.setWorldLossyScale(new Laya.Vector3(n.scaX,n.scaY,n.scaZ)),this.updateTweenCallback&&this.updateTweenCallback(s)}),this}clearTween(t){this.tweens=[],this.tween.clear(),this.target&&t&&(t.pos&&(this.isLocal?this.target.transform.localPosition=new Laya.Vector3(t.pos.x,t.pos.y,t.pos.z):this.target.transform.position=new Laya.Vector3(t.pos.x,t.pos.y,t.pos.z)),t.rot&&(this.target.transform.rotationEuler=new Laya.Vector3(t.rot.x,t.rot.y,t.rot.z)),t.sca&&this.target.transform.setWorldLossyScale(new Laya.Vector3(t.sca.x,t.sca.y,t.sca.z)))}then(t,e,i){return this.tweens.push({value:t,time:e,completeFun:i}),this}}class S{static init(){this.effect=u.prefabs.getChildByName("Effect");for(let t=0;t<this.effect.numChildren;t++){let e=this.effect.getChildAt(t);this.playEffectDestroy(e.name,u.scene3D,1e3)}}static playEffectPositon(t,e,i=1e3){let s=this.effect.getChildByName(t).clone();return u.scene3D.addChild(s),s.transform.position=e,Laya.timer.once(i,this,()=>{s.destroy(!0)}),s}static playEffectDestroy(t,e,i=1e3){let s=this.effect.getChildByName(t).clone();return e.addChild(s),s.transform.localPosition=new Laya.Vector3(0,0,0),s.transform.localRotationEuler=new Laya.Vector3(0,0,0),s.transform.localScale=new Laya.Vector3(1,1,1),Laya.timer.once(i,this,()=>{s.destroy(!0)}),s}static playEffectReturn(t,e){let i=this.effect.getChildByName(t).clone();return e.addChild(i),i.transform.localPosition=new Laya.Vector3(0,0,0),i.transform.localRotationEuler=new Laya.Vector3(0,0,0),i.transform.localScale=new Laya.Vector3(1,1,1),i}}class A{static numberTo(t,e,i){return Math.abs(e-t)<i?t=e:t<e?t+=i:t>e&&(t-=i),t}static randomNumber(t,e){return t+(e-t)*Math.random()}static randomInt(t,e){return Math.floor(t+(e+1-t)*Math.random())}static halfPercent(){return Math.random()<.5}static percent(t){return Math.random()<t}static Vector3Add(t,e){let i=new Laya.Vector3;return Laya.Vector3.add(t,e,i),i}static Vector3Reduce(t,e){let i=new Laya.Vector3,s=A.Vector3Axis(e,-1);return i=this.Vector3Add(t,s)}static Vector2Add(t,e){return new Laya.Vector2(t.x+e.x,t.y+e.y)}static Vector2Reduce(t,e){return new Laya.Vector2(t.x-e.x,t.y-e.y)}static Vector2Scale(t){return Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2))}static getTransformForward(t){let e=new Laya.Vector3;return t.getForward(e),e.x*=-1,e.y*=-1,e.z*=-1,e}static getTransformUp(t){let e=new Laya.Vector3;return t.getUp(e),e}static getTransformRight(t){let e=new Laya.Vector3;return t.getRight(e),e}static Vector3Axis(t,e){let i=t.clone();return i.x*=e,i.y*=e,i.z*=e,i}static setTransRotEulerY(t,e){let i=t.localRotationEuler.clone();i.y=e,t.localRotationEuler=i}static setTransRotEulerX(t,e){let i=t.localRotationEuler.clone();i.x=e,t.localRotationEuler=i}static setTransRotEulerZ(t,e){let i=t.localRotationEuler.clone();i.z=e,t.localRotationEuler=i}static getAngle(t,e){var i=Laya.Vector3.dot(t,e),s=Laya.Vector3.scalarLength(t)*Laya.Vector3.scalarLength(e);if(0==s){if(t.z>e.z)return 0;if(t.z<e.z)return 180;if(t.y>e.y)return 90;if(t.y<e.y)return-90}var a=i/s;return a<-1&&(a=-1),a>1&&(a=1),180*Math.acos(a)/Math.PI}static getProjection(t,e){let i=A.Vector3Axis(e,Laya.Vector3.dot(t,e));return A.Vector3Reduce(t,i)}static cloneArray(t){return[].concat(t)}static getRandomInArray(t){if(t.length){let e=Math.random()*t.length;return t[e=Math.floor(e)]}return console.log("传入错误参数,返回空"),null}static takeRandomInArray(t){if(t.length){let e=Math.random()*t.length,i=t[e=Math.floor(e)];return t.splice(e,1),i}return console.log("传入错误参数,返回空"),null}static randomArray(t){let e=new Array(t.length),i=e.length;for(let s=0;s<i;s++){let i=this.takeRandomInArray(t);e[s]=i}return e}static objectShake(t,e=1,i=.7){var s=e,a=1,o=t.transform.localPosition.clone();Laya.timer.frameLoop(1,this,function updateShake(){if(s>0){var e=new Laya.Vector3;Laya.Vector3.scale((n=Math.random()>.5?Math.random():-Math.random(),r=Math.random()>.5?Math.random():-Math.random(),new Laya.Vector3(n,r,0)),i,e),Laya.Vector3.add(o,e,e),t.transform.localPosition=e,s-=.02*a}else s=0,t.transform.localPosition=o,Laya.timer.clear(this,updateShake);var n,r})}static objectShake_Short(t){}static BoxCheck_2D_Normal(t,e,i,s,a,o,n,r){let h=Math.abs(o-e),l=Math.abs(a-t);return h<(s+r)/2&&l<(i+n)/2}static CircleCheck_2D(t,e,i,s,a,o){let n=Math.pow(t-s,2)+Math.pow(e-a,2),r=Math.pow(i+o,2);return{isHit:n<r,distance:n,range:r}}static gameButtonOn(t,e,i,s){t.offAllCaller(e),t.on(Laya.Event.MOUSE_DOWN,e,i),t.on(Laya.Event.MOUSE_UP,e,s),t.on(Laya.Event.MOUSE_OUT,e,s)}static buttonOffAll(t,e){t&&t.offAllCaller(e)}}class b extends Laya.Script{constructor(){super(...arguments),this.isActive=!0}onEnable(){this.user=this.owner,this.color=this.user.getChildByName("color"),this.black=this.user.getChildByName("black"),this.isPress=!1,this.color.set_visible(!this.isPress),this.black.set_visible(this.isPress),A.gameButtonOn(this.user,this,this.pressReal,this.releaseReal),this.init()}init(){}press(){}release(){}pressReal(){this.isActive&&(this.press(),this.isPress=!0,this.color.set_visible(!this.isPress),this.black.set_visible(this.isPress))}releaseReal(){this.isActive&&(this.release(),this.isPress=!1,this.color.set_visible(!this.isPress),this.black.set_visible(this.isPress))}unActive(t){this.isActive=!1,this.isPress=!1,this.color.set_visible(!1),this.black.set_visible(!0)}goActive(){this.isActive=!0,this.color.set_visible(!0),this.black.set_visible(!1)}}class k extends b{constructor(){super(...arguments),this.cdTime=8}init(){k.instance=this,this.colorMask=this.color.mask,this.color.set_visible(!0),this.black.set_visible(!0)}pressReal(){this.isActive&&(this.press(),this.isPress=!0)}releaseReal(){this.isActive&&(this.release(),this.isPress=!1)}press(){bt.Event.event(r.GameSpeed1On)}release(){bt.Event.event(r.GameSpeed1Off)}unActive(t){this.isActive=!1,this.isPress=!1,this.colorMask.x=-150,this.cdTime=t,this.tween=Laya.Tween.to(this.colorMask,{x:0},t,null,Laya.Handler.create(this,this.goActive))}updateCD(t){let e=1- -this.colorMask.x/150+t/this.cdTime;e<1?(this.tween&&this.tween.clear(),this.colorMask.x=-150*(1-e),bt.ConsoleLog(t,this.cdTime),this.tween=Laya.Tween.to(this.colorMask,{x:0},(1-e)*this.cdTime,null,Laya.Handler.create(this,this.goActive))):this.tween&&this.tween.complete()}goActive(){this.isActive=!0}}class E extends Laya.Script3D{constructor(){super(...arguments),this.lookAheadForTargetOffset=1,this.lookAheadForTargetFactor=.001,this.lookAheadForSpeedOffset=1,this.lookAheadForSpeedFactor=.001,this.isSmoothAlongRoute=!0,this.pointToPointThreshold=4,this.progressDistance=0,this.speedFactor=0,this.progressNum=0,this.lastPosition=new Laya.Vector3,this.speed=0,this.forwardAxis=0}init(t=50){this.speed=0,this.self=this.owner,this.target=this.self.transform,this.reset(0,t)}reset(t=0,e=50){if(this.circuit)if(this.progressNum=t,this.progressDistance=e,this.isSmoothAlongRoute){this.target.position=this.circuit.getRoutePoint(this.progressDistance+this.lookAheadForTargetOffset*this.speedFactor+this.lookAheadForTargetFactor*this.speed).position;let t=new Laya.Quaternion,e=this.circuit.getRoutePoint(this.progressDistance+this.lookAheadForSpeedOffset+this.lookAheadForSpeedFactor*this.speed).direction,i=this.circuit.getUpDirection(this.progressDistance+this.lookAheadForSpeedOffset+this.lookAheadForSpeedFactor*this.speed);Laya.Quaternion.rotationLookAt(e,i,t),Laya.Quaternion.invert(t,t),this.target.rotation=t,this.lastPosition=this.target.position.clone()}else;}onTrackerUpdate(){if(null!=this.circuit&&0!=this.speedFactor)if(this.progressDistance>=this.circuit.accumulateDistance-.5)console.log("到达终点");else if(null!=this.self&&this.isSmoothAlongRoute){let e=.02;if(e>0){let t=new Laya.Vector3;Laya.Vector3.subtract(this.lastPosition,this.self.transform.position.clone(),t);let i=Laya.Vector3.scalarLength(t);this.speed=Laya.MathUtil.lerp(this.speed,i/e,e)}this.forwardAxis=this.lookAheadForTargetOffset*this.speedFactor+this.lookAheadForTargetFactor*this.speed;let i=this.forwardAxis;this.target.position=this.circuit.getRoutePoint(this.progressDistance+i).position;let s=new Laya.Quaternion,a=25*this.speedFactor;a<0&&(a=0);let o=this.circuit.getRoutePoint(this.progressDistance+this.lookAheadForSpeedOffset+this.lookAheadForSpeedFactor*this.speed).direction,n=this.circuit.getUpDirection(this.progressDistance+this.lookAheadForSpeedOffset+this.lookAheadForSpeedFactor*this.speed);Laya.Quaternion.rotationLookAt(o,n,s),Laya.Quaternion.invert(s,s),Laya.Quaternion.lerp(this.target.rotation,s,.2,s),this.target.rotation=s,this.progressPoint=this.circuit.getRoutePoint(this.progressDistance);var t=this.circuit.v3Subtract(this.progressPoint.position,this.self.transform.position);Laya.Vector3.dot(t,this.progressPoint.direction)>0?this.progressDistance+=.5*Laya.Vector3.scalarLength(t):this.progressDistance>10&&(this.progressDistance-=.5*Laya.Vector3.scalarLength(t)),this.lastPosition=this.self.transform.position.clone()}}v3Subtract(t,e){var i=new Laya.Vector3;return Laya.Vector3.subtract(t,e,i),i}getNextDistance(t){let e=this.progressDistance,i=this.lookAheadForTargetOffset*t+this.lookAheadForTargetFactor*this.speed,s=this.circuit.getRoutePoint(e+i).position,a=this.circuit.getRoutePoint(e),o=this.circuit.v3Subtract(a.position,s);return Laya.Vector3.dot(o,a.direction)>0?e+=.5*Laya.Vector3.scalarLength(o):e>10&&(e-=.5*Laya.Vector3.scalarLength(o)),e}getHorizontalOffset(t){if(t<0)return 0;t*=15;var e=this.circuit.getRountePosition(this.progressDistance),i=this.circuit.getRountePosition(this.progressDistance+.1),s=this.circuit.getRountePosition(this.progressDistance+.1+t);e.y=0,i.y=0,s.y=0;let a=this.v3Subtract(e,i),o=this.v3Subtract(e,s),n=new Laya.Vector3(0,1,0),r=A.getAngle(a,o),h=new Laya.Vector3;return Laya.Vector3.cross(a,o,h),A.getAngle(n,h)>90&&(r*=-1),r}getRotation(t){t*=15,t+=5;var e=this.circuit.getRountePosition(this.progressDistance),i=this.circuit.getRountePosition(this.progressDistance+t),s=this.circuit.getRountePosition(this.progressDistance+5);let a=this.v3Subtract(e,i),o=this.v3Subtract(e,s),n=A.getTransformUp(this.target),r=this.getProjection(a,n),h=A.getTransformForward(this.target),l=A.getAngle(r,h);return l<3&&l>90?o:a}getProjection(t,e){let i=A.Vector3Axis(e,Laya.Vector3.dot(t,e));return A.Vector3Reduce(t,i)}}class x extends Laya.Script3D{constructor(){super(...arguments),this.playerId=0,this.wheels=[],this.skinId=1,this.isEnding=!1,this.addMaxSpeed=.05,this.reduceMaxSpeed=-.1,this.maxSpeed=7,this.minSpeed=1,this.turnSpeed=.9,this.turnMaxSpeed=2,this.horizontal=0,this.speed=0,this.isStart=!1,this.targetSpeed=0,this.targetAxisSpeed=0,this.axisSpeed=0,this.nowOffset=0,this.targetOffset=0,this.isControl=!0,this.frameAxis=1,this.controlTrunOffset=0,this.carAddAxis=u.carBaseAddSpeed,this.backCD=60,this.canPlayHitSound=!0,this.hitSoundCD=200,this.hitCD=300,this.isFlying=!1,this.emojiCan=!0}init(t,e=50,i=0,s=1){this.user=this.owner;let a=this.user.getComponent(E);a&&a.destroy();let o=this.user.addComponent(E);o.circuit=t,o.init(e),this.circuit=t,this.tracker=o;let n=this.user.getChildByName("ModelCar");this.modelCar=n,this.modelRobot=this.user.getChildByName("ModelRobot"),n.active=!0,this.modelRobot.active=!0;this.skinId=s;let r="Model"+s.toString(),h=u.prefabs.getChildByName("Machine").getChildByName(r);this.model=h.clone(),this.modelRobot.addChild(this.model),this.model.transform.localPosition=new Laya.Vector3(0,0,0),this.model.transform.localRotationEuler=new Laya.Vector3,this.model.transform.localScale=new Laya.Vector3(1,1,1);let l=u.prefabs.getChildByName("Car").getChildByName(r);this.model=l.clone(),n.addChild(this.model),this.model.transform.localPosition=new Laya.Vector3,this.model.transform.localRotationEuler=new Laya.Vector3,this.model.transform.localScale=new Laya.Vector3(100,100,100),this.carHitEffect=this.model.getChildByName("CarHit"),this.carPushEffect=this.model.getChildByName("PushEffect");for(let t=0;t<4;t++){let e=this.model.getChildAt(t);this.wheels.push(e),bt.ConsoleLog(e.name)}this.horizontal=i,this.model.transform.localPosition=new Laya.Vector3(-this.horizontal,0,0),this.isControl=!0,this.isStart=!1,A.setTransRotEulerY(this.model.transform,0);let c=this.modelRobot.getChildByName("Model"+s.toString()),d=c.getChildByName("Effect").getChildByName("BornEffect"),p=c.getChildByName("main");this.modelRobot.transform.localScale=new Laya.Vector3(1,1,1),n.transform.localScale=new Laya.Vector3(1,1,1),p.transform.localScale=new Laya.Vector3(250,250,250),p.transform.position=this.model.transform.position.clone(),this.model.transform.localScale=new Laya.Vector3(0,0,0),Laya.timer.once(1e3,this,()=>{S.playEffectDestroy("BornEffect",d,1e3),p.transform.localScale=new Laya.Vector3(0,0,0),this.model.transform.localScale=new Laya.Vector3(100,100,100),Laya.timer.once(1e3,this,()=>{p.transform.localScale=new Laya.Vector3(300,300,300),p.transform.localPosition=new Laya.Vector3,this.modelRobot.transform.localScale=new Laya.Vector3(0,0,0)})}),this.specialInit()}gameEnd(){this.controlComp={axis:1,horizontal:0},this.isEnding=!0,this.colliderComp.active=!1,this.colliderComp.destroy(),this.CarStart(),this.gameSpecialEnd()}CarStart(){mt.endPos;this.car_startPos=this.tracker.progressDistance,this.maxSpeed=5,this.tracker.speedFactor=5,Laya.timer.frameLoop(1,this,this.CarUpdate),this.CarStartSpecial()}CarUpdate(){let t=(this.tracker.progressDistance-this.car_startPos)/500,e=2*t,i=108*-(Math.pow(e-1,2)-1),s=this.modelCar.transform.localPosition.clone();s.y=i,this.modelCar.transform.localPosition=s,A.setTransRotEulerX(this.modelCar.transform,-45*(.5-t)),this.maxSpeed=5,this.tracker.speedFactor=5,t>=1&&this.CarEnd()}CarEnd(){Laya.timer.clear(this,this.CarUpdate),this.colliderComp=null,this.tracker.destroy(),this.circuit.destroy(),this.CarSpecialChange(),this.destroy(),this.modelCar.transform.localPosition=new Laya.Vector3,this.modelCar.transform.localRotationEuler=new Laya.Vector3,this.model.destroy()}specialInit(){}getControlComp(){}getColliderComp(){}specialUpdate(){}CarSpecialChange(){}gameSpecialEnd(){}HitSpecial(){}reset(){}CarStartSpecial(){}onUpdate(){let t=this.controlComp;if(!t)return;let e=this.tracker;this.frameAxis=Laya.timer.delta/16;let i=this.frameAxis;if(e.speedFactor>=this.minSpeed&&(this.isStart=!0),this.isControl){let e;this.targetSpeed+=t.horizontal*i*.066,this.targetSpeed>this.turnSpeed?this.targetSpeed=this.turnSpeed:this.targetSpeed<-this.turnSpeed&&(this.targetSpeed=-this.turnSpeed),e=this.isStart?t.axis:1,this.targetAxisSpeed+=e*i*this.carAddAxis;let s=this.addMaxSpeed*this.carAddAxis/u.carBaseAddSpeed;if(this.targetAxisSpeed>s?this.targetAxisSpeed=s:this.targetAxisSpeed<this.reduceMaxSpeed&&(this.targetAxisSpeed=this.reduceMaxSpeed),0==t.horizontal){let t=1*i;this.targetSpeed>t?this.targetSpeed-=t:this.targetSpeed<-t?this.targetSpeed+=t:this.targetSpeed=0}if(0==e){let t,e=-.05;t=this.isControl?.05*i:.1*i,this.targetAxisSpeed>e+t?this.targetAxisSpeed-=t:this.targetAxisSpeed<e-t?this.targetAxisSpeed+=t:this.targetAxisSpeed=e}}let s=this.targetAxisSpeed-this.axisSpeed;this.axisSpeed+=.24*s*i;let a=e.speedFactor;(a+=this.axisSpeed*i*.25)>this.maxSpeed&&(a=this.maxSpeed),this.isControl?this.isStart?a<this.minSpeed&&(a=this.minSpeed):a<0&&(a=0):a<-1&&(a=-1),this.speed=this.targetSpeed;let o=a,n=this.speed;this.tracker.speedFactor=o,this.tracker.onTrackerUpdate(),this.horizontal+=.08*n*this.frameAxis,this.horizontal>6&&(this.horizontal=6),this.horizontal<-6&&(this.horizontal=-6);let r=this.model.transform.localPosition.clone();r.x=-this.horizontal,this.model.transform.localPosition=r;let h=this.tracker.getHorizontalOffset(this.tracker.forwardAxis);this.controlTrunOffset+=.6*this.controlComp.horizontal*i,0==this.controlComp.horizontal&&(this.controlTrunOffset=A.numberTo(this.controlTrunOffset,0,.52*i));this.controlTrunOffset>5?this.controlTrunOffset=5:this.controlTrunOffset<-5&&(this.controlTrunOffset=-5),this.targetOffset=-this.controlTrunOffset+.15*h,this.nowOffset=this.model.transform.localRotationEuler.y,this.nowOffset=this.targetOffset,A.setTransRotEulerY(this.model.transform,this.nowOffset);let l=this.tracker.forwardAxis;for(let t=0;t<this.wheels.length;t++){let e=this.wheels[t].transform.localRotationEulerX;A.setTransRotEulerX(this.wheels[t].transform,e+5*l)}for(let t=2;t<this.wheels.length;t++){let e=this.nowOffset;A.setTransRotEulerY(this.wheels[t].transform,2*e)}if(!this.isEnding){if(this.tracker.progressDistance>=this.circuit.accumulateDistance-1e3)return void this.gameEnd()}this.specialUpdate()}getNextHorizontal(t){let e=this.horizontal+.1*t*this.frameAxis;return e>6&&(e=6),e<-6&&(e=-6),e}onLateUpdate(){}HitStart(t,e){if(!this.controlComp)return;if(!this.isControl)return;this.HitEnd();let i=0;if(t.isAxisHit&&!t.isHorizontalHit)i=1;else if(!t.isAxisHit&&t.isHorizontalHit)i=2;else if(t.isAxisHit&&t.isHorizontalHit){i=e.carComp.tracker.progressDistance-this.tracker.progressDistance>e.carComp.horizontal-this.horizontal?2:1}if(1==i){let t=this.tracker.speedFactor+e.carComp.tracker.speedFactor;this.tracker.speedFactor=.4*t,e.carComp.tracker.speedFactor=.6*t,this.hitTarget=e.carComp;let i=this.hitTarget.playerId;mt.hpValues[i]>u.minCarHp&&mt.reduceHpValue(i,u.carHitReduceHp),bt.ConsoleLog("撞击扣血",i,u.minCarHp,mt.hpValues[i]),this.hitTarget.HitTurnRed()}else if(2==i){let t=e.carComp.horizontal-this.horizontal;this.hitTarget=e.carComp;let i=u.carHitHorizontal;t>0?(this.targetSpeed=-i,this.hitTarget.targetSpeed=i):(this.targetSpeed=i,this.hitTarget.targetSpeed=-i)}if(0!=i){Laya.timer.once(this.backCD,this,this.HitEnd),this.isControl=!1,this.hitTarget.isControl=!1,this.hitEvent=t;let e=A.Vector3Reduce(u.player.transform.position,this.user.transform.position);Laya.Vector3.scalarLength(e)<50&&this.canPlayHitSound&&(u.sound.play(a.CarHit),this.canPlayHitSound=!1,Laya.timer.once(this.hitSoundCD,this,()=>{this.canPlayHitSound=!0})),0==this.playerId&&bt.Platform.vibrateShort(),0==this.hitTarget.playerId&&bt.Platform.vibrateShort(),1==i&&this.HitSpecial()}}HitEnd(){Laya.timer.clear(this,this.HitEnd),this.isControl=!0,this.hitTarget&&(this.hitTarget.isControl=!0,this.hitTarget=null)}HitTurnRed(){this.redTween&&this.redTween.clearTween(),this.redTween=new L;let t=this.model,e=t.meshRenderer.material.clone();e.albedoColorR=1,e.albedoColorG=.5,e.albedoColorB=.5,t.meshRenderer.material=e,this.redTween.updateTweenCallback=(e=>{let i=t.meshRenderer.material.clone();e>=.3&&(i.albedoColorR=1,i.albedoColorG=.5+(e-.3)/.7*.5,i.albedoColorB=.5+(e-.3)/.7*.5),t.meshRenderer.material=i}),this.redTween.toTween(t,{},250,()=>{let e=t.meshRenderer.material.clone();e.albedoColorR=1,e.albedoColorG=1,e.albedoColorB=1,t.meshRenderer.material=e},null)}HitFly(t,e){if(this.isEnding)return;let i=0;if(t.isAxisHit&&!t.isHorizontalHit)i=1;else if(!t.isAxisHit&&t.isHorizontalHit)i=1;else if(t.isAxisHit&&t.isHorizontalHit){let t=e.carComp.tracker.progressDistance-this.tracker.progressDistance;e.carComp.horizontal,this.horizontal;t>0&&(i=2)}if(!this.isFlying&&0!=i)if(2!=i){if(this.isFlying=!0,e){let t=e.carComp.model.transform.position.clone(),i=150*(e.carComp.tracker.speedFactor-1)+30,s=this.model.transform.position.clone(),o=new Laya.Vector3;Laya.Vector3.subtract(s,t,o),Laya.Vector3.scale(o,i,o),o.y+=i,Laya.Vector3.add(o,s,o);let n=this.model.transform.rotationEuler.clone(),r=50*Math.random()*i+100,h=10*Math.random()*i+100;n.x+=r,n.z=t.x>s.x?n.z+h:n.z-h,this.controlComp=null;let l=new L;l.toTween(this.model,{pos:o,rot:n},50*i,null,null,!1),Laya.timer.once(this.hitCD,this,()=>{l.clearTween(),this.HitFlyEnd()}),0==e.carComp.playerId&&(bt.Platform.vibrateShort(),k.instance.updateCD(500));let c=A.Vector3Reduce(u.player.transform.position,this.user.transform.position);Laya.Vector3.scalarLength(c)<50&&this.canPlayHitSound&&(u.sound.play(a.CarHit),this.canPlayHitSound=!1,Laya.timer.once(this.hitSoundCD,this,()=>{this.canPlayHitSound=!0}))}}else this.HitFlyEnd()}HitFlyEnd(){if(this.car&&(this.car.active=!1),this.model){S.playEffectPositon("Expolsion",this.model.transform.position.clone(),1e3);let t=A.Vector3Reduce(u.player.transform.position,this.user.transform.position);Laya.Vector3.scalarLength(t)<50&&u.sound.play(a.Boom)}this.HitFlyEndSpecial(),this.isFlying=!1}HitFlyEndSpecial(){}emojiPlay(t){if(!this.emojiCan)return;let e=this.model.getChildByName("EmojiEffect");e&&S.playEffectDestroy(t,e,3e3),this.emojiCan=!1,Laya.timer.once(3e3,this,()=>{this.emojiCan=!0})}}!function(t){t.Cool="EmojiCool",t.Cry="EmojiCry",t.LaughCry="EmojiLaughCry"}(h||(h={}));class P extends Laya.Script3D{constructor(){super(...arguments),this.playerId=0,this.isEnd=!0,this.isInvincible=!1,this.camAngle=0,this.skinId=1,this.isGotWeapon=!1,this.nowHero=1,this.attackCombe=0,this.atttackTime=[700,367,367],this.attackDoTime=[400,100,100],this.attackRange=[8,8,8],this.attackEffect=[],this.combeLostTime=1500,this.combeHurtLostTime=1500,this.hurtCombe=0,this.isHurting=!1,this.hurtTime=200,this.hp=20,this.isAttackUp=!1,this.isDowning=!1,this.downTime=2500,this.moveSpeed=1,this.nowAngle=0,this.isHitting=!1,this.backX=0,this.backZ=0,this.nowBackCount=0,this.backCount=5,this.hitBackAxis=1}onEnable(){this.initEvent()}onDisable(){this.colliderComp&&this.colliderComp.destroy(),this.offEvent()}initEvent(){}offEvent(){}init(t=1){bt.Event.on(s.Over_Game_Event,this,()=>{this.attackUpEffect&&this.attackUpEffect.destroy(),this.controlComp=null}),this.player=this.owner,this.player.getChildByName("ModelCar").active=!1,this.modelRobot=this.player.getChildByName("ModelRobot"),this.modelRobot.active=!0,this.modelRobot.transform.localScale=new Laya.Vector3(1,1,1),this.skinId=t;this.skinId;let e="Model"+t.toString();this.model=this.modelRobot.getChildByName(e),this.anim=this.model.getComponent(Laya.Animator),this.effect=this.model.getChildByName("Effect"),A.setTransRotEulerY(this.model.transform,0);let i=this.player.transform.position.clone();i.x=A.randomNumber(-6,6),this.player.transform.position=i,this.attackPoint=this.modelRobot.getChildByName("AttackPoint"),this.getColliderComp(),this.getControlComp(),this.isEnd=!1,this.camAngle=0,this.isHitting=!1,this.goMove(),this.stopAttack(),this.attackEffect=[];let a=this.effect.getChildByName("SwordEffect1"),o=this.effect.getChildByName("SwordEffect2"),n=this.effect.getChildByName("SwordEffect3");this.attackEffect.push(a),this.attackEffect.push(o),this.attackEffect.push(n);let r=this.effect.getChildByName("BornEffect");S.playEffectDestroy("BornEffect",r,1e3),this.hp=mt.hpValues[this.playerId],this.specialInit()}getWeapon(t){this.isGotWeapon=!0;let e=f.d3_FindNodeByName(this.model,"Weapon"),i="Weapon"+t.toString(),s=u.prefabs.getChildByName("Weapon").getChildByName(i).clone();e.addChild(s),s.transform.localPosition=new Laya.Vector3,s.transform.localRotationEuler=new Laya.Vector3,s.transform.localScale=new Laya.Vector3(1,1,1),this.getWeaponSpecial()}getWeaponSpecial(){}specialInit(){}getControlComp(){this.controlComp={xAxis:0,yAxis:0}}getColliderComp(){}onUpdate(){this.isEnd?this.attackUpEffect&&this.attackUpEffect.destroy():this.controlComp&&(this.isHitting&&this.HitDoing(),this.isDowning||this.isHurting||this.isAttack||this.isMove&&this.MoveControl())}onDestroy(){this.model.destroy()}goAttackSpecial(){}goAttack(){if(!this.isGotWeapon)return;if(mt.isEnd)return;if(this.isEnd)return;if(!this.isMove)return;if(this.isAttack)return;if(this.isDowning)return;this.goAttackSpecial(),this.isAttack=!0,this.stopMove();let t="attack_"+(this.attackCombe+1).toString();this.anim.play(t,0,0),Laya.timer.once(this.attackDoTime[this.attackCombe],this,this.attackDo),Laya.timer.once(this.atttackTime[this.attackCombe],this,this.stopAttack),this.startCombe(),mt.isPlayerCar||u.sound.play(a.PlayerSwordAttack)}attackDo(){let t=this.attackCombe-1;t<0&&(t=2);S.playEffectDestroy("SwordEffect",this.attackEffect[t]);this.attackDoSpecial()}attackDoSpecial(){}stopAttack(){this.isEnd||(Laya.timer.clear(this,this.attackDo),Laya.timer.clear(this,this.stopAttack),this.isAttack=!1,this.goMove())}startCombe(){this.isEnd||(Laya.timer.clear(this,this.stopCombe),this.attackCombe++,this.attackCombe>2?this.stopCombe():Laya.timer.once(this.combeLostTime,this,this.stopCombe))}stopCombe(){this.isEnd||(Laya.timer.clear(this,this.stopCombe),this.attackCombe=0)}startCombeHurt(){this.isEnd||(Laya.timer.clear(this,this.stopCombeHurt),this.hurtCombe++,this.hurtCombe>4?this.stopCombeHurt():Laya.timer.once(this.combeHurtLostTime,this,this.stopCombeHurt))}stopCombeHurt(){this.isEnd||(Laya.timer.clear(this,this.stopCombeHurt),this.hurtCombe=0)}goHurt(t=1,e=!1){if(this.isEnd)return!1;if(!e){if(this.isDowning)return!1;if(this.isHurting)return!1;if(this.isInvincible){this.hurtSpecial();let t=this.effect.getChildByName("EffectHit");return S.playEffectDestroy("EffectHit",t),A.objectShake(this.player,.1,.05),0!=this.hurtTime&&(this.isHurting=!0,Laya.timer.once(this.hurtTime,this,this.stopHurt)),!1}}if(this.stopHurt(),this.stopDown(),0!=this.hurtTime&&(this.stopAttack(),this.stopCombe(),this.stopMove()),this.hurtCombe>=4)this.goDown();else{let t=this.effect.getChildByName("EffectHit");S.playEffectDestroy("EffectHit",t),0!=this.hurtTime&&(this.anim.play("littlehit",0,0),this.isHurting=!0,Laya.timer.once(this.hurtTime,this,this.stopHurt))}return 0!=this.hurtTime&&this.startCombeHurt(),this.hp=mt.hpValues[this.playerId],t=Math.floor(t),this.hp-=t,bt.ConsoleLog("扣血",t),this.hp<=0&&this.goEnd(),mt.reduceHpValue(this.playerId,t),this.hurtSpecial(),!0}hurtSpecial(){}stopHurt(){this.isEnd||(Laya.timer.clear(this,this.stopHurt),this.isHurting=!1,this.isInvincible||this.goMove())}heal(){bt.ConsoleLog("治疗",this.playerId);let t=Math.floor(mt.maxHpValues[this.playerId]/3);mt.addHpValue(this.playerId,t)}attackUp(){let t=this.model.getChildByName("Effect").getChildByName("AttackEffect");this.attackUpEffect=S.playEffectReturn("AttackEffect",t),this.attack*=2}goDown(){this.isEnd||(this.stopCombeHurt(),this.stopDown(),this.stopCombe(),this.stopHurt(),this.stopAttack(),this.stopMove(),this.goDownSpecial(),this.isDowning=!0,this.anim.play("down",0,0),Laya.timer.once(this.downTime,this,this.stopDown))}goDownSpecial(){}stopDown(){this.isEnd||(Laya.timer.clear(this,this.stopDown),this.isDowning=!1,this.goMove())}stopMove(){this.isEnd||(this.isMove=!1,this.anim.getControllerLayer(1).defaultWeight=0)}goMove(){this.isEnd||(this.isMove=!0,this.isAttack||this.anim.crossFade("idle",0,0))}goEnd(){this.stopMove(),this.stopAttack(),this.stopCombe(),this.stopHurt(),this.stopCombeHurt(),this.anim.play("dead",0,0),this.isEnd=!0,this.specialEnd()}specialEnd(){}MoveControl(){let t=new Laya.Vector3(-0,0,0),e=Laya.Vector3.scalarLength(t);e>1&&(e=1),this.Move(0,e)}Move(t,e){A.setTransRotEulerY(this.model.transform,-t);let i=t*Math.PI/180,s=new Laya.Vector3(Math.sin(i),0,-Math.cos(i)),a=this.player.transform.position.clone(),o=Laya.timer.delta/16;a=A.Vector3Add(a,A.Vector3Axis(s,.33*this.moveSpeed*e*o)),this.isAttack||(this.anim.getControllerLayer(1).defaultWeight=e),this.player.transform.position=a}CamRot(t){this.camAngle=t}HitBack(t,e,i=1){if(this.isHitting)return;this.isHitting=!0;let s=this.colliderComp.axis,a=this.colliderComp.horizontal;this.nowBackCount=0;let o=new Laya.Vector2(s-t,a-e);Laya.Vector2.normalize(o,o),this.backZ=o.x*i*.2/this.backCount*this.hitBackAxis,this.backX=o.y*i*.2/this.backCount*this.hitBackAxis}HitDoing(){let t=this.player.transform.position.clone(),e=new Laya.Vector3(this.backX,0,this.backZ);this.player.transform.position=A.Vector3Add(t,e),this.nowBackCount++,this.nowBackCount>=this.backCount&&this.HitEnd()}HitEnd(){this.isHitting=!1,this.nowBackCount=0,this.backZ=0,this.backX=0}}class _ extends Laya.Script3D{constructor(){super(...arguments),this.axis=0,this.horizontal=0,this.radius=3}onEnable(){this.user=this.owner,this.machine=this.user.getComponent(P),this.init()}onDisable(){}init(){this.axis=this.user.transform.position.z,this.horizontal=this.user.transform.position.x}onLateUpdate(){this.axis=this.user.transform.position.z,this.horizontal=this.user.transform.position.x,this.machineHitCheck(),this.blcokHitCheck(),this.pickHitCheck()}machineHitCheck(){}blcokHitCheck(){let t=mt.stageRobot.getChildByName("Station_1").transform.position.clone();t.y=0;let e=30-this.radius,i=this.user.transform.position.clone(),s=A.Vector3Reduce(i,t);if(Laya.Vector3.scalarLength(s)>e){let i=new Laya.Vector3;Laya.Vector3.normalize(s,i);let a=A.Vector3Axis(i,e),o=A.Vector3Add(t,a);this.user.transform.position=o}}pickHitCheck(){let t=mt.pickItems;for(let e=0;e<t.length;e++)if(t[e].active){let i=t[e].transform.position.z,s=t[e].transform.position.x,a=2;A.CircleCheck_2D(i,s,a,this.axis,this.horizontal,this.radius).isHit&&(t[e].active=!1,bt.ConsoleLog("拾取道具",e+1),1==e&&this.machine.heal(),0==e&&this.machine.attackUp())}if(this.machine.isGotWeapon)return;let e=mt.pickWeapons;for(let t=0;t<e.length;t++)if(e[t].active){let i=e[t].transform.position.z,s=e[t].transform.position.x,a=2;if(A.CircleCheck_2D(i,s,a,this.axis,this.horizontal,this.radius).isHit){e[t].active=!1,this.machine.getWeapon(t+1);break}}}}class I extends _{init(){I.player=this}machineHitCheck(){let t=[];t=D.objs;for(let e=0;e<t.length;e++){let i=A.CircleCheck_2D(this.axis,this.horizontal,this.radius,t[e].axis,t[e].horizontal,t[e].radius);if(i.isHit)return void this.machine.HitBack(t[e].axis,t[e].horizontal,i.range-i.distance)}}}class D extends _{init(){D.objs||(D.objs=[]),D.objs.push(this),this.aiId=D.objs.length-1}machineHitCheck(){let t=[];for(let e=0;e<D.objs.length;e++)e!=this.aiId&&t.push(D.objs[e]);I.player&&t.push(I.player);for(let e=0;e<t.length;e++){let i=A.CircleCheck_2D(this.axis,this.horizontal,this.radius,t[e].axis,t[e].horizontal,t[e].radius);if(i.isHit)return void(this.machine.isDowning&&(this.machine.isHitting?t[e].machine.HitBack(this.axis,this.horizontal,i.range-i.distance):this.machine.HitBack(t[e].axis,t[e].horizontal,i.range-i.distance)))}}}class V extends Laya.Script3D{constructor(){super(...arguments),this.attackCD=100,this.isAttack=!0}onEnable(){this.machineComp=this.owner.getComponent(B),this.hitComp=this.owner.getComponent(_),this.attackCD=u.AIAttackInterval[(bt.Storage.storageData.level-1)%u.AIAttackInterval.length]}onDisable(){Laya.timer.clearAll(this)}onUpdate(){if(this.machineComp.isEnd)return;let t=this.search();t||(this.target=null);let e=this.target;if(e){let i=new Laya.Vector3(e.horizontal-this.hitComp.horizontal,0,e.axis-this.hitComp.axis),s=0;if(t.isHit){if(s=0,this.isAttack){let t=[],e=u.AIAttackWeight;for(let i=0;i<e;i++)t.push("goAttack");this.machineComp.isCanSkill1&&t.push("skill1On"),this.machineComp.isCanSkill2&&t.push("skill2On");let i=t[A.randomInt(0,t.length-1)];this.machineComp[i](),this.isAttack=!1,Laya.timer.once(this.attackCD,this,()=>{this.isAttack=!0})}}else s=t.distance-t.range;let a=new Laya.Vector3;Laya.Vector3.normalize(i,a),this.machineComp.way=A.Vector3Axis(a,s)}}search(){let t,e=[],i=u.AIgoHealHpPrecent,s=!1,a=!1;if(mt.pickItems[0].active&&(s=!0),mt.hpValues[this.machineComp.playerId]/mt.maxHpValues[this.machineComp.playerId]<i&&mt.pickItems[1].active&&(a=!0),s&&this.machineComp.isGotWeapon){let t={axis:mt.pickItems[0].transform.position.z,horizontal:mt.pickItems[0].transform.position.x,radius:2};e.push(t)}if(this.machineComp.isGotWeapon)if(a){let t={axis:mt.pickItems[1].transform.position.z,horizontal:mt.pickItems[1].transform.position.x,radius:2};e.push(t)}else{for(let t=0;t<D.objs.length;t++)t!=this.hitComp.aiId&&(D.objs[t].machine.isDowning||D.objs[t].machine.isEnd||e.push(D.objs[t]));I.player&&(I.player.machine.isDowning||I.player.machine.isEnd||e.push(I.player))}else for(let t=0;t<mt.pickWeapons.length;t++){let i=mt.pickWeapons[t];if(!i.active)continue;let s={axis:i.transform.position.z,horizontal:i.transform.position.x,radius:2};e.push(s)}let o=1e4;for(let i=0;i<e.length;i++){bt.ConsoleLog(e[i].radius,this.hitComp.radius);let s=A.CircleCheck_2D(e[i].axis,e[i].horizontal,e[i].radius,this.hitComp.axis,this.hitComp.horizontal,this.hitComp.radius);o>s.distance&&(o=s.distance,t=s,this.target=e[i])}return t}}class B extends P{constructor(){super(...arguments),this.moveSpeed=.75,this.way=new Laya.Vector3(0,0,0),this.skill1Range=8,this.skill1Time=2500,this.skill1CD=6e3,this.isCanSkill1=!0,this.skill2Range=8,this.skill2DoTime=200,this.skill2Time=600,this.skill2CD=6e3,this.isCanSkill2=!0}initEvent(){}offEvent(){}specialEnd(){this.skill1Effect&&this.skill1Effect.destroy(),Laya.timer.clear(this,this.skill1Off),Laya.timer.clear(this,this.skill1Update),this.isAttack=!1,this.isInvincible=!1,Laya.timer.clear(this,this.skill1Update),bt.Event.event(r.GameAIDead)}specialInit(){this.skill2Effect=this.effect.getChildByName("BoomEffect"),this.attack=u.AIAttack[(bt.Storage.storageData.level-1)%u.AIAttack.length],this.skill1CD=u.AISkill1CD[(bt.Storage.storageData.level-1)%u.AISkill1CD.length],this.skill2CD=u.AISkill2CD[(bt.Storage.storageData.level-1)%u.AISkill2CD.length]}goDownSpecial(){bt.ConsoleLog("AI倒下！！"),this.skill1Off()}getControlComp(){this.controlComp=this.player.addComponent(V)}getColliderComp(){this.colliderComp=this.player.addComponent(D)}MoveControl(){let t,e=this.way;if(0==e.x&&0==e.z)return void(this.anim.getControllerLayer(1).defaultWeight=0);if(-1==e.z&&0==e.x)t=0;else if(1==e.z&&0==e.x)t=180;else{t=180*Math.atan2(e.x,-e.z)/Math.PI}let i=t,s=Laya.Vector3.scalarLength(e);s>1&&(s=1),this.Move(i,s)}hurtSpecial(){mt.isPlayerCar||u.sound.play(a.PlayerSwordHit)}goAttackSpecial(){let t=this.controlComp.target;if(t){let e=new Laya.Vector3(t.horizontal-this.colliderComp.horizontal,0,t.axis-this.colliderComp.axis);this.getWayAngle(e)}}getWayAngle(t){if(0==t.x&&0==t.z)return void(this.anim.getControllerLayer(1).defaultWeight=0);let e;if(-1==t.z&&0==t.x)e=0;else if(1==t.z&&0==t.x)e=180;else{e=180*Math.atan2(t.x,-t.z)/Math.PI}let i=e;A.setTransRotEulerY(this.model.transform,-i)}attackDoSpecial(){let t=D.objs,e=this.colliderComp.aiId,i=[];for(let s=0;s<t.length;s++)s!=e&&t[s]&&i.push(t[s]);I.player&&i.push(I.player);let s=this.attackCombe,a=this.attackRange[s];for(let t=0;t<i.length;t++){let e=i[t].machine;if(A.CircleCheck_2D(this.colliderComp.axis,this.colliderComp.horizontal,a,i[t].axis,i[t].horizontal,i[t].radius).isHit){let t=A.Vector3Reduce(e.player.transform.position.clone(),this.player.transform.position.clone()),i=A.getTransformForward(this.model.transform);if(A.getAngle(t,i)<90){let t=A.randomNumber(.8,1.2),i=Math.floor(this.attack*t);e.goHurt(i)}}}}skill1On(){if(!this.isGotWeapon)return;if(mt.isEnd)return;if(this.isEnd)return;if(!this.isMove)return;if(this.isAttack)return;if(this.isDowning)return;this.isAttack=!0,this.isInvincible=!0;this.anim.play("swordSkill",0,0),Laya.timer.frameLoop(1,this,this.skill1Update),Laya.timer.once(this.skill1Time,this,this.skill1Off),this.isCanSkill1=!1,setTimeout(()=>{this.isCanSkill1=!0},this.skill1CD);let t=this.effect.getChildByName("SwordSpinEffect");this.skill1Effect=S.playEffectReturn("SwordSpinEffect",t),this.anim.getControllerLayer(1).defaultWeight=0,mt.isPlayerCar||u.sound.play(a.SwordSkill)}skill1Update(){this.MoveControl(),this.skill1Do()}skill1Do(){let t=[];for(let e=0;e<D.objs.length;e++)e!=this.colliderComp.aiId&&t.push(D.objs[e]);I.player&&t.push(I.player);for(let e=0;e<t.length;e++){let i=t[e].machine;if(A.CircleCheck_2D(this.colliderComp.axis,this.colliderComp.horizontal,6,t[e].axis,t[e].horizontal,t[e].radius).isHit){let t=A.randomNumber(.8,1.2),e=Math.floor(this.attack*t);i.goHurt(e)}}}skill1Off(){this.isEnd||(this.anim.play("idle",0,0),this.skill1Effect&&this.skill1Effect.destroy(),Laya.timer.clear(this,this.skill1Off),Laya.timer.clear(this,this.skill1Update),this.isAttack=!1,this.isInvincible=!1,bt.ConsoleLog("技能1关闭"))}skill2On(){if(mt.isEnd)return;if(this.isEnd)return;if(!this.isMove)return;if(this.isAttack)return;if(this.isDowning)return;this.isAttack=!0,this.isInvincible=!0,this.stopMove();this.anim.play("shout",0,0),Laya.timer.once(this.skill2DoTime,this,this.skill2Do),this.isCanSkill2=!1,Laya.timer.once(this.skill2Time,this,this.skill2Off),setTimeout(()=>{this.isCanSkill2=!0},this.skill2CD),mt.isPlayerCar||u.sound.play(a.Shout)}skill2Do(){let t=[];for(let e=0;e<D.objs.length;e++)e!=this.colliderComp.aiId&&t.push(D.objs[e]);I.player&&t.push(I.player);for(let e=0;e<t.length;e++){let i=t[e].machine;if(A.CircleCheck_2D(this.colliderComp.axis,this.colliderComp.horizontal,10,t[e].axis,t[e].horizontal,t[e].radius).isHit){let t=A.randomNumber(.8,1.2),e=Math.floor(this.attack*t);i.goHurt(e,!0),i.goDown(),i.HitBack(this.colliderComp.axis,this.colliderComp.horizontal,50)}}let e=this.skill2Effect;S.playEffectDestroy("BoomEffect",e)}skill2Off(){this.isEnd||(Laya.timer.clear(this,this.skill1Update),this.isAttack=!1,this.isInvincible=!1,this.isDowning||this.goMove())}}class T extends Laya.Script3D{constructor(){super(...arguments),this.widthAxis=3,this.rangeAxis=7,this.widthHorizontal=3.5,this.rangeHorizontal=5,this.active=!1}onEnable(){this.tracer=this.owner.getComponent(E),this.carComp=this.owner.getComponent(x),this.axis=this.tracer.progressDistance,this.horizontal=this.carComp.horizontal,this.active=!0,this.init()}onDisable(){Laya.timer.clearAll(this)}onUpdate(){this.active&&(this.axis=this.tracer.progressDistance,this.horizontal=this.carComp.horizontal,this.CarCheckUpdate())}colliderGetAxis(t,e){this.active&&(this.axis=this.tracer.getNextDistance(t),this.horizontal=e.x,this.forwardSpeed=t,this.horizontalPos=e)}colliderCheck(){this.CarCheckUpdate()}init(){}CarCheckUpdate(){}}class M extends T{constructor(){super(...arguments),this.aiId=0}init(){M.objs||(M.objs=[]),M.objs.push(this),this.aiId=M.objs.length-1,this.isPass=!1}CarCheckUpdate(){let t=[],e=null;R.player.active&&t.push(R.player);for(let e=0;e<M.objs.length;e++)e!=this.aiId&&M.objs[e].active&&t.push(M.objs[e]);let i={isAxisHit:!1,isHorizontalHit:!1};for(let s=0;s<t.length;s++)if(i.isAxisHit=A.BoxCheck_2D_Normal(this.axis,this.horizontal,this.rangeAxis,this.widthAxis,t[s].axis,t[s].horizontal,t[s].rangeAxis,t[s].widthAxis),i.isHorizontalHit=A.BoxCheck_2D_Normal(this.axis,this.horizontal,this.rangeHorizontal,this.widthHorizontal,t[s].axis,t[s].horizontal,t[s].rangeHorizontal,t[s].widthHorizontal),i.isAxisHit||i.isHorizontalHit){e=t[s];break}this.carComp.HitStart(i,e);let s=R.player;this.isPass?s.axis<this.axis&&(this.isPass=!1):s.axis>this.axis&&this.pass()}pass(){this.isPass||(this.isPass=!0,bt.ConsoleLog("超车了！"))}HitBack(){}}class R extends T{init(){R.player=this}CarCheckUpdate(){let t=[],e=null;for(let e=0;e<M.objs.length;e++)M.objs[e].active&&t.push(M.objs[e]);let i={isAxisHit:!1,isHorizontalHit:!1};for(let s=0;s<t.length;s++)if(i.isAxisHit=A.BoxCheck_2D_Normal(this.axis,this.horizontal,this.rangeAxis,this.widthAxis,t[s].axis,t[s].horizontal,t[s].rangeAxis,t[s].widthAxis),i.isHorizontalHit=A.BoxCheck_2D_Normal(this.axis,this.horizontal,this.rangeHorizontal,this.widthHorizontal,t[s].axis,t[s].horizontal,t[s].rangeHorizontal,t[s].widthHorizontal),i.isAxisHit||i.isHorizontalHit){e=t[s];break}this.carComp.HitStart(i,e)}}class N extends Laya.Script3D{constructor(){super(...arguments),this.axis=0,this.horizontal=0,this.isRuning=!1,this.wayLeft=!0}onEnable(){this.carComp=this.owner.getComponent(x),this.axis=1,this.change(),Laya.timer.once(A.randomInt(1e4,2e4),this,this.showFace)}onDisable(){Laya.timer.clearAll(this)}change(){this.wayLeft=!this.wayLeft;let t=A.randomInt(1e3,3e3),e=R.player.carComp.tracker.progressDistance-this.carComp.tracker.progressDistance;if(this.isRuning)e<-15&&(this.isRuning=!1,this.carPushEffect.destroy());else if(e>25){console.log("氮气冲刺！"),this.isRuning=!0,this.limitSpeed=6;let t=this.carComp.carPushEffect;this.carPushEffect=S.playEffectReturn("PushEffect",t)}else this.limitSpeed=A.randomNumber(3,4);Laya.timer.once(t,this,this.change)}onUpdate(){let t=0;this.wayLeft?(t=-3,this.carComp.horizontal>t?this.horizontal=-1:this.horizontal=0):(t=3,this.carComp.horizontal<t?this.horizontal=1:this.horizontal=0),this.carComp.tracker.speedFactor>this.limitSpeed?this.axis=0:this.axis=1}showFace(){A.percent(.3)?this.carComp.emojiPlay(h.LaughCry):A.percent(.5)?this.carComp.emojiPlay(h.Cry):this.carComp.emojiPlay(h.Cool),Laya.timer.once(A.randomInt(1e4,2e4),this,this.showFace)}}class H extends x{getControlComp(){this.controlComp?this.controlComp=this.user.getComponent(N):this.controlComp=this.user.addComponent(N)}getColliderComp(){this.colliderComp=this.user.addComponent(M)}gameSpecialEnd(){}CarSpecialChange(){this.user.addComponent(B),this.user.getComponent(B).playerId=this.playerId,this.user.getComponent(B).init(this.skinId)}reset(){this.controlComp=null,this.colliderComp.destroy(),Laya.timer.once(300,this,()=>{this.getControlComp(),this.getColliderComp()})}}class U extends Laya.Script3D{constructor(){super(...arguments),this.limitSpeed=.5,this.axis=0,this.horizontal=0}onEnable(){this.carComp=this.owner.getComponent(x),this.axis=1,this.carComp.tracker.speedFactor=this.limitSpeed}onDisable(){Laya.timer.clearAll(this)}onUpdate(){this.carComp.tracker.speedFactor>this.limitSpeed?this.axis=0:this.axis=1}}class O extends T{constructor(){super(...arguments),this.npcId=0}init(){O.objs||(O.objs=[]),O.objs.push(this),this.npcId=O.objs.length-1}CarCheckUpdate(){if(!mt.isPlayerCar)return void this.destroy();let t=[],e=null;t.push(R.player);for(let e=0;e<M.objs.length;e++)M.objs[e].active&&t.push(M.objs[e]);let i={isAxisHit:!1,isHorizontalHit:!1};for(let s=0;s<t.length;s++){let a=t[s].carComp.tracker.speedFactor/t[s].carComp.maxSpeed*2;if(i.isAxisHit=A.BoxCheck_2D_Normal(this.axis,this.horizontal,this.rangeAxis,this.widthAxis,t[s].axis,t[s].horizontal,t[s].rangeAxis+a*t[s].rangeAxis,t[s].widthAxis),i.isHorizontalHit=A.BoxCheck_2D_Normal(this.axis,this.horizontal,this.rangeHorizontal,this.widthHorizontal,t[s].axis,t[s].horizontal,t[s].rangeHorizontal,t[s].widthHorizontal),i.isAxisHit||i.isHorizontalHit){e=t[s];break}}this.carComp.HitFly(i,e)}}O.objs=[];class G extends x{constructor(){super(...arguments),this.npcId=0,this.maxSpeed=100,this.isGone=!1}getControlComp(){this.controlComp?this.controlComp=this.user.getComponent(U):this.controlComp=this.user.addComponent(U)}getColliderComp(){this.colliderComp=this.user.addComponent(O)}gameSpecialEnd(){}init(t,e=50,i=0,s=1){this.user=this.owner;let a=this.user.getComponent(E);a&&a.destroy();let o=this.user.addComponent(E);o.circuit=t,o.init(e),this.circuit=t,this.tracker=o;let n=this.user.getChildByName("ModelCar");this.modelCar=n,this.modelRobot=this.user.getChildByName("ModelRobot"),n.active=!0,this.skinId=s,this.model&&this.model.destroy();let r="Model"+s.toString(),h=u.prefabs.getChildByName("Car").getChildByName(r);this.model=h.clone(),n.addChild(this.model),this.model.transform.localPosition=new Laya.Vector3,this.model.transform.localRotationEuler=new Laya.Vector3,this.model.transform.localScale=new Laya.Vector3(100,100,100),this.carHitEffect=this.model.getChildByName("CarHit"),this.carPushEffect=this.model.getChildByName("PushEffect");let l=this.model.getChildAt(0);this.car=l,this.wheels=[];for(let t=0;t<l.numChildren;t++){let e=l.getChildAt(t);this.wheels.push(e)}let c=l.meshRenderer.material.clone();c.albedoColorR=A.randomNumber(0,1),c.albedoColorG=A.randomNumber(0,1),c.albedoColorB=A.randomNumber(0,1),l.meshRenderer.material=c,this.horizontal=i,this.model.transform.localPosition=new Laya.Vector3(-this.horizontal,0,0),this.isControl=!0,this.isStart=!1,A.setTransRotEulerY(this.model.transform,0)}CarSpecialChange(){}CarStartSpecial(){S.playEffectPositon("Expolsion",this.model.transform.position.clone(),1e3),this.colliderComp.active=!1,this.colliderComp.destroy(),this.controlComp=null,this.tracker.destroy(),this.circuit.destroy(),this.destroy(),this.model.destroy(),this.isGone=!0}specialUpdate(){let t=u.player.getComponent(x);t&&!this.isGone&&t.tracker.progressDistance>this.tracker.progressDistance+100&&this.reset()}reset(){this.controlComp=null,this.colliderComp.destroy(),Laya.timer.once(1500,this,()=>{if(u.player.getComponent(x)&&!this.isGone){let t=this.tracker.progressDistance;for(let e=0;e<mt.npcs.length;e++){let i=mt.npcs[e].getComponent(G);i&&i.tracker.progressDistance>t&&(t=i.tracker.progressDistance)}if(t==this.tracker.progressDistance)return bt.ConsoleLog("障碍物回收"),this.colliderComp.active=!1,this.colliderComp.destroy(),this.controlComp=null,this.tracker.destroy(),this.circuit.destroy(),this.destroy(),this.model.destroy(),void(this.isGone=!0);if((t+=A.randomNumber(250,350))>=this.circuit.accumulateDistance-1e3)return bt.ConsoleLog("障碍物回收"),this.colliderComp.active=!1,this.colliderComp.destroy(),this.controlComp=null,this.tracker.destroy(),this.circuit.destroy(),this.destroy(),this.model.destroy(),void(this.isGone=!0);this.init(this.circuit,t,this.horizontal,this.skinId),this.getControlComp(),this.getColliderComp()}else bt.ConsoleLog("障碍物回收"),this.colliderComp.active=!1,this.colliderComp.destroy(),this.controlComp=null,this.tracker.destroy(),this.circuit.destroy(),this.destroy(),this.model.destroy(),this.isGone=!0})}HitFlyEndSpecial(){this.reset()}}class z extends Laya.Script{constructor(){super(...arguments),this.leftUrl=["ui/controlUI/yxn_an_jt1.png","ui/controlUI/yxn_an_jt2.png"],this.rightUrl=["ui/controlUI/yxn_an_jt3.png","ui/controlUI/yxn_an_jt4.png"],this.stopUrl=["ui/controlUI/yxn_an_jy2.png","ui/controlUI/yxn_an_jy.png"],this.goUrl=["ui/controlUI/yxn_an_sc2.png","ui/controlUI/yxn_an_sc.png"],this.axis=0,this.horizontal=0,this.isLeft=!1,this.isRight=!1,this.isGo=!1,this.isStop=!1}onEnable(){z.instance=this,this.axis=0,this.horizontal=0,this.isLeft=!1,this.isRight=!1,this.isGo=!1,this.isStop=!1,this.left=this.owner.getChildAt(0),this.right=this.owner.getChildAt(1),this.go=this.owner.getChildAt(2),this.stop=this.owner.getChildAt(3),this.left.skin=this.leftUrl[0],this.right.skin=this.rightUrl[0],this.go.skin=this.goUrl[0],this.stop.skin=this.stopUrl[0],A.gameButtonOn(this.left,this,this.LeftDown,this.LeftUp),A.gameButtonOn(this.right,this,this.RightDown,this.RightUp),A.gameButtonOn(this.go,this,this.GoDown,this.GoUp),A.gameButtonOn(this.stop,this,this.StopDown,this.StopUp),Laya.stage.on(Laya.Event.KEY_DOWN,this,this.onKeyDown),Laya.stage.on(Laya.Event.KEY_UP,this,this.onKeyUp),bt.Event.on(s.Native_Visible_Event,this,this.onNativeChange)}onDisable(){bt.Event.off(s.Native_Visible_Event,this,this.onNativeChange)}onUpdate(){let t=16/Laya.timer.delta;if(this.isRight&&(this.horizontal+=.3,this.horizontal>1&&(this.horizontal=1)),this.isLeft&&(this.horizontal-=.3,this.horizontal<-1&&(this.horizontal=-1)),!this.isLeft&&!this.isRight){let e=1*t;this.horizontal>e?this.horizontal-=e:this.horizontal<-e?this.horizontal+=e:Math.abs(this.horizontal)<=e&&(this.horizontal=0)}if(this.isGo&&(this.axis+=.3,this.axis>1&&(this.axis=1)),this.isStop&&(this.axis-=.3,this.axis<-1&&(this.axis=-1)),!this.isGo&&!this.isStop){let e=.1*t;this.axis>e?this.axis-=e:this.axis<-e?this.axis+=e:Math.abs(this.axis)<=e&&(this.axis=0)}}LeftDown(){this.left.skin=this.leftUrl[1],this.isLeft=!0}LeftUp(){this.left.skin=this.leftUrl[0],this.isLeft=!1}RightDown(){this.right.skin=this.rightUrl[1],this.isRight=!0}RightUp(){this.right.skin=this.rightUrl[0],this.isRight=!1}GoDown(){this.go.skin=this.goUrl[1],this.isGo=!0}GoUp(){this.go.skin=this.goUrl[0],this.isGo=!1}StopDown(){this.stop.skin=this.stopUrl[1],this.isStop=!0}StopUp(){this.stop.skin=this.stopUrl[0],this.isStop=!1}onKeyDown(t){38==t.keyCode?this.GoDown():40==t.keyCode?this.StopDown():37==t.keyCode?this.LeftDown():39==t.keyCode?this.RightDown():32==t.keyCode&&bt.Event.event(r.GameSpeed1On)}onKeyUp(t){38==t.keyCode?this.GoUp():40==t.keyCode?this.StopUp():37==t.keyCode?this.LeftUp():39==t.keyCode?this.RightUp():32==t.keyCode&&bt.Event.event(r.GameSpeed1Off)}onNativeChange(t){bt.ConsoleLog("原生广告事件",t),t?(this.left.bottom=19,this.right.bottom=19):(this.left.bottom=100,this.right.bottom=100)}}!function(t){t.start="touchStart",t.move="touchMove",t.end="touchEnd"}(l||(l={}));class F extends Laya.Script{constructor(){super(...arguments),this.isPressed=!1,this.hOriginal=0,this.vOriginal=0,this.hAxis=0,this.vAxis=0,this.outAxis=0}onEnable(){F.instance=this}onMouseDown(t){bt.Event.event(l.start,[t])}onMouseMove(t){bt.Event.event(l.move,[t])}onMouseUp(t){bt.Event.event(l.end,[t])}}class j extends Laya.Script{constructor(){super(...arguments),this.xAxis=0,this.yAxis=0,this.stopSpeed=.1,this.canMove=!0}onUpdate(){this.isPressed||(Math.abs(this.xAxis)<this.stopSpeed?this.xAxis=0:this.xAxis=Laya.MathUtil.lerp(this.xAxis,0,.1),Math.abs(this.yAxis)<this.stopSpeed?this.yAxis=0:this.yAxis=Laya.MathUtil.lerp(this.yAxis,0,.1)),j.xAxis=this.xAxis,j.yAxis=this.yAxis}onEnable(){j.instance=this,this.self=this.owner,this.joyBg=this.self.getChildAt(0),this.joystick=this.joyBg.getChildAt(0),this.self.width=Laya.stage.width,this.self.height=Laya.stage.height,bt.Event.on(l.start,this,this.onMouseDownEvent),bt.Event.on(l.move,this,this.onMouseMoveEvent),bt.Event.on(l.end,this,this.onMouseUpEvent)}onDestroy(){bt.Event.off(l.start,this,this.onMouseDownEvent),bt.Event.off(l.move,this,this.onMouseMoveEvent),bt.Event.off(l.end,this,this.onMouseUpEvent)}onMouseDownEvent(t){!this.firstTouchId&&t.stageX<Laya.stage.width/2&&(this.firstTouchId=t.touchId,this.firstTouchPoint=new Laya.Point(t.stageX,t.stageY),this.joyBg.pos(t.stageX,t.stageY-(Gt.height-this.self.height)),this.isPressed=!0)}onMouseUpEvent(t){this.firstTouchId==t.touchId&&(this.firstTouchId=null,this.isPressed=!1,this.joyBg.pos(147,600),this.joystick.pos(147,147))}onMouseMoveEvent(t){this.firstTouchId==t.touchId&&this.moveCtrl(t)}moveCtrl(t){if(this.isPressed){var e=new Laya.Vector2(0,-1),i=new Laya.Vector2(t.stageX-this.firstTouchPoint.x,t.stageY-this.firstTouchPoint.y),s=Laya.Vector2.scalarLength(i);if(0==s)this.canMove=!1;else{s>5&&!this.canMove&&this.joyBg.pos(this.firstTouchPoint.x,this.firstTouchPoint.y-(Gt.height-this.self.height));this.canMove;this.canMove=s>5;var a=Laya.Vector2.dot(e,i)/(Laya.Vector2.scalarLength(e)*Laya.Vector2.scalarLength(i)),o=Math.acos(a);this.angle=180*o/Math.PI,t.stageX<this.firstTouchPoint.x&&(this.angle=-this.angle);let n=(t.stageX-this.firstTouchPoint.x)/76,r=-(t.stageY-this.firstTouchPoint.y)/76;n>1?n=1:n<-1&&(n=-1),r>1?r=1:r<-1&&(r=-1),this.xAxis=n,this.yAxis=r}if(this.canMove&&(t.stageX<this.firstTouchPoint.x?this.joystick.x=147+Math.max(-76,t.stageX-this.firstTouchPoint.x):this.joystick.x=147+Math.min(76,t.stageX-this.firstTouchPoint.x),t.stageY<this.firstTouchPoint.y?this.joystick.y=147+Math.max(-76,t.stageY-this.firstTouchPoint.y):this.joystick.y=147+Math.min(76,t.stageY-this.firstTouchPoint.y),s>76)){var n=new Laya.Vector2(t.stageX-this.firstTouchPoint.x,t.stageY-this.firstTouchPoint.y);Laya.Vector2.normalize(n,n),Laya.Vector2.scale(n,76,n),this.joystick.pos(136+n.x,136+n.y)}}}}j.xAxis=0,j.yAxis=0;class W extends Laya.Script{constructor(){super(...arguments),this.xAxis=0,this.yAxis=0,this.stopSpeed=.1,this.canMove=!0}onUpdate(){this.isPressed||(Math.abs(this.xAxis)<this.stopSpeed?this.xAxis=0:this.xAxis=Laya.MathUtil.lerp(this.xAxis,0,.1),Math.abs(this.yAxis)<this.stopSpeed?this.yAxis=0:this.yAxis=Laya.MathUtil.lerp(this.yAxis,0,.1)),W.xAxis=this.xAxis,W.yAxis=this.yAxis}onEnable(){W.instance=this,this.self=this.owner,this.joyBg=this.self.getChildAt(0),this.joystick=this.joyBg.getChildAt(0),this.self.width=Laya.stage.width,this.self.height=Laya.stage.height,bt.Event.on(l.start,this,this.onMouseDownEvent),bt.Event.on(l.move,this,this.onMouseMoveEvent),bt.Event.on(l.end,this,this.onMouseUpEvent)}onDestroy(){bt.Event.off(l.start,this,this.onMouseDownEvent),bt.Event.off(l.move,this,this.onMouseMoveEvent),bt.Event.off(l.end,this,this.onMouseUpEvent)}onMouseDownEvent(t){!this.firstTouchId&&t.stageX>Laya.stage.width/2&&(this.firstTouchId=t.touchId,this.firstTouchPoint=new Laya.Point(t.stageX,t.stageY),this.joyBg.pos(t.stageX,t.stageY-(Gt.height-this.self.height)),this.isPressed=!0)}onMouseUpEvent(t){this.firstTouchId==t.touchId&&(this.firstTouchId=null,this.isPressed=!1,this.joyBg.pos(Laya.stage.width-147,1200),this.joystick.pos(147,147))}onMouseMoveEvent(t){this.firstTouchId==t.touchId&&this.moveCtrl(t)}moveCtrl(t){if(this.isPressed){var e=new Laya.Vector2(0,-1),i=new Laya.Vector2(t.stageX-this.firstTouchPoint.x,t.stageY-this.firstTouchPoint.y),s=Laya.Vector2.scalarLength(i);if(0==s)this.canMove=!1;else{s>5&&!this.canMove&&this.joyBg.pos(this.firstTouchPoint.x,this.firstTouchPoint.y-(Gt.height-this.self.height));this.canMove;this.canMove=s>5;var a=Laya.Vector2.dot(e,i)/(Laya.Vector2.scalarLength(e)*Laya.Vector2.scalarLength(i)),o=Math.acos(a);this.angle=180*o/Math.PI,t.stageX<this.firstTouchPoint.x&&(this.angle=-this.angle);let n=(t.stageX-this.firstTouchPoint.x)/76,r=-(t.stageY-this.firstTouchPoint.y)/76;n>1?n=1:n<-1&&(n=-1),r>1?r=1:r<-1&&(r=-1),this.xAxis=n,this.yAxis=r}if(this.canMove&&(t.stageX<this.firstTouchPoint.x?this.joystick.x=147+Math.max(-76,t.stageX-this.firstTouchPoint.x):this.joystick.x=147+Math.min(76,t.stageX-this.firstTouchPoint.x),t.stageY<this.firstTouchPoint.y?this.joystick.y=147+Math.max(-76,t.stageY-this.firstTouchPoint.y):this.joystick.y=147+Math.min(76,t.stageY-this.firstTouchPoint.y),s>76)){var n=new Laya.Vector2(t.stageX-this.firstTouchPoint.x,t.stageY-this.firstTouchPoint.y);Laya.Vector2.normalize(n,n),Laya.Vector2.scale(n,76,n),this.joystick.pos(136+n.x,136+n.y)}}}}W.xAxis=0,W.yAxis=0;class X extends b{init(){X.instance=this}press(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:.9,scaleY:.9},60),bt.Event.event(r.GameAttack1On)}release(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:1,scaleY:1},60),bt.Event.event(r.GameAttack1Off)}}class Y extends b{init(){Y.instance=this,this.colorMask=this.color.mask,this.color.set_visible(!0),this.black.set_visible(!0),this.btnTween=new Laya.Tween,this.tween=new Laya.Tween}press(){bt.Event.event(r.GameAttack2On)}release(){bt.Event.event(r.GameAttack2Off)}pressReal(){let t=this.owner;this.btnTween.complete(),this.btnTween.to(t,{scaleX:.9,scaleY:.9},60),this.isActive&&(this.press(),this.isPress=!0)}releaseReal(){let t=this.owner;this.btnTween.complete(),this.btnTween.to(t,{scaleX:.9,scaleY:.9},60),this.isActive&&(this.release(),this.isPress=!1)}unActive(t){this.isActive=!1,this.isPress=!1,this.colorMask.x=-133,this.tween.complete(),this.tween.to(this.colorMask,{x:-16},t,null,Laya.Handler.create(this,()=>{}))}goActive(){this.tween.complete(),this.isActive=!0}}class q extends b{init(){q.instance=this,this.colorMask=this.color.mask,this.color.set_visible(!0),this.black.set_visible(!0),this.btnTween=new Laya.Tween,this.tween=new Laya.Tween}press(){bt.Event.event(r.GameAttack3On)}release(){bt.Event.event(r.GameAttack3Off)}pressReal(){let t=this.owner;this.btnTween.to(t,{scaleX:.9,scaleY:.9},60),this.isActive&&(this.press(),this.isPress=!0)}releaseReal(){let t=this.owner;this.btnTween.to(t,{scaleX:1,scaleY:1},60),this.isActive&&(this.release(),this.isPress=!1)}unActive(t){this.isActive=!1,this.isPress=!1,this.colorMask.x=-133;this.tween.complete(),this.tween.to(this.colorMask,{x:-16},t,null,Laya.Handler.create(this,()=>{}))}goActive(){this.tween.complete(),this.isActive=!0}}class J{static LoadFnt(){for(var t=0;t<this.fntRes.length;t++){var e=new Laya.BitmapFont;this.bitMapFnts.push(e),e.loadFont(this.fntRes[t],new Laya.Handler(this,this.OnLoaded,[t]))}}static OnLoaded(t){Laya.Text.registerBitmapFont(this.fntName[t],this.bitMapFnts[t]),this.count++,console.log("加载字体完成 "+this.fntName[t])}}J.fntRes=["Fnt/Attack.fnt","Fnt/BigAttack.fnt"],J.fntName=["Attack","BigAttack"],J.bitMapFnts=new Array,J.count=0;class K{static CreateText(t,e,i,s,a,o){var n=new Laya.Text;n.text=e,n.x=t.x,n.y=t.y,n.fontSize=i,n.color=s,n.bold=!0,a&&(n.font=a),o&&(n.scaleX=o),o&&(n.scaleY=o),Laya.Tween.to(n,{y:t.y-K.MoveOffSet,update:new Laya.Handler(this,K.OnMovingUpdate,[n])},K.MoveTime,K.EaseType,Laya.Handler.create(this,K.OnFinishMove,[n]),0),Laya.stage.addChild(n),Laya.timer.once(this.MoveTime,this,()=>{n.destroy()})}static ScaleText(t,e,i,s,a,o){var n=new Laya.Text;n.text=e,n.x=t.x,n.y=t.y,n.pivotX=.5,n.pivotY=.5,n.fontSize=i,n.color=s,n.font=a,Laya.Tween.to(n,{y:t.y+40*K.MoveOffSet,update:new Laya.Handler(this,null,[n])},2*K.MoveTime,K.EaseType,null,0),Laya.Tween.to(n,{scaleX:1.4,scaleY:1.4,update:new Laya.Handler(this,null,[n])},1.5*K.ScaleTime,K.ScaleEaseType,Laya.Handler.create(this,K.OnFinishMove,[n]),0),Laya.stage.addChild(n)}static OnMovingUpdate(t){t.alpha-=K.AlphaSpeed}static OnFinishMove(t){t.removeSelf()}static PopText(t,e,i,s=new Laya.Vector2){let a=u.mainCam.getChildAt(0);var o=new Laya.Vector4;a.viewport.project(i,a.projectionViewMatrix,o);var n=new Laya.Vector2((o.x+s.x)/Laya.stage.clientScaleX,(o.y+s.y)/Laya.stage.clientScaleY);let r=.8;1==e&&(r=1),K.CreateText(n,t.toString(),75,"#ffffff",J.fntName[e],r)}}K.MoveTime=1500,K.ScaleTime=400,K.MoveOffSet=800,K.EaseType=Laya.Ease.quartInOut,K.AlphaSpeed=.02,K.ScaleEaseType=Laya.Ease.cubicOut;class Z extends Laya.Script{constructor(){super(...arguments),this.hpUI=[],this.hpUIMasks=[],this.valueMaskWidth=280}onEnable(){Z.instance=this;for(let t=0;t<this.owner.numChildren;t++){let e=this.owner.getChildAt(t);this.hpUI.push(e);let i=e.getChildByName("valueBack").getChildByName("value").mask;this.hpUIMasks.push(i),this.hpChange(new Q(t,mt.maxHpValues[t],!0))}bt.Event.on(s.Update_HpUI_Event,this,this.hpChange)}hpChange(t){if(t.close){this.hpUI[t.playerId].set_visible(!1)}else{this.hpUI[t.playerId].set_visible(!0);let e=t.hpValue/mt.maxHpValues[t.playerId]*this.valueMaskWidth;this.hpUIMasks[t.playerId].x=-260+e}}}class Q{constructor(t,e,i=!1){this.close=!1,this.playerId=t,this.hpValue=e,this.close=i}}class $ extends P{constructor(){super(...arguments),this.hitBackAxis=.1,this.hurtTime=100,this.moveSpeed=1.5,this.skill1Range=8,this.skill1Time=2500,this.skill1CD=6e3,this.skill2Range=8,this.skill2DoTime=200,this.skill2Time=600,this.skill2CD=6e3}initEvent(){bt.Event.on(r.GameAttack1On,this,this.attackOn),bt.Event.on(r.GameAttack1Off,this,this.attackOff),bt.Event.on(r.GameAttack2On,this,this.skill1On),bt.Event.on(r.GameAttack3On,this,this.skill2On)}offEvent(){bt.Event.off(r.GameAttack1On,this,this.attackOn),bt.Event.off(r.GameAttack1Off,this,this.attackOff),bt.Event.off(r.GameAttack2On,this,this.skill1On),bt.Event.off(r.GameAttack3On,this,this.skill2On),this.attackOff()}specialEnd(){this.isAttack=!1,this.isInvincible=!1,this.isEnd=!0,bt.Event.event(s.Player_Dead_Event),bt.Event.on(s.Player_Reborn_Event,this,this.reBorn),bt.Event.on(s.Player_GiveUp_Event,this,this.RealEnd)}reBorn(){bt.Event.off(s.Player_Reborn_Event,this,this.reBorn),bt.Event.off(s.Player_GiveUp_Event,this,this.RealEnd),this.isEnd=!1,this.heal(),this.stopAttack(),this.goMove(),this.skill2On()}RealEnd(){bt.Event.off(s.Player_Reborn_Event,this,this.reBorn),bt.Event.off(s.Player_GiveUp_Event,this,this.RealEnd),Laya.timer.clear(this,this.skill1Off),Laya.timer.clear(this,this.skill1Update),this.skill1Effect&&this.skill1Effect.destroy(),mt.isEnd||bt.Event.event(s.Over_Game_Event,{isWin:!1})}winEnd(){let t=j.instance.owner,e=X.instance.owner,i=Y.instance.owner,s=q.instance.owner,a=Z.instance.owner;t.set_visible(!1),e.set_visible(!1),i.set_visible(!1),s.set_visible(!1),a.set_visible(!1),this.isAttack=!0,this.stopMove(),this.skill1Off(),this.isEnd=!0,A.setTransRotEulerY(this.model.transform,-180);this.anim.play("shout",0,0),this.anim.speed=.41,Laya.timer.once(2e3,this,()=>{this.isEnd=!1,this.isMove=!0,this.isAttack||this.anim.crossFade("idle",.25,0,0)})}attackOn(){Laya.timer.frameLoop(1,this,this.attackUpdate)}attackUpdate(){this.goAttack()}goAttackSpecial(){let t,e=1e4;for(let i=0;i<D.objs.length;i++){let s=D.objs[i];if(s.machine.isDowning||s.machine.isEnd)continue;let a=A.CircleCheck_2D(s.axis,s.horizontal,0,this.colliderComp.axis,this.colliderComp.horizontal,0);a.distance<e&&(e=a.distance,t=s)}if(t){let e=new Laya.Vector3(t.horizontal-this.colliderComp.horizontal,0,t.axis-this.colliderComp.axis);this.getWayAngle(e)}}attackDoSpecial(){let t=D.objs,e=this.attackCombe,i=this.attackRange[e];for(let e=0;e<t.length;e++){let s=t[e].machine;if(A.CircleCheck_2D(this.colliderComp.axis,this.colliderComp.horizontal,i,t[e].axis,t[e].horizontal,t[e].radius).isHit){let t=A.Vector3Reduce(s.player.transform.position.clone(),this.player.transform.position.clone()),e=A.getTransformForward(this.model.transform);if(A.getAngle(t,e)<90){let t=A.randomNumber(.8,1.2),e=Math.floor(this.attack*t),i=0;if(t>1&&(i=1),s.goHurt(e)){let t=s.model.transform.position.clone();t.y+=5,K.PopText(e,i,t),bt.Platform.vibrateShort()}}}}u.camShake.vibrateShort(u.mainCam)}attackOff(){Laya.timer.clear(this,this.attackUpdate)}skill1On(){if(!this.isGotWeapon)return;if(mt.isEnd)return;if(this.isEnd)return;if(!this.isMove)return;if(this.isAttack)return;if(this.isDowning)return;this.isAttack=!0,this.isInvincible=!0;this.anim.play("swordSkill",0,0),Laya.timer.frameLoop(1,this,this.skill1Update),Laya.timer.once(this.skill1Time,this,this.skill1Off),Y.instance.unActive(this.skill1CD),setTimeout(()=>{Y.instance.goActive()},this.skill1CD);let t=this.effect.getChildByName("SwordSpinEffect");this.skill1Effect=S.playEffectReturn("SwordSpinEffect",t),this.anim.getControllerLayer(1).defaultWeight=0,bt.ConsoleLog("技能1开启"),u.sound.play(a.SwordSkill)}skill1Update(){this.MoveControl(),this.skill1Do()}skill1Do(){let t=D.objs;for(let e=0;e<t.length;e++){let i=t[e].machine;if(A.CircleCheck_2D(this.colliderComp.axis,this.colliderComp.horizontal,6,t[e].axis,t[e].horizontal,t[e].radius).isHit){let t=A.randomNumber(.8,1.2),e=Math.floor(this.attack*t),s=0;if(t>1&&(s=1),i.goHurt(e)){let t=i.model.transform.position.clone();t.y+=5,K.PopText(e,s,t),bt.Platform.vibrateShort()}}}}skill1Off(){this.isEnd||(this.anim.play("idle",0,0),this.skill1Effect&&this.skill1Effect.destroy(),Laya.timer.clear(this,this.skill1Off),Laya.timer.clear(this,this.skill1Update),this.isAttack=!1,this.isInvincible=!1,bt.ConsoleLog("技能1关闭"))}skill2On(){if(mt.isEnd)return;if(this.isEnd)return;if(!this.isMove)return;if(this.isAttack)return;if(this.isDowning)return;this.isAttack=!0,this.isInvincible=!0,this.stopMove();this.anim.play("shout",0,0),Laya.timer.once(this.skill2DoTime,this,this.skill2Do),q.instance.unActive(this.skill2CD),Laya.timer.once(this.skill2Time,this,this.skill2Off),setTimeout(()=>{q.instance.goActive()},this.skill2CD),bt.ConsoleLog("技能2开启"),u.sound.play(a.Shout)}skill2Do(){let t=D.objs;for(let e=0;e<t.length;e++){let i=t[e].machine;if(A.CircleCheck_2D(this.colliderComp.axis,this.colliderComp.horizontal,10,t[e].axis,t[e].horizontal,t[e].radius).isHit){i.HitBack(this.colliderComp.axis,this.colliderComp.horizontal,50);let t=A.randomNumber(.8,1.2),e=Math.floor(this.attack*t),s=0;if(t>1&&(s=1),i.goHurt(e,!0)){let t=i.model.transform.position.clone();t.y+=5,K.PopText(e,s,t),bt.Platform.vibrateShort()}i.goDown()}}let e=this.skill2Effect;S.playEffectDestroy("BoomEffect",e)}skill2Off(){this.isEnd||(this.isAttack=!1,this.isInvincible=!1,this.isDowning||this.goMove(),bt.ConsoleLog("技能2关闭"))}specialInit(){let t=z.instance.owner,e=j.instance.owner,i=W.instance.owner,s=X.instance.owner,a=Y.instance.owner,o=q.instance.owner,n=k.instance.owner;t.set_visible(!1),e.set_visible(!0),i.set_visible(!1),s.set_visible(!1),a.set_visible(!1),o.set_visible(!0),n.set_visible(!1),this.skill2Effect=this.effect.getChildByName("BoomEffect"),this.modelRobot.getChildByName("CamRobotPoint").addChild(u.mainCam),u.mainCam.getChildByName("Main Camera").fieldOfView=40,u.mainCam.transform.localPosition=new Laya.Vector3,u.mainCam.transform.localRotationEuler=new Laya.Vector3,u.mainCam.transform.localScale=new Laya.Vector3(1,1,1),this.attack=u.PlayerAttack,this.skill1CD=u.PlayerSkill1CD,this.skill2CD=u.PlayerSkill2CD}getWeaponSpecial(){let t=X.instance.owner,e=Y.instance.owner,i=q.instance.owner;t.set_visible(!0),e.set_visible(!0),i.set_visible(!0),bt.Event.event(s.AirUI_Off)}getControlComp(){this.controlComp=j}getColliderComp(){this.colliderComp=this.player.addComponent(I)}MoveControl(){if(!this.controlComp)return;let t,e=this.controlComp.xAxis,i=this.controlComp.yAxis;if(0==e&&0==i)return void(this.anim.getControllerLayer(1).defaultWeight=0);if(1==i&&0==e)t=0;else if(-1==i&&0==e)t=180;else{t=180*Math.atan2(e,i)/Math.PI}let s=this.camAngle+t;if(j.instance.isPressed){let t=s-this.nowAngle;s-this.nowAngle>180?t-=360:this.nowAngle-s>180&&(t+=360);let e=t*.3;this.nowAngle+=e,this.nowAngle>180?this.nowAngle-=360:this.nowAngle<=-180&&(this.nowAngle+=360)}let a=s,o=new Laya.Vector3(-e,0,i),n=Laya.Vector3.scalarLength(o);n>1&&(n=1),this.Move(a,n)}hurtSpecial(){mt.isPlayerCar||(u.sound.play(a.PlayerHit),bt.Platform.vibrateShort())}goDownSpecial(){this.skill1Off()}getWayAngle(t){if(0==t.x&&0==t.z)return void(this.anim.getControllerLayer(1).defaultWeight=0);let e;if(-1==t.z&&0==t.x)e=0;else if(1==t.z&&0==t.x)e=180;else{e=180*Math.atan2(t.x,-t.z)/Math.PI}let i=e;A.setTransRotEulerY(this.model.transform,-i)}}class tt extends b{init(){tt.instance=this}press(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:.9,scaleY:.9},60),bt.Event.event(r.GameEmojiCool)}release(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:1,scaleY:1},60)}}class et extends b{init(){et.instance=this}press(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:.9,scaleY:.9},60),bt.Event.event(r.GameEmojiCry)}release(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:1,scaleY:1},60)}}class it extends b{init(){it.instance=this}press(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:.9,scaleY:.9},60),bt.Event.event(r.GameEmojiCryLaugh)}release(){let t=this.owner;this.btnTween&&this.btnTween.clear(),this.btnTween=Laya.Tween.to(t,{scaleX:1,scaleY:1},60)}}class st extends Laya.Script{constructor(){super(...arguments),this.min=-135,this.max=125}onEnable(){st.instance=this,this.arrow=this.owner.getChildByName("arrow"),this.value=this.owner.getChildByName("value"),this.label=this.owner.getChildByName("label"),bt.Event.on(r.GameCarSpeedChange,this,this.speedChange)}onDisable(){bt.Event.off(r.GameCarSpeedChange,this,this.speedChange)}speedChange(t){this.arrow.rotation=this.min+(this.max-this.min)*t/7,this.label.text=Math.floor(t/7*200).toString(),this.value.value=Math.floor(t/7*200).toString()}}class at extends x{constructor(){super(...arguments),this.setMaxSpeed=4.5,this.time=3e3,this.cdTime=8e3,this.isSpeed=!1}getControlComp(){this.controlComp=z.instance}getColliderComp(){this.colliderComp=this.user.addComponent(R)}specialInit(){bt.Event.on(r.GameSpeed1On,this,this.SpeedUp),bt.Event.on(r.GameEmojiCool,this,this.showCoolFace),bt.Event.on(r.GameEmojiCry,this,this.showCryFace),bt.Event.on(r.GameEmojiCryLaugh,this,this.showCryLaughFace),this.speedUpStart=this.setMaxSpeed,this.speedEffect=u.mainCam.getChildByName("SpeedLine"),this.speedEffect.particleSystem.startSizeConstantMax=0}CarStartSpecial(){let t=z.instance.owner,e=k.instance.owner,i=st.instance.owner;t.set_visible(!1),e.set_visible(!1),i.set_visible(!1);let o=tt.instance.owner,n=et.instance.owner,r=it.instance.owner;o.set_visible(!1),n.set_visible(!1),r.set_visible(!1),u.sound.stopLoop(a.CarRuning),u.sound.stopLoop(a.CarEnding),bt.Event.event(s.AirUI_On)}gameSpecialEnd(){u.sound.play(a.CarFly)}specialUpdate(){this.tracker.speedFactor>this.setMaxSpeed&&(this.tracker.speedFactor=this.setMaxSpeed);let t=this.controlComp.axis;this.isSpeed&&!this.isEnding&&(t=1,this.controlComp.axis=1),t>0?(u.sound.stopLoop(a.CarEnding),u.sound.playLoop(a.CarRuning),u.sound.setSoundVolume(a.CarRuning,t)):t<0?(u.sound.stopLoop(a.CarRuning),u.sound.playLoop(a.CarEnding),u.sound.setSoundVolume(a.CarRuning,-t)):(u.sound.stopLoop(a.CarRuning),u.sound.stopLoop(a.CarEnding));let e=u.mainCam.getChildByName("Main Camera"),i=u.minCamFov+this.tracker.speedFactor*u.camFovSpeedAxis,s=e.fieldOfView;e.fieldOfView=Laya.MathUtil.lerp(s,i,u.camLerpAxis),bt.Event.event(r.GameCarSpeedChange,this.tracker.speedFactor)}CarSpecialChange(){this.user.addComponent($),this.user.getComponent($).playerId=this.playerId,this.user.getComponent($).init(this.skinId),u.sound.stopLoop(a.CarRuning),u.sound.stopLoop(a.CarEnding),u.mainCam.getChildByName("SpeedLine").active=!1,mt.isPlayerCar=!1,xt.instance.nativeAd.destroy()}SpeedUp(){if(k.instance.unActive(this.cdTime),this.isSpeed)return;let t=this.carPushEffect;S.playEffectDestroy("PushEffect",t,this.time),this.speedEffect.particleSystem.startSizeConstantMax=0,this.isSpeed=!0;let e=new L,i=this.speedUpStart,s=this,a=u.carSpeedUpSpeed-u.carBaseAddSpeed;e.updateTweenCallback=(t=>{s.setMaxSpeed=i+2*t,s.carAddAxis=u.carBaseAddSpeed+a*t,s.speedEffect.particleSystem.startSizeConstantMax=.35*t}),e.toTween(this.user,{},.2*this.time,()=>{s.setMaxSpeed=i+2,s.carAddAxis=u.carSpeedUpSpeed,s.speedEffect.particleSystem.startSizeConstantMax=.35,e.updateTweenCallback=null}).then({},.6*this.time,()=>{e.updateTweenCallback=(t=>{s.setMaxSpeed=i+2-2*t,s.carAddAxis=u.carSpeedUpSpeed-a*t,s.speedEffect.particleSystem.startSizeConstantMax=.35-.35*t})}).then({},.2*this.time,()=>{}),Laya.timer.once(this.time,this,this.SpeedEnd)}SpeedEnd(){this.speedEffect.particleSystem.startSizeConstantMax=0,this.isSpeed=!1,this.setMaxSpeed=this.speedUpStart}HitSpecial(){bt.Platform.vibrateShort(),u.camShake.vibrateMoreSoft(u.mainCam)}showCoolFace(){this.emojiPlay(h.Cool)}showCryFace(){this.emojiPlay(h.Cry)}showCryLaughFace(){this.emojiPlay(h.LaughCry)}}class ot extends Laya.Script3D{constructor(){super(...arguments),this.smoothRoute=!0,this.substeps=100,this.p0n=0,this.p1n=0,this.p2n=0,this.p3n=0,this.i=0,this.p0=new Laya.Vector3,this.p1=new Laya.Vector3,this.p2=new Laya.Vector3,this.p3=new Laya.Vector3}get length(){return this._length}set length(t){this._length=t}v3Add(t,e){var i=new Laya.Vector3;return Laya.Vector3.add(t,e,i),i}v3Subtract(t,e){var i=new Laya.Vector3;return Laya.Vector3.subtract(t,e,i),i}v3Scale(t,e){var i=new Laya.Vector3;return Laya.Vector3.scale(t,e,i),i}cachePositionsAndDistances(){this.points=[],this.distances=[];for(var t=0,e=0;e<this.allPointVec3.length;e++){var i=this.allPointVec3[e%this.allPointVec3.length],s=this.allPointVec3[(e+1)%this.allPointVec3.length];if(i&&s){var a=i,o=s;this.points[e]=this.allPointVec3[e%this.allPointVec3.length],this.distances[e]=t;var n=new Laya.Vector3;Laya.Vector3.subtract(a,o,n),e<this.allPointVec3.length-1&&(t+=Laya.Vector3.scalarLength(n))}}this.accumulateDistance=t}getUpDirection(t){return new Laya.Vector3(0,1,0)}getRoutePoint(t){var e=this.getRountePosition(t),i=this.getRountePosition(t+.1),s=new Laya.Vector3,a=this.v3Subtract(e,i);return Laya.Vector3.normalize(a,s),new nt(e,s)}getRountePosition(t){var e=0;for(this.length=this.distances[this.distances.length-1],t%=this.length;this.distances[e]<t;)++e;if(this.p1n=(e-1+this.numPoints)%this.numPoints,this.p2n=e,this.i=this.inverseLerp(this.distances[this.p1n],this.distances[this.p2n],t),this.smoothRoute)return this.p0n=(e-2+this.numPoints)%this.numPoints,this.p3n=(e+1)%this.numPoints,this.p2n%=this.numPoints,this.p0=this.points[this.p0n],this.p1=this.points[this.p1n],this.p2=this.points[this.p2n],this.p3=this.points[this.p3n],this.catmullRom(this.p0,this.p1,this.p2,this.p3,this.i);this.p1n=(e-1+this.numPoints)%this.numPoints,this.p2n=e;var i=new Laya.Vector3;return Laya.Vector3.lerp(this.points[this.p1n],this.points[this.p2n],this.i,i),i}catmullRom(t,e,i,s,a){var o=this.v3Scale(this.p1,2),n=this.v3Scale(this.v3Subtract(this.p2,this.p0),this.i),r=this.v3Scale(this.p0,2),h=this.v3Scale(this.p1,5),l=this.v3Scale(this.p2,4),c=this.v3Add(this.v3Subtract(r,h),l),d=(c=this.v3Subtract(c,this.p3),this.v3Scale(c,Math.pow(this.i,2))),p=this.v3Scale(this.p1,3),m=this.v3Scale(this.p2,3),g=this.v3Subtract(p,this.p0);g=this.v3Subtract(g,m),g=this.v3Add(g,this.p3);var u=this.v3Scale(g,Math.pow(this.i,3));return this.v3Scale(this.v3Add(this.v3Add(this.v3Add(o,n),d),u),.5)}assignUsingAllChildObjects(){this.allPointVec3=[];for(var t=this.owner,e=0;e<t.numChildren;e++)this.allPointVec3.push(t.getChildAt(e).transform.position.clone());t.destroyChildren()}init(){this.assignUsingAllChildObjects(),this.allPointVec3.length>1&&this.cachePositionsAndDistances(),this.numPoints=this.allPointVec3.length}inverseLerp(t,e,i){return(i-t)/(e-t)}}class nt{constructor(t,e){this.position=t,this.direction=e}}class rt{constructor(){for(var t in this.nowLoopSound=[],this._pathRoot="res/sound/",this._soundCtx={},this._soundFile=[],a){let e=a[t];this._soundFile.push(e)}bt.ConsoleLog("音效：",this._soundFile),this.init()}init(){let t=this._pathRoot,e="",i=this._soundFile,s=this._soundFile.length;for(let a=0;a<s;++a){e=i[a];let s=new Laya.SoundChannel;s.url=t+e+".mp3",Laya.SoundManager.addChannel(s),this._soundCtx[e]=!0}let o=["res/sound/"+a.BGM+".mp3"];Laya.loader.load(o,Laya.Handler.create(this,()=>{this.playMusic(a.BGM)})),Laya.SoundManager.autoStopMusic=!0}play(t){this._soundCtx[t]&&Laya.SoundManager.playSound(this._pathRoot+t+".mp3")}stop(t){this._soundCtx[t]&&Laya.SoundManager.stopSound(this._pathRoot+t+".mp3")}playLoop(t){let e=!1;for(let i=0;i<this.nowLoopSound.length;i++)if(this.nowLoopSound[i]==t){e=!0;break}e||this.nowLoopSound.push(t),this._soundCtx[t]&&!e&&Laya.SoundManager.playSound(this._pathRoot+t+".mp3",0)}stopLoop(t){for(let e=0;e<this.nowLoopSound.length;e++)if(this.nowLoopSound[e]==t){this.nowLoopSound.splice(e,1);break}this._soundCtx[t]&&Laya.SoundManager.stopSound(this._pathRoot+t+".mp3")}setSoundVolume(t,e){this._soundCtx[t]&&Laya.SoundManager.setSoundVolume(e,this._pathRoot+t+".mp3")}setMusicVolume(t){Laya.SoundManager.setMusicVolume(t)}playMusic(t){Laya.SoundManager.stopMusic(),t?(Laya.SoundManager.playMusic(this._pathRoot+t+".mp3",0),this.currentBgm=t):this.currentBgm?Laya.SoundManager.playMusic(this._pathRoot+this.currentBgm+".mp3",0):Laya.SoundManager.playMusic(this._pathRoot+a.BGM+".mp3",0)}stopMusic(){Laya.SoundManager.stopMusic()}}class ht extends Laya.Script{onAwake(){this.self=this.owner,this.init()}init(...t){}onDestroy(){Laya.timer.clearAll(this),bt.Event.offAllCaller(this)}}class lt extends ht{init(){lt.instance=this,this.self.size(Laya.stage.width,Laya.stage.height),this.bg=this.self.getChildByName("bg"),this.imgCoinBg=this.self.getChildByName("imgCoinBg"),this.btnGetCoin=this.imgCoinBg.getChildByName("btnGetCoin"),this.btnCloseGetCoin=this.imgCoinBg.getChildByName("btnCloseGetCoin"),this.bg.size(Laya.stage.width,Laya.stage.height)}showGetCoin(){this.self.visible=!0,g.toScale(this.imgCoinBg,0,1,200,Laya.Ease.backOut),f.d2_AddClickEvent(this.btnGetCoin,this,()=>{bt.Platform.showVideoAd(()=>{bt.Storage.addCoin(1e3),this.self.visible=!1})}),f.d2_AddClickEvent(this.btnCloseGetCoin,this,()=>{this.self.visible=!1})}}class ct extends Laya.Scene{onAwake(){this.size(Laya.stage.width,Laya.stage.height),this.init(),this.initEvent()}onClosed(){bt.Event.offAllCaller(this),Laya.timer.clearAll(this)}init(){}initEvent(){}}class dt extends ct{initEvent(){bt.Event.on(s.Skin_Unlock,this,this.gameCoinState),bt.Event.on(s.Skin_Active,this,this.gameStartState),bt.Event.on(s.Update_Coin_Event,this,this.coinChange),bt.Event.on(s.Coin_Less_Event,this,this.showGetCoinWindow),bt.Event.on(s.Native_Visible_Event,this,this.nativeChange),f.d2_AddClickEvent(this.btnStart,this,this.onStartClick),f.d2_AddClickEvent(this.btnRight,this,this.rightBtnClick),f.d2_AddClickEvent(this.btnLeft,this,this.leftBtnClick),f.d2_AddClickEvent(this.btnVideo,this,this.onVideoClick),f.d2_AddClickEvent(this.btnCoin,this,this.onCoinClick)}onOpened(t){}init(){dt.instance=this,this.coinChange()}onStartClick(){bt.ConsoleLog("游戏开始"),bt.UI.closeScene(i.Home),bt.Event.event(s.Play_Game_Event)}onVideoClick(){bt.ConsoleLog("点击广告解锁"),mt.videoUnlock()}onCoinClick(){bt.ConsoleLog("点击金币解锁"),mt.coinUnlock()}rightBtnClick(){mt.right()}leftBtnClick(){mt.left()}gameStartState(){bt.ConsoleLog("游戏开始界面"),this.btnStart.set_visible(!0),this.btnVideo.set_visible(!1),this.btnCoin.set_visible(!1),bt.Event.event("Update_NativeAd_Event",{isClose:!1})}gameVideoState(){bt.ConsoleLog("游戏视频界面"),this.btnStart.set_visible(!1),this.btnVideo.set_visible(!0),this.btnCoin.set_visible(!1),bt.Event.event("Update_NativeAd_Event",{isClose:!1})}gameCoinState(){bt.ConsoleLog("金币解锁界面"),this.btnStart.set_visible(!1),this.btnCoin.set_visible(!0),this.btnVideo.set_visible(!0),bt.Event.event("Update_NativeAd_Event",{isClose:!1})}coinChange(){this.coinValue.value=bt.Storage.storageData.coin.toString()}nativeChange(t){this.btnCoin.bottom=t?165:50}showGetCoinWindow(){lt.instance.showGetCoin()}}class pt{vibrateMoreSoft(t){Laya.timer.clearAll(this),A.objectShake(t,.1,.025),this.isShaking=!0,Laya.timer.once(100,this,()=>{this.isShaking=!1})}vibrateSoft(t){Laya.timer.clearAll(this),A.objectShake(t,.1,.05),this.isShaking=!0,Laya.timer.once(100,this,()=>{this.isShaking=!1})}vibrateShort(t){Laya.timer.clearAll(this),A.objectShake(t,.1,.25),this.isShaking=!0,Laya.timer.once(100,this,()=>{this.isShaking=!1})}vibrateLong(t){Laya.timer.clearAll(this),A.objectShake(t,1,.25),this.isShaking=!0,Laya.timer.once(1e3,this,()=>{this.isShaking=!1})}}class mt{static initEvent(){bt.Event.on(s.Load_Res_Msg_Event,this,this.firstIn),bt.Event.on(s.Init_Game_Event,this,this.roundInit),bt.Event.on(s.Play_Game_Event,this,this.gameStart),bt.Event.on(s.Over_Game_Event,this,this.gameEnd),bt.Event.on(r.GameRealStart,this,this.gameRealStart),bt.Event.on(r.GameAIDead,this,this.AIDead)}static firstIn(e){if(e.allComplete){bt.GlData.platform==t.PC&&localStorage.clear(),bt.Storage.unlockSkin(1),u.scene3D=bt.Level.mainScene,u.sound=new rt,u.mainCam=u.scene3D.getChildByName("MainCam"),u.player=u.scene3D.getChildByName("Player"),u.prefabs=u.scene3D.getChildByName("Prefabs"),u.sound.setMusicVolume(.6),u.camNormalPoint=u.player.getChildByName("ModelCar").getChildByName("CamNormalPoint");let e=u.scene3D.getChildByName("StartPick");this.startPick=e,u.camShopPoint=e.getChildByName("CamShopPoint"),u.camPoint=u.camNormalPoint,u.camShake=new pt,this.stageRobot=u.scene3D.getChildByName("StageRobot"),bt.Level.setFog(!0,u.scene3D,new Laya.Vector3(.5,.5,.5)),bt.Level.createShadow(u.scene3D.getChildByName("Directional Light"),Laya.ShadowMode.SoftLow),bt.checkPerformance(()=>{bt.equipmentPerformance==o.Low&&bt.Level.createShadow(u.scene3D.getChildByName("Directional Light"),Laya.ShadowMode.None)}),S.init(),u.prefabs.active=!1;for(let t=0;t<4;t++){let e="WeaponPoint"+(t+1).toString(),i=this.stageRobot.getChildByName(e),s=i.getChildByName("Weapon"),a="Weapon"+(t+1).toString(),o=u.prefabs.getChildByName("Weapon").getChildByName(a).clone();s.addChild(o),o.transform.localPosition=new Laya.Vector3,o.transform.localRotationEuler=new Laya.Vector3,o.transform.localScale=new Laya.Vector3(1,1,1),this.pickWeapons.push(i),i.active=!0}for(let t=0;t<2;t++){let e="ItemPoint"+(t+1).toString(),i=this.stageRobot.getChildByName(e);this.pickItems.push(i),i.active=!0}this.shopPoints=this.startPick.getChildByName("Points");for(let t=1;t<=4;t++){let i="Point"+t.toString(),s=e.getChildByName("Points").getChildByName(i),a=s.getChildByName("Car"),o=s.getChildByName("Machine"),n="Model"+t.toString(),r=u.prefabs.getChildByName("Machine").getChildByName(n).clone();o.addChild(r),r.transform.localPosition=new Laya.Vector3,r.transform.localRotationEuler=new Laya.Vector3,r.transform.localScale=new Laya.Vector3(1,1,1);let h=u.prefabs.getChildByName("Car").getChildByName(n).clone();a.addChild(h),h.transform.localPosition=new Laya.Vector3,h.transform.localRotationEuler=new Laya.Vector3,h.transform.localScale=new Laya.Vector3(1,1,1);let l=f.d3_FindNodeByName(r,"Weapon"),c="Weapon"+(0).toString(),d=u.prefabs.getChildByName("Weapon").getChildByName(c).clone();l.addChild(d),d.transform.localPosition=new Laya.Vector3,d.transform.localRotationEuler=new Laya.Vector3,d.transform.localScale=new Laya.Vector3(1,1,1)}let i=u.prefabs.getChildByName("Road");bt.Level.prefab=i,bt.Level.createMap(bt.Level.mapData,u.prefabs),J.LoadFnt()}}static gameStart(){this.isEnd=!1;let t=this.nowSkin;bt.ConsoleLog("游戏内玩家皮肤",t);let e=this.circuit;for(let i=0;i<3;i++){let s=u.player.clone();u.scene3D.addChild(s);let a=s.addComponent(H);a.playerId=i+1;let o=(t+i)%4+1;a.init(e,75+25*i,i%3*3-4,o),this.AIs.push(s)}this.nowAIAlive=3;for(let t=0;t<6;t++){let i=u.player.clone();u.scene3D.addChild(i);let s=1.2;i.transform.localScale=new Laya.Vector3(s,s,s);let a,o=i.addComponent(G);o.npcId=t,a=A.percent(.66)?A.randomInt(7,8):12,o.init(e,175+150*t,t%3*4-4,a),this.npcs.push(i)}let i=u.player.addComponent(at);i.playerId=0;let s=t;i.init(e,50,0,s),mt.isPlayerCar=!0,this.startPick.active=!1,u.camNormalPoint.addChild(u.mainCam),u.mainCam.transform.localPosition=new Laya.Vector3,u.mainCam.transform.localRotationEuler=new Laya.Vector3,u.mainCam.transform.localScale=new Laya.Vector3(1,1,1),u.mainCam.getChildByName("SpeedLine").active=!0,u.sound.stopLoop(a.CarRuning),u.sound.stopLoop(a.CarEnding),u.mainCam.getChildByName("Main Camera").fieldOfView=40}static gameRealStart(){this.realStart=!0;let t=z.instance.owner,e=j.instance.owner,i=W.instance.owner,a=k.instance.owner,o=st.instance.owner;t.set_visible(!0),e.set_visible(!1),i.set_visible(!1),a.set_visible(!0),o.set_visible(!0);let n=tt.instance.owner,r=et.instance.owner,h=it.instance.owner;n.set_visible(!0),r.set_visible(!0),h.set_visible(!0);let l=u.player.getComponent(x);l.getControlComp(),l.getColliderComp();for(let t=0;t<this.AIs.length;t++){let e=this.AIs[t].getComponent(H);e.getControlComp(),e.getColliderComp()}for(let t=0;t<this.npcs.length;t++){let e=this.npcs[t].getComponent(G);e.getControlComp(),e.getColliderComp()}this.hpValues[0]=u.PlayerHp,this.maxHpValues[0]=u.PlayerHp,bt.Event.event(s.Update_HpUI_Event,new Q(0,this.hpValues[0]));let c=(bt.Storage.storageData.level-1)%u.AIHp.length;for(let t=0;t<4;t++){let e;this.hpValues[t]=u.AIHp[c],this.maxHpValues[t]=u.AIHp[c],bt.Event.event(s.Update_HpUI_Event,new Q(t,this.hpValues[t])),t>this.AIs.length?(e=new Q(t,this.hpValues[t],!0),bt.ConsoleLog(e.close)):e=new Q(t,this.hpValues[t]),bt.Event.event(s.Update_HpUI_Event,e)}this.maxHpValues=A.cloneArray(this.hpValues),bt.ConsoleLog("血条初始化",this.maxHpValues),bt.Event.event("Update_NativeAd_Event")}static gameEnd(){this.isEnd=!0}static camPointDeal(t){let e=t.transform.localRotationEuler.clone();A.setTransRotEulerX(t.transform,-e.x),A.setTransRotEulerY(t.transform,180- -e.y),A.setTransRotEulerZ(t.transform,-e.z)}static roundInit(){this.realStart=!1,bt.ConsoleLog("当前关卡",bt.Storage.storageData.level);let t=u.scene3D.getChildByName("Stage"),e=t.getChildByName("Terrain"),i=t.getChildByName("Path");for(let t=0;t<this.pickWeapons.length;t++)this.pickWeapons[t].active=!0;for(let t=0;t<this.pickItems.length;t++)this.pickItems[t].active=!0;if(t.destroy(!0),t=new Laya.Sprite3D("Stage"),e=new Laya.Sprite3D("Terrain"),i=new Laya.Sprite3D("Path"),u.scene3D.addChild(t),t.addChild(e),t.addChild(i),t.transform.localPosition=new Laya.Vector3(0,0,0),e.transform.localPosition=new Laya.Vector3(0,0,0),i.transform.localPosition=new Laya.Vector3(0,0,0),this.AIs)for(let t=0;t<this.AIs.length;t++)this.AIs[t].destroy(!0);if(this.AIs=[],this.npcs)for(let t=0;t<this.npcs.length;t++)this.npcs[t].destroy(!0);this.npcs=[],R.player=null,M.objs=[],I.player=null,D.objs=[];for(let t=0;t<this.bornObj.length;t++)this.bornObj[t].destroy(!0);this.bornObj=[];let a=A.cloneArray(u.stagesData),o=a[(bt.Storage.storageData.level-1)%a.length],n=o.length;for(let s=0;s<n+1;s++){let a;if(s!=n){a="Set"+o[s].toString(),bt.ConsoleLog("生成赛道",a)}else a="Set0";let r=this.bornStageObj(a,t),h=r.getChildByName("Terrain"),l=r.getChildByName("Path");s!=n?(e.addChild(h),h.transform.localPosition=new Laya.Vector3(0,0,1e3*-s)):h.destroy(!0);let c=l.numChildren;if(l.transform.localPosition=new Laya.Vector3(0,0,1e3*-s),s==n)for(let t=0;t<c;t++){let t=l.getChildAt(0),e=t.transform.position.clone();i.addChild(t),t.transform.position=e}else for(let t=0;t<c;t++){let t=l.getChildAt(0),e=t.transform.position.clone();i.addChild(t),t.transform.position=e}l.destroy()}this.stageRobot.transform.position=new Laya.Vector3(0,0,1e3*-n+500),this.endPos=new Laya.Vector3(0,0,1e3*-n);let r=i.getComponent(ot);r&&r.destroy();let h=i.addComponent(ot);h.init(),this.circuit=h,u.scene3D.addChild(u.mainCam);let l=u.player.getComponent(x);l&&l.destroy();let c=u.player.getComponent(P);c&&c.destroy(),this.startPick.active=!0,this.nowSkin=bt.Storage.storageData.skinId[0],this.nowChooseSkinId=this.nowSkin-1,this.choosingId=bt.Storage.storageData.skinId[0],u.camShopPoint.addChild(u.mainCam),u.camShopPoint.transform.localRotationEuler=new Laya.Vector3(18,300,0),this.shopPoints.transform.localRotationEuler=new Laya.Vector3(0,300+90*this.nowChooseSkinId,0),u.mainCam.transform.localPosition=new Laya.Vector3,u.mainCam.transform.localRotationEuler=new Laya.Vector3,u.mainCam.transform.localScale=new Laya.Vector3(1,1,1),u.mainCam.getChildByName("SpeedLine").active=!1,u.mainCam.getChildByName("Main Camera").fieldOfView=30,this.tweenDone=!0,this.goChange(),bt.Event.event(s.AirUI_Off)}static right(){this.tweenDone&&(this.nowChooseSkinId++,this.goChange())}static left(){this.tweenDone&&(this.nowChooseSkinId--,this.goChange())}static goChange(){let t;t=this.nowChooseSkinId>=0?this.nowChooseSkinId%4+1:4-Math.abs(this.nowChooseSkinId+1)%4,this.choosingId=t,bt.Storage.hasSkin(this.choosingId)?(bt.Event.event(s.Skin_Active),bt.Storage.changeSkin(t),mt.nowSkin=t):bt.Event.event(s.Skin_Unlock),this.clearTween();let e=new Laya.Vector3(0,300+90*this.nowChooseSkinId,0);this.camTween=new L,this.tweenDone=!1,this.camTween.toTween(this.shopPoints,{rot:e},500,()=>{this.tweenDone=!0},Laya.Ease.backInOut,!0)}static videoUnlock(){if(!this.tweenDone)return;let t=this.choosingId;bt.Platform.showVideoAd(()=>{mt.nowSkin=t,dt.instance.onStartClick()},()=>{})}static coinUnlock(){if(!this.tweenDone)return;let t=this.choosingId;bt.Storage.storageData.coin>=5e3?(bt.Storage.addCoin(-5e3),bt.Storage.unlockSkin(t),bt.Storage.changeSkin(t),mt.nowSkin=t,bt.Event.event(s.Skin_Active)):bt.Event.event(s.Coin_Less_Event)}static clearTween(){this.camTween&&this.camTween.clearTween()}static reduceHpValue(t,e){this.hpValues[t]-=e,this.hpValues[t]<0&&(this.hpValues[t]=0),bt.Event.event(s.Update_HpUI_Event,new Q(t,this.hpValues[t]))}static addHpValue(t,e){this.hpValues[t]+=e,this.hpValues[t]>this.maxHpValues[t]&&(this.hpValues[t]=this.maxHpValues[t]),bt.Event.event(s.Update_HpUI_Event,new Q(t,this.hpValues[t]))}static AIDead(){if(this.nowAIAlive--,this.nowAIAlive<=0&&0==this.isEnd){let t=u.mainCam.getChildByName("Main Camera"),e=new L;e.updateTweenCallback=(e=>{t.fieldOfView=40-20*e}),e.toTween(t,{},1e3,()=>{t.fieldOfView=20}),setTimeout(()=>{bt.Event.event(s.Over_Game_Event,{isWin:!0})},2e3),u.player.getComponent($).winEnd()}}static bornStageObj(t,e){let i=f.d3_FindNodeByName(u.prefabs,t).clone();return e.addChild(i),i.transform.localPosition=new Laya.Vector3(0,0,0),this.bornObj.push(i),i}playerReborn(){}}mt.pickWeapons=[],mt.pickItems=[],mt.nowSkin=1,mt.npcs=[],mt.realStart=!1,mt.isEnd=!1,mt.isPlayerCar=!1,mt.hpValues=[20,20,20,20],mt.maxHpValues=[20,20,20,20],mt.nowChooseSkinId=0,mt.tweenDone=!0,mt.choosingId=0,mt.nowAIAlive=0,mt.bornObj=[];class gt{constructor(){this.init()}init(){if(bt.GlData.isSubPackage&&bt.Platform.canSubPackage){let t=["scene"];bt.Res.addLoadRes("分包"),bt.Platform.loadSubpackagesSync(t,this,(t,e)=>{e&&(t.load3DRes(),bt.Res.removeLoadRes("分包"))})}else this.load3DRes();this.initEvent(),this.readJson()}load3DRes(){bt.Res.addLoadRes("场景");var t=[{url:bt.GlData.sceneResUrl,clas:Laya.Scene3D,priority:1}];Laya.loader.create(t,Laya.Handler.create(this,this.onLoadFinished,[{target:"3dRes"}],!1),Laya.Handler.create(this,this.onLoading,null,!1)),Laya.loader.on(Laya.Event.ERROR,this,t=>{console.error("资源加载失败",t)})}onLoadFinished(t){bt.ConsoleLog("资源加载完成",t),bt.Res.removeLoadRes("场景")}onLoading(t){bt.Res.updateLoadRes("场景",t,!1)}initEvent(){bt.Event.on(s.Load_Res_Msg_Event,this,this.onLoadResEvent),bt.Event.on(s.Init_Game_Event,this,this.onInitGameEvent),bt.Event.on(s.Play_Game_Event,this,this.onPlayGameEvent),bt.Event.on(s.Over_Game_Event,this,this.onOverGameEvent),mt.initEvent()}onLoadResEvent(t){t.allComplete&&this.loadSceneRes()}onInitGameEvent(t){bt.UI.openScene(i.Home,!0,t)}onPlayGameEvent(t){bt.UI.openScene(i.Game)}onOverGameEvent(t){t.win?Laya.timer.once(1e3,this,()=>{bt.UI.openScene(i.Over,!1,t)}):bt.UI.openScene(i.Over,!1,t)}loadSceneRes(t=0){let e=Laya.loader.getRes(bt.GlData.sceneResUrl);Laya.stage.addChild(e),Laya.stage.setChildIndex(e,t),this.mainScene=e;let i=f.d3_FindNodeByName(e,"Main Camera");return i?this.mainCamera=i:bt.ConsoleWarn("未找到场景主相机"),e}loadModelRes(){return this.loadResByUrl(bt.GlData.modelResUrl)}loadResByUrl(t){return Laya.loader.getRes(t)}createShadow(t,e=Laya.ShadowMode.None){t.shadowMode=e,t.shadowDistance=60,t.shadowResolution=2048,t.shadowCascadesMode=Laya.ShadowCascadesMode.TwoCascades,t.shadowNormalBias=.4,t.shadowStrength=.3}setFog(t,e,i){e.enableFog=t,t&&(e.fogColor=i,e.fogStart=300,e.fogRange=500)}initLevel(){}updateLevel(){}readJson(){bt.Res.addLoadRes("配置");let t=["Data","Road","Stage"],e=0,i=()=>{if(e<t.length){let s="res/json/"+t[e]+".json";Laya.loader.load(s,Laya.Handler.create(this,()=>{e++,i()}),null,Laya.Loader.JSON)}else{for(let e=0;e<t.length;e++){let i="res/json/"+t[e]+".json",s=Laya.Loader.getRes(i);switch(t[e]){case"Data":u.PlayerHp=s.PlayerHp,u.PlayerAttack=s.PlayerAttack,u.PlayerSkill1CD=s.PlayerSkill1CD,u.PlayerSkill2CD=s.PlayerSkill2CD,u.AIHp=s.AIHp,u.AIAttack=s.AIAttack,u.AIAttackInterval=s.AIAttackInterval,u.AISkill1CD=s.AISkill1CD,u.AISkill2CD=s.AISkill2CD,u.minCarHp=s.minCarHp,u.carHitReduceHp=s.carHitReduceHp,u.AIAttackWeight=s.AIAttackWeight,u.AIgoHealHpPrecent=s.AIgoHealHpPrecent,bt.ConsoleLog("属性配置",s);break;case"Road":u.stagesData=s[0].Road,bt.ConsoleLog("关卡配置",s);break;case"Stage":this.mapData=s[0],bt.ConsoleLog("地图配置",s);break;default:bt.ConsoleError("配置读取错误",t[e])}}bt.Res.removeLoadRes("配置")}};i()}createMap(t,e){let i=t.self,s=this.prefab.getChildByName(i.name);if(s)var a=f.d3_CloneSprite(s);else a=new Laya.Sprite3D;if(a.name=i.name,e.addChild(a),a.transform.position=new Laya.Vector3(i.position.x,i.position.y,i.position.z),a.transform.rotationEuler=new Laya.Vector3(i.rotation.x,i.rotation.y,i.rotation.z),t.models.length>0)for(let e=0;e<t.models.length;e++)this.createMap(t.models[e],a)}}class ut{constructor(){this.score=0,this.level=1,this.coin=3e3,this.freshTime=(new Date).getTime()-864e5,this.playCount=0,this.signDay=1,this.signWeek=1,this.isSign=!1,this.skinList=[[1]],this.skinId=[1]}}class ft{constructor(){this.storageData=new ut,this.storageName=new ut;for(let t in this.storageData){let e=this.readStorage(t);e?(this.storageData[t]=JSON.parse(e),bt.ConsoleLog("加载缓存数据",t,this.storageData[t])):(this.writeStorage(t,this.storageName[t]),bt.ConsoleLog("初始化缓存数据",t,this.storageName[t])),this.storageName[t]=t}this.refreshData()}writeStorage(t,e){Laya.LocalStorage.setItem(t,JSON.stringify(e)),this.storageData[t]=e}readStorage(t){return Laya.LocalStorage.getItem(t)}removeStorage(t){Laya.LocalStorage.removeItem(t)}refreshData(){Math.floor(this.storageData.freshTime/864e5)!=Math.floor((new Date).getTime()/864e5)&&(bt.ConsoleLog("更新每日数据"),this.writeStorage(this.storageName.playCount,0),this.writeStorage(this.storageName.freshTime,(new Date).getTime()))}initSign(){this.writeStorage(this.storageName.isSign,!1),this.storageData.signDay>7&&(this.writeStorage(this.storageName.signDay,1),this.writeStorage(this.storageName.signWeek,this.storageData.signWeek+1))}sign(t){this.writeStorage(this.storageName.isSign,!0),this.writeStorage(this.storageName.signDay,this.storageData.signDay+1),t&&t()}passLevel(){this.writeStorage(this.storageName.level,this.storageData.level+1)}addCoin(t,e){this.writeStorage(this.storageName.coin,this.storageData.coin+t),bt.ConsoleLog("金币数量",t),bt.Event.event(s.Update_Coin_Event,{coin:this.storageData.coin}),e&&e(this.storageData.coin)}unlockSkin(t,e=0){this.hasSkin(t,e)||(this.storageData.skinList[e].push(t),this.writeStorage(this.storageName.skinList,this.storageData.skinList),this.changeSkin(t))}hasSkin(t,e=0){return-1!=this.storageData.skinList[e].indexOf(t)}readNowSkin(t=0){return this.storageData.skinId[t]}changeSkin(t,e=0,i){this.storageData.skinId[e]=t,this.writeStorage(this.storageName.skinId,this.storageData.skinId),bt.Event.event(s.Update_Skin_Event),i&&i()}}class yt{constructor(){this.gameVersion="1.2.1",this.playCount=0,this.isShowLog=!1,this.isSubPackage=!0,this.sceneResUrl="res/scene/Conventional/ResScene.ls",this.modelResUrl="res/scene/Conventional/ResScene.lh",this.modelsResUrl=[]}}class Ct{constructor(){for(var t in this.eventDispatcher=new Laya.EventDispatcher,s)t.length>1||(vt[s[t]]=s[t])}getTypeKey(t){let e=vt[s[t]];return e||(e=t),e}on(t,e,i,s){this.eventDispatcher.on(this.getTypeKey(t),e,i,s)}once(t,e,i,s){this.eventDispatcher.once(this.getTypeKey(t),e,i,s)}off(t,e,i,s){this.eventDispatcher.off(this.getTypeKey(t),e,i,s)}offAll(t){this.eventDispatcher.offAll(this.getTypeKey(t))}offAllCaller(t){this.eventDispatcher.offAllCaller(t)}event(t,e){this.eventDispatcher.event(this.getTypeKey(t),e)}hasListener(t){this.eventDispatcher.hasListener(this.getTypeKey(t))}isMouseEvent(t){this.eventDispatcher.isMouseEvent(this.getTypeKey(t))}}class vt{}class wt{constructor(){this.resList=[],this.resCount=0}addLoadRes(t){-1==this.resList.indexOf(t)&&(this.resCount++,this.resList.push(t),this.currentLoadType||(this.currentLoadType=t,bt.Event.event(s.Load_Res_Msg_Event,{type:t,progress:0,isComplete:!1})))}removeLoadRes(t){let e=this.resList.indexOf(t);-1!=e&&(this.resList.splice(e,1),this.resCount--,bt.Event.event(s.Load_Res_Msg_Event,{type:t,progress:1,isComplete:!0}),this.resList.length>0?(this.currentLoadType=this.resList[0],bt.Event.event(s.Load_Res_Msg_Event,{type:this.resList[0],progress:0,isComplete:!1})):0==this.resCount?(bt.ConsoleLog("全部资源加载完成"),bt.Event.event(s.Load_Res_Msg_Event,{allComplete:!0})):this.currentLoadType=null)}updateLoadRes(t,e,i){bt.Event.event(s.Load_Res_Msg_Event,{type:t,progress:e,isComplete:i})}}class Lt{constructor(){let t=[];for(let i in e)t.push(e[i]);t.length>0&&(bt.Res.addLoadRes("预制体"),Laya.loader.load(t,Laya.Handler.create(this,this.loadComplete),Laya.Handler.create(this,this.loadProgress),Laya.Loader.PREFAB))}loadProgress(t){console.log("预制体资源加载中...",t)}loadComplete(){console.log("预制体资源加载完成!"),bt.Res.removeLoadRes("预制体")}getItem(t){let e=Laya.loader.getRes(t);return e?Laya.Pool.getItemByCreateFun(t,e.create,e):(console.warn("预制体加载失败：确认是否已添加PrefabType成员"),null)}recoverItem(t,e){Laya.Pool.recover(t,e),e.parent.removeChild(e)}}class St{constructor(){this.scenes=[]}get TopScene(){return this.topScene}openScene(t,e=!1,i,a,o){let n=this.scenes.filter(e=>e.url==t);if(n&&n.length>0&&(bt.ConsoleLog("已打开此场景",n),n[0].close(),this.scenes.splice(this.scenes.indexOf(n[0]),1)),e)for(let t=this.scenes.length-1;t>=0;t--)this.closeScene(this.scenes[t].url);Laya.Scene.open(t,!1,i,Laya.Handler.create(this,t=>{o&&o.addChild(t),this.scenes.push(t),this.topScene=t,a&&a(t),bt.Event.event(s.Open_Ui_Event,t.url)}))}closeScene(t,e){let i=null;t?this.scenes.forEach(e=>{e.url!=t||(i=e)}):this.topScene&&(i=this.topScene),i&&i instanceof Laya.Scene&&(this.scenes.splice(this.scenes.indexOf(i),1),this.scenes.length>0?this.topScene=this.scenes[this.scenes.length-1]:this.topScene=null,i.close(),bt.Event.event(s.Close_Ui_Event,{url:i.url,param:e}))}}class At extends y{initAd(){this.canSubPackage=!0,this.platformApi=Laya.Browser.window.qg,this.bannerId="",this.videoId="46f0bb21385841d7a492eb8c9f0c45ac",this.nativeId="77eade16821f45349e58fc6f3796f3c0",this.boxPortalId="",this.createVideoAd()}createBannerAd(t=!1){this.getPlatformVersionCode<1031?console.warn("版本过低暂不支持Banner广告组件"):(this.bannerAd&&this.destroyBannerAd(),this.bannerAd=Laya.Browser.window.qg.createBannerAd({posId:this.bannerId,style:{},adIntervals:30}),this.bannerAd.onLoad(()=>{t&&this.bannerAd.show().then(()=>{}).catch(t=>{this.createBannerAd()}),console.log("Banner广告加载成功")}),this.bannerAd.onError(t=>{this.bannerAd=null,console.error("Banner广告加载失败",JSON.stringify(t))}),this.bannerAd.onClose(()=>{this.createBannerAd()}),this.bannerAd.onSize(t=>{}))}showBannerAd(){this.bannerAd?this.bannerAd.show().then(()=>{}).catch(t=>{this.createBannerAd(!0)}):this.createBannerAd(!0)}hideBannerAd(){this.bannerAd&&this.bannerAd.hide()}destroyBannerAd(){this.bannerAd&&(this.bannerAd.destroy(),this.bannerAd=null)}createVideoAd(){this.getPlatformVersionCode<1041?console.warn("版本过低暂不支持激励视频广告组件"):(this.videoAd&&this.destroyVideoAd(),this.videoAd=Laya.Browser.window.qg.createRewardedVideoAd({posId:this.videoId}),this.videoAd.onLoad(t=>{console.log("激励视频广告加载成功")}),this.videoAd.onError(t=>{this.videoAd=null,console.error("激励视频广告加载失败",JSON.stringify(t))}),this.videoAd.onClose(t=>{t&&(t.isEnded?this.videoFinishCallback&&this.videoFinishCallback():this.videoCancelCallback&&this.videoCancelCallback(),this.videoFinishCallback=null,this.videoCancelCallback=null,this.videoAd.load(),bt.Event.event(s.Close_Video_Event,{isEnded:t.isEnded}),Laya.SoundManager.muted=!1)}))}showVideoAd(t,e){if(!this.videoAd)return this.createVideoAd(),void(t&&t());this.videoFinishCallback=t,this.videoCancelCallback=e,Laya.SoundManager.muted=!0,this.videoAd.show().then(()=>{}).catch(e=>{t&&t(),this.createVideoAd(),this.videoFinishCallback=null,this.videoCancelCallback=null,Laya.SoundManager.muted=!1}),bt.Event.event(s.Show_Video_Event)}destroyVideoAd(){this.videoAd&&(this.videoAd=null)}createBoxProtalAd(){Laya.Browser.window.qg.createBoxPortalAd?(this.boxPortalAd=Laya.Browser.window.qg.createBoxPortalAd({posId:this.boxPortalId,marginTop:.4*this.getSystemInfoSync().screenHeight}),this.boxPortalAd.onLoad(()=>{console.log("九宫格广告加载成功")}),this.boxPortalAd.onError(t=>{this.boxPortalAd=null,console.error("九宫格广告加载失败",JSON.stringify(t))}),this.boxPortalAd.onClose(()=>{this.boxPortalCloseCallback&&this.boxPortalCloseCallback(),this.boxPortalCloseCallback=null})):console.warn("版本过低暂不支持九宫格广告组件")}showBoxProtalAd(t){if(!this.boxPortalAd)return t&&t(),void this.createBoxProtalAd();this.boxPortalAd.show().then(()=>{this.boxPortalCloseCallback=t}).catch(e=>{this.destroyBoxProtalAd(),t&&t()})}destroyBoxProtalAd(){this.boxPortalAd&&(this.boxPortalAd.destroy(),this.boxPortalAd=null,this.createBoxProtalAd())}createNativeAd(t,e){if(!(this.getPlatformVersionCode<1053)){var i=new C,s=Laya.Browser.window.qg.createNativeAd({posId:t||this.nativeId});return s.onLoad(t=>{if(t&&t.adList){i.nativeAd=s;let a=t.adList.pop();i.title=a.title,i.adId=a.adId.toString(),i.imgUrl=a.imgUrlList[0],i.desc=a.desc,console.log("原生广告加载成功"),i.nativeAd.reportAdShow({adId:i.adId}),e&&(e(i),e=null)}}),s.onError(t=>{console.error("原生广告加载失败",JSON.stringify(t)),e&&(e(null),e=null)}),i}console.warn("版本过低暂不支持原生广告组件")}showNativeAd(t,e){t&&t.nativeAd&&(t.nativeAd.reportAdClick({adId:t.adId}),e&&e(!0)),e&&e(!1)}loadNativeAd(t,e){t&&t.nativeAd?t.nativeAd.load().then(()=>{e&&e(t)}).catch(t=>{e&&e(null)}):this.createNativeAd(null,e)}destroyNativeAd(t){null}get getPlatformVersionCode(){return this.getSystemInfoSync().platformVersionCode}showToast(t,e=0){Laya.Browser.window.qg.showToast({message:t,duration:e})}createShortcut(t){this.hasShortcut(e=>{0==e&&Laya.Browser.window.qg.installShortcut({success:function(){t&&t()},fail:function(t){},complete:function(){}})})}hasShortcut(t){Laya.Browser.window.qg.hasShortcutInstalled({success:function(e){t&&t(e)},fail:function(t){}})}}class bt{static init(){this.GlData=new yt,this.initPlatform(),this.UI=new St,this.Event=new Ct,this.Res=new wt,this.Prefab=new Lt,this.initStorage(),this.Level=new gt}static initStorage(){this.Storage=new ft,this.StorageKey=this.Storage.storageName}static initPlatform(){Laya.Browser.onTTMiniGame?(this.GlData.platform=t.TickTok,this.Platform=new y):Laya.Browser.onWeiXin?(this.GlData.platform=t.WX,this.Platform=new w):Laya.Browser.onVVMiniGame?(this.GlData.platform=t.VIVO,this.Platform=new At):Laya.Browser.onQGMiniGame?(this.GlData.platform=t.OPPO,this.Platform=new v):(Laya.Browser.onPC||Laya.Browser.onMobile)&&(this.GlData.platform=t.PC,this.Platform=new y)}static ConsoleLog(...t){this.GlData.isShowLog&&console.log(...t)}static ConsoleWarn(...t){this.GlData.isShowLog&&console.warn(...t)}static ConsoleError(...t){this.GlData.isShowLog&&console.error(...t)}static get FPS(){return 1e3/Laya.timer.delta}static checkPerformance(t){let e=0,i=50,s=i;Laya.timer.loop(100,this,function addValue(){e+=bt.FPS;s--;if(s<=0){Laya.timer.clear(this,addValue);let s=e/i;bt.equipmentPerformance=s>50?o.High:s>40?o.Mid:o.Low,t&&t()}})}}const kt=window.KolaSDK;class Et{static getUserId(t){this.httpRequest("https://service.gamepeach.cn","/funservice/toutiao/code2token?appid="+this.appid+"&code="+this.code+"&anonymous_code="+this.anonymousCode,"get",e=>{e=JSON.parse(e),t&&t()})}static httpRequest(t,e,i="get",s){var a=new Laya.HttpRequest;a.http.timeout=5e3,a.once(Laya.Event.COMPLETE,this,s),a.once(Laya.Event.ERROR,this,this.httpRequest,[t,e,i,s]),"get"==i?a.send(t+e,"",i,"text"):"post"==i&&a.send(t,JSON.stringify(e),i,"text")}static init(){kt.Initialize(this.platform,"android",this.gameId,"","gamelog","https://cy-game.cn-shenzhen.log.aliyuncs.com/logstores/","https://cy-game.oss-cn-shenzhen.aliyuncs.com/gameJSConfig/h5games/",null),this.login(),bt.Event.on(s.Platform_Wake_Event,this,t=>{kt.OnShow(t.param)}),bt.Event.on(s.Platform_Sleep_Event,this,()=>{kt.OnHide()}),bt.Event.on(s.Open_Ui_Event,this,this.onOpenUiEvent),bt.Event.on(s.Close_Ui_Event,this,this.onCloseUiEvent),bt.Event.on(s.Show_Video_Event,this,()=>{kt.LogEvent("ADReward")})}static onOpenUiEvent(t){switch(bt.ConsoleLog("开启页面",t),t){case i.Load:case i.Home:case i.Game:case i.Over:}}static onCloseUiEvent(t){switch(bt.ConsoleLog("关闭页面",t.url),t.url){case i.Load:kt.LogEvent("OnMainScene");break;case i.Home:this.curLevel=1e4+bt.Storage.storageData.level,kt.LogStartLevel(this.curLevel);break;case i.Game:break;case i.Over:t.param&&kt.LogFinishLevel(this.curLevel,t.param.isWin),bt.Platform.showInterAd()}}static login(){Laya.Browser.window.wx&&Laya.Browser.window.wx.login({success(t){console.log("登录成功",JSON.stringify(t)),t.code?(Et.code=t.code,Et.anonymousCode=t.anonymousCode,Et.getUserId()):console.log("登录失败！"+t.errMsg)}})}static startRecord(){this.startTime=(new Date).getTime(),bt.Platform.recordStart()}static stopRecord(){return(new Date).getTime()-this.startTime<3e3?(bt.Platform.showToast("录屏时间低于3S"),!1):(Laya.timer.scale=0,bt.Platform.recordStop(()=>{bt.Platform.shareVideo(t=>{Laya.timer.scale=1,t||bt.Platform.showToast("分享失败")})}),!0)}}Et.appid="tt4226349bdd1fa10402",Et.code="",Et.anonymousCode="",Et.gameId="gszw",Et.platform=7,Et.canRewardShare=!0;class xt extends ct{init(){if(xt.instance=this,1!=bt.Storage.storageData.level)Laya.timer.once(1500,this,this.NumberCountOn);else{this.guideUI.set_visible(!0);let t=this.guideUI.getChildByName("button");f.d2_AddClickEvent(t,this,this.guideClose)}g.toScale(this.AirUI,1,1.2,750,null,null,!1,!0),this.gradeUI.set_visible(!1)}initEvent(){bt.Event.on(s.AirUI_On,this,this.AirUIOn),bt.Event.on(s.AirUI_Off,this,this.AirUIOff),bt.Event.on(s.Over_Game_Event,this,this.GameEnd),bt.Event.on(s.Player_Dead_Event,this,this.playerRebornOn),f.d2_AddClickEvent(this.reborn,this,this.playerReborn),f.d2_AddClickEvent(this.giveup,this,this.playerGiveUp),f.d2_AddClickEvent(this.recordStartBtn,this,this.recordStart),f.d2_AddClickEvent(this.recordEndBtn,this,this.recoredEnd)}recordStart(){this.recordStartBtn.set_visible(!1),this.recordEndBtn.set_visible(!0),Et.startRecord()}recoredEnd(){Et.stopRecord()&&(this.recordStartBtn.set_visible(!0),this.recordEndBtn.set_visible(!1))}GameEnd(t){bt.ConsoleLog("游戏结果",t.isWin),t.isWin?(u.sound.play(a.Win),bt.Storage.passLevel()):u.sound.play(a.Fail),bt.UI.closeScene(i.Game)}NumberCountOn(){this.numberCountAni.play(0,!1),u.sound.play(a.Count),Laya.timer.once(1e3,this,()=>{u.sound.play(a.Count)}),Laya.timer.once(2e3,this,()=>{u.sound.play(a.Count)}),Laya.timer.once(3e3,this,()=>{u.sound.play(a.Go)}),Laya.timer.once(3e3,this,this.NumberCountOff)}NumberCountOff(){bt.Event.event(r.GameRealStart),this.gradeUI.getChildByName("value").value=bt.Storage.storageData.level.toString(),this.gradeUI.set_visible(!0)}AirUIOn(){this.AirUI.set_visible(!0)}AirUIOff(){this.AirUI.set_visible(!1)}guideClose(){this.guideUI.set_visible(!1),this.NumberCountOn()}playerRebornOn(){this.RebornPanel.visible=!0}playerReborn(){bt.Platform.showVideoAd(()=>{bt.Event.event(s.Player_Reborn_Event),this.RebornPanel.visible=!1})}playerGiveUp(){bt.Event.event(s.Player_GiveUp_Event)}onClosed(){super.onClosed(),g.clearTween(this.AirUI)}}class Pt extends Laya.Script{onEnable(){let t=this.owner;g.toAlpha(t,1,0,500,null,()=>{},!1,!0)}onDisable(){let t=this.owner;g.clearTween(t),t.alpha=1}}class _t{safe_add(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}rol(t,e){return t<<e|t>>>32-e}cmn(t,e,i,s,a,o){return this.safe_add(this.rol(this.safe_add(this.safe_add(e,t),this.safe_add(s,o)),a),i)}ff(t,e,i,s,a,o,n){return this.cmn(e&i|~e&s,t,e,a,o,n)}gg(t,e,i,s,a,o,n){return this.cmn(e&s|i&~s,t,e,a,o,n)}hh(t,e,i,s,a,o,n){return this.cmn(e^i^s,t,e,a,o,n)}ii(t,e,i,s,a,o,n){return this.cmn(i^(e|~s),t,e,a,o,n)}coreMD5(t){for(var e=1732584193,i=-271733879,s=-1732584194,a=271733878,o=0;o<t.length;o+=16){var n=e,r=i,h=s,l=a;e=this.ff(e,i,s,a,t[o+0],7,-680876936),a=this.ff(a,e,i,s,t[o+1],12,-389564586),s=this.ff(s,a,e,i,t[o+2],17,606105819),i=this.ff(i,s,a,e,t[o+3],22,-1044525330),e=this.ff(e,i,s,a,t[o+4],7,-176418897),a=this.ff(a,e,i,s,t[o+5],12,1200080426),s=this.ff(s,a,e,i,t[o+6],17,-1473231341),i=this.ff(i,s,a,e,t[o+7],22,-45705983),e=this.ff(e,i,s,a,t[o+8],7,1770035416),a=this.ff(a,e,i,s,t[o+9],12,-1958414417),s=this.ff(s,a,e,i,t[o+10],17,-42063),i=this.ff(i,s,a,e,t[o+11],22,-1990404162),e=this.ff(e,i,s,a,t[o+12],7,1804603682),a=this.ff(a,e,i,s,t[o+13],12,-40341101),s=this.ff(s,a,e,i,t[o+14],17,-1502002290),i=this.ff(i,s,a,e,t[o+15],22,1236535329),e=this.gg(e,i,s,a,t[o+1],5,-165796510),a=this.gg(a,e,i,s,t[o+6],9,-1069501632),s=this.gg(s,a,e,i,t[o+11],14,643717713),i=this.gg(i,s,a,e,t[o+0],20,-373897302),e=this.gg(e,i,s,a,t[o+5],5,-701558691),a=this.gg(a,e,i,s,t[o+10],9,38016083),s=this.gg(s,a,e,i,t[o+15],14,-660478335),i=this.gg(i,s,a,e,t[o+4],20,-405537848),e=this.gg(e,i,s,a,t[o+9],5,568446438),a=this.gg(a,e,i,s,t[o+14],9,-1019803690),s=this.gg(s,a,e,i,t[o+3],14,-187363961),i=this.gg(i,s,a,e,t[o+8],20,1163531501),e=this.gg(e,i,s,a,t[o+13],5,-1444681467),a=this.gg(a,e,i,s,t[o+2],9,-51403784),s=this.gg(s,a,e,i,t[o+7],14,1735328473),i=this.gg(i,s,a,e,t[o+12],20,-1926607734),e=this.hh(e,i,s,a,t[o+5],4,-378558),a=this.hh(a,e,i,s,t[o+8],11,-2022574463),s=this.hh(s,a,e,i,t[o+11],16,1839030562),i=this.hh(i,s,a,e,t[o+14],23,-35309556),e=this.hh(e,i,s,a,t[o+1],4,-1530992060),a=this.hh(a,e,i,s,t[o+4],11,1272893353),s=this.hh(s,a,e,i,t[o+7],16,-155497632),i=this.hh(i,s,a,e,t[o+10],23,-1094730640),e=this.hh(e,i,s,a,t[o+13],4,681279174),a=this.hh(a,e,i,s,t[o+0],11,-358537222),s=this.hh(s,a,e,i,t[o+3],16,-722521979),i=this.hh(i,s,a,e,t[o+6],23,76029189),e=this.hh(e,i,s,a,t[o+9],4,-640364487),a=this.hh(a,e,i,s,t[o+12],11,-421815835),s=this.hh(s,a,e,i,t[o+15],16,530742520),i=this.hh(i,s,a,e,t[o+2],23,-995338651),e=this.ii(e,i,s,a,t[o+0],6,-198630844),a=this.ii(a,e,i,s,t[o+7],10,1126891415),s=this.ii(s,a,e,i,t[o+14],15,-1416354905),i=this.ii(i,s,a,e,t[o+5],21,-57434055),e=this.ii(e,i,s,a,t[o+12],6,1700485571),a=this.ii(a,e,i,s,t[o+3],10,-1894986606),s=this.ii(s,a,e,i,t[o+10],15,-1051523),i=this.ii(i,s,a,e,t[o+1],21,-2054922799),e=this.ii(e,i,s,a,t[o+8],6,1873313359),a=this.ii(a,e,i,s,t[o+15],10,-30611744),s=this.ii(s,a,e,i,t[o+6],15,-1560198380),i=this.ii(i,s,a,e,t[o+13],21,1309151649),e=this.ii(e,i,s,a,t[o+4],6,-145523070),a=this.ii(a,e,i,s,t[o+11],10,-1120210379),s=this.ii(s,a,e,i,t[o+2],15,718787259),i=this.ii(i,s,a,e,t[o+9],21,-343485551),e=this.safe_add(e,n),i=this.safe_add(i,r),s=this.safe_add(s,h),a=this.safe_add(a,l)}return[e,i,s,a]}binl2hex(t){for(var e="",i=0;i<4*t.length;i++)e+="0123456789abcdef".charAt(t[i>>2]>>i%4*8+4&15)+"0123456789abcdef".charAt(t[i>>2]>>i%4*8&15);return e}binl2b64(t){for(var e="",i=0;i<32*t.length;i+=6)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t[i>>5]<<i%32&63|t[i>>6]>>32-i%32&63);return e}str2binl(t){for(var e=1+(t.length+8>>6),i=new Array(16*e),s=0;s<16*e;s++)i[s]=0;for(s=0;s<t.length;s++)i[s>>2]|=(255&t.charCodeAt(s))<<s%4*8;return i[s>>2]|=128<<s%4*8,i[16*e-2]=8*t.length,i}strw2binl(t){for(var e=1+(t.length+4>>5),i=new Array(16*e),s=0;s<16*e;s++)i[s]=0;for(s=0;s<t.length;s++)i[s>>1]|=t.charCodeAt(s)<<s%2*16;return i[s>>1]|=128<<s%2*16,i[16*e-2]=16*t.length,i}hexMD5(t){return this.binl2hex(this.coreMD5(this.str2binl(t)))}hexMD5w(t){return this.binl2hex(this.coreMD5(this.strw2binl(t)))}b64MD5(t){return this.binl2b64(this.coreMD5(this.str2binl(t)))}b64MD5w(t){return this.binl2b64(this.coreMD5(this.strw2binl(t)))}calcMD5(t){return this.binl2hex(this.coreMD5(this.str2binl(t)))}}class It{static SHA256(t){var e=8,i=0;function safe_add(t,e){var i=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(i>>16)<<16|65535&i}function S(t,e){return t>>>e|t<<32-e}function R(t,e){return t>>>e}function Ch(t,e,i){return t&e^~t&i}function Maj(t,e,i){return t&e^t&i^e&i}function Sigma0256(t){return S(t,2)^S(t,13)^S(t,22)}function Sigma1256(t){return S(t,6)^S(t,11)^S(t,25)}function Gamma0256(t){return S(t,7)^S(t,18)^R(t,3)}return function(t){for(var e=i?"0123456789ABCDEF":"0123456789abcdef",s="",a=0;a<4*t.length;a++)s+=e.charAt(t[a>>2]>>8*(3-a%4)+4&15)+e.charAt(t[a>>2]>>8*(3-a%4)&15);return s}(function(t,e){var i,s,a,o,n,r,h,l,c,d,p,m=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),g=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),u=new Array(64);t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e;for(var f=0;f<t.length;f+=16){i=g[0],s=g[1],a=g[2],o=g[3],n=g[4],r=g[5],h=g[6],l=g[7];for(var y=0;y<64;y++)u[y]=y<16?t[y+f]:safe_add(safe_add(safe_add(S(p=u[y-2],17)^S(p,19)^R(p,10),u[y-7]),Gamma0256(u[y-15])),u[y-16]),c=safe_add(safe_add(safe_add(safe_add(l,Sigma1256(n)),Ch(n,r,h)),m[y]),u[y]),d=safe_add(Sigma0256(i),Maj(i,s,a)),l=h,h=r,r=n,n=safe_add(o,c),o=a,a=s,s=i,i=safe_add(c,d);g[0]=safe_add(i,g[0]),g[1]=safe_add(s,g[1]),g[2]=safe_add(a,g[2]),g[3]=safe_add(o,g[3]),g[4]=safe_add(n,g[4]),g[5]=safe_add(r,g[5]),g[6]=safe_add(h,g[6]),g[7]=safe_add(l,g[7])}return g}(function(t){for(var i=Array(),s=(1<<e)-1,a=0;a<t.length*e;a+=e)i[a>>5]|=(t.charCodeAt(a/e)&s)<<24-a%32;return i}(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i);s<128?e+=String.fromCharCode(s):s>127&&s<2048?(e+=String.fromCharCode(s>>6|192),e+=String.fromCharCode(63&s|128)):(e+=String.fromCharCode(s>>12|224),e+=String.fromCharCode(s>>6&63|128),e+=String.fromCharCode(63&s|128))}return e}(t)),t.length*e))}}class Dt{static getUserId(t){let e=f.getCurrentTime,i=this.getNonce(16),s=this.abstractPar("appKey",this.appKey)+this.abstractPar("appSecret",this.appSecret)+this.abstractPar("nonce",i)+this.abstractPar("pkgName",this.pkgName)+this.abstractPar("timestamp",e)+this.abstractPar("token",this.token,!0),a=It.SHA256(s);console.log("签名：",a,s);let o=this.abstractPar("pkgName",this.pkgName)+this.abstractPar("token",this.token)+this.abstractPar("timestamp",e)+this.abstractPar("nonce",i)+this.abstractPar("signature",a,!0),n="https://quickgame.vivo.com.cn/api/quickgame/cp/account/userInfo?"+o;console.log("请求地址：",n,o),this.httpRequest(n,"","get",e=>{console.log("正式请求"),e=JSON.parse(e),t&&t(),console.log("userData",JSON.stringify(e)),e.data&&e.data.openId&&(console.log("用户id:",e.data.openId),kt.userId=e.data.openId,kt.OnShow(null))})}static httpRequest(t,e,i="get",s){var a=new Laya.HttpRequest;a.http.timeout=5e3,a.once(Laya.Event.COMPLETE,this,s),a.once(Laya.Event.ERROR,this,this.httpRequest,[t,e,i,s]),"get"==i?a.send(t,"",i,"text"):"post"==i&&a.send(t,JSON.stringify(e),i,"text")}static init(){kt.LogEvent("EnterGame"),console.log("轻游SDK====================="),kt.Initialize(this.platform,"android",this.gameId,"","gamelog","https://cy-game.cn-shenzhen.log.aliyuncs.com/logstores/","https://cy-game.oss-cn-shenzhen.aliyuncs.com/gameJSConfig/h5games/",null),this.dataConfig=new Tt,kt.LoadRemoteSetting(t=>{if(console.log("加载配置文件成功",JSON.stringify(t)),t){let e=bt.GlData.gameVersion.split("."),i="v"+e[0]+e[1]+e[2];if(null!=t[i])for(let e in t)this.dataConfig[e]=null!=t[i][e]?t[i][e]:t[e];else for(let e in t)this.dataConfig[e]=t[e]}Laya.timer.once(1e3*this.dataConfig.showNativeDelayTime,this,()=>{this.canShowNativeAd=!0,this.refreshNativeAd(0)})},t=>{console.error("加载配置文件失败",JSON.stringify(t)),Laya.timer.once(1e3*this.dataConfig.showNativeDelayTime,this,()=>{this.canShowNativeAd=!0,this.refreshNativeAd(0)})}),this.login(),bt.Event.on(s.Platform_Wake_Event,this,t=>{kt.OnShow(t.param)}),bt.Event.on(s.Platform_Sleep_Event,this,()=>{kt.OnHide()}),bt.Event.on(s.Open_Ui_Event,this,this.onOpenUiEvent),bt.Event.on(s.Close_Ui_Event,this,this.onCloseUiEvent),bt.Event.on(s.Show_Video_Event,this,()=>{kt.LogEvent("ADReward")}),bt.Event.on(s.Load_Res_Msg_Event,this,t=>{1==t.progress?kt.LogEvent("LoadFinish"+t.type):0==t.progress&&kt.LogEvent("LoadStart"+t.type)})}static onOpenUiEvent(t){switch(bt.ConsoleLog("开启页面",t),t){case i.Load:break;case i.Home:this.createShortcut(300,150);break;case i.Game:1==bt.Storage.storageData.level&&(this.playCount=0,Laya.timer.loop(5e3,this,this.countPlayTime));break;case i.Over:var e=bt.Storage.storageData.level;1!=e&&2!=e||Laya.timer.clear(this,this.countPlayTime)}}static countPlayTime(){this.playCount++,kt.LogEvent("LevelOnePlayTime："+5*this.playCount+"second")}static onCloseUiEvent(t){switch(bt.ConsoleLog("关闭页面",t.url),t.url){case i.Load:kt.LogEvent("OnMainScene");break;case i.Home:this.curLevel=1e4+bt.Storage.storageData.level,kt.LogStartLevel(this.curLevel);break;case i.Game:break;case i.Over:t.param&&kt.LogFinishLevel(this.curLevel,t.param.isWin),this.dataConfig.isShowInterNativeAd&&Laya.timer.once(1e3,this,()=>{bt.Event.event("Update_NativeAd_Event",{isClose:!0});let t=bt.Prefab.getItem(e.interNativeAd);bt.UI.TopScene.addChild(t)})}}static login(){Laya.Browser.window.qg&&Laya.Browser.window.qg.login({success(t){console.log("登录成功",JSON.stringify(t)),t.token?(Dt.token=t.token,Dt.getUserId()):console.log("登录失败！"+t.errMsg)}})}static abstractPar(t,e,i=!1){var s=t+"="+e;return i||(s+="&"),s}static createShortcut(t=0,i=0){bt.Platform.hasShortcut(s=>{if(s)return;let a=bt.Prefab.getItem(e.shortcut),o=bt.UI.TopScene;o.addChild(a),a.visible=!0,a.left=t,a.top=i-a.height,f.d2_AddClickEvent(a,o,()=>{bt.Platform.createShortcut(()=>{bt.Prefab.recoverItem(e.shortcut,a),a.visible=!1})})})}static createMoreGame(t=0,i=0){let s=bt.Prefab.getItem(e.moreGame),a=bt.UI.TopScene;a.addChild(s),s.left=t,s.top=i-s.height,f.d2_AddClickEvent(s,a,()=>{bt.Platform.showBoxProtalAd()})}static refreshNativeAd(t){t=null!=t?1e3*t:1e3*this.dataConfig.nativeAdRefreshTime,Laya.timer.clear(this,this.loopCreateNativeAd),Laya.timer.loop(t,this,this.loopCreateNativeAd)}static loopCreateNativeAd(t=!1){t&&(this.nativeAd&&bt.Platform.destroyNativeAd(this.nativeAd),this.nativeAd=null),bt.Platform.loadNativeAd(this.nativeAd,t=>{t&&t.nativeAd?(console.log("原生广告创建成功=======",JSON.stringify(t)),this.nativeAd=t):this.refreshNativeAd(5),bt.Event.event("Update_NativeAd_Event")}),this.refreshNativeAd()}static getNonce(t){let e="";for(let i=0;i<t;i++){e+=Math.floor(10*Math.random())}return console.log("nonce:",e),e}}Dt.code="",Dt.pkgName="com.gzqy.bxjjcr.vivominigame",Dt.appid="105513994",Dt.appKey="bfb159bf29ddea11b8972aa17c81b8a0",Dt.appSecret="5e9e5a8ce2b4a2cd62ee987f58dd5fe8",Dt.gameId="bxjjcr",Dt.token="",Dt.platform=4,Dt.playCount=0,Dt.canShowNativeAd=!0;class Vt{static TrackShare(e){switch(bt.GlData.platform){case t.WX:var i=Laya.Browser.window.wx;if(!i)return;return i.uma.trackShare(e);case t.OPPO:case t.VIVO:}}static TrackEvent(e,i=""){switch(bt.GlData.platform){case t.WX:var s=Laya.Browser.window.wx;if(!s)return;s.uma.trackEvent(e,i);break;case t.OPPO:case t.VIVO:}}}class Bt{static getUserId(t){this.httpRequest("https://service.gamepeach.cn","/funservice/wxcode2token?appid=wx8128821038939f82&js_code="+this.code,"get",e=>{e=JSON.parse(e),t&&t()})}static httpRequest(t,e,i="get",s){var a=new Laya.HttpRequest;a.http.timeout=5e3,a.once(Laya.Event.COMPLETE,this,s),a.once(Laya.Event.ERROR,this,this.httpRequest,[t,e,i,s]),"get"==i?a.send(t+e,"",i,"text"):"post"==i&&a.send(t,JSON.stringify(e),i,"text")}static init(){kt.Initialize(0,"android","jszw","","gamelog","https://cy-game.cn-shenzhen.log.aliyuncs.com/logstores/","https://cy-game.oss-cn-shenzhen.aliyuncs.com/gameJSConfig/h5games/",null),this.login(),bt.Event.on(s.Platform_Wake_Event,this,t=>{kt.OnShow(t.param)}),bt.Event.on(s.Platform_Sleep_Event,this,()=>{kt.OnHide()}),bt.Event.on(s.Open_Ui_Event,this,this.onOpenUiEvent),bt.Event.on(s.Close_Ui_Event,this,this.onCloseUiEvent),bt.Event.on(s.Show_Video_Event,this,()=>{Vt.TrackEvent("ADReward"),kt.LogEvent("ADReward")})}static onOpenUiEvent(t){switch(bt.ConsoleLog("开启页面",t),t){case i.Load:break;case i.Home:bt.Platform.showBannerAd();break;case i.Game:break;case i.Over:bt.Platform.showBannerAd()}}static onCloseUiEvent(t){switch(bt.ConsoleLog("关闭页面",t.url),t.url){case i.Load:Vt.TrackEvent("OnLoading"),kt.LogEvent("OnLoading");break;case i.Home:bt.Platform.hideBannerAd();break;case i.Game:break;case i.Over:bt.Platform.hideBannerAd(),t.param.isWin?(Vt.TrackEvent("FinishLevel","level"+bt.Storage.storageData.level),kt.LogEvent("FinishLevel",{level:bt.Storage.storageData.level})):(Vt.TrackEvent("FailLevel","level"+bt.Storage.storageData.level),kt.LogEvent("FailLevel",{level:bt.Storage.storageData.level}))}}static login(){Laya.Browser.window.wx&&Laya.Browser.window.wx.login({success(t){t.code?(Bt.code=t.code,Bt.getUserId()):console.log("登录失败！"+t.errMsg)}})}}Bt.code="";class Tt{constructor(){this.nativeAdRefreshTime=30,this.showNativeDelayTime=60,this.isShowGameNativeAd=!1,this.isShowInterNativeAd=!1,this.isDebug=!1,this.nativeAdGameReActiveTime=5,this.v100={}}}class Mt{static getUserId(t){let e=f.getCurrentTime,i=this.abstractPar("appKey",this.appKey)+this.abstractPar("appSecret",this.appSecret)+this.abstractPar("pkgName",this.pkgName)+this.abstractPar("timeStamp",e)+this.abstractPar("token",this.token,!0),s=(new _t).hexMD5(i).toUpperCase();console.log("签名：",s,i);let a=this.abstractPar("pkgName",this.pkgName)+this.abstractPar("timeStamp",e)+this.abstractPar("token",this.token)+this.abstractPar("sign",s)+this.abstractPar("version",bt.GlData.gameVersion,!0),o="https://play.open.oppomobile.com/instant-game-open/userInfo?"+a;console.log("请求地址：",o,a),this.httpRequest(o,"","get",e=>{e=JSON.parse(e),t&&t(),console.log("userData",JSON.stringify(e)),e.userInfo&&e.userInfo.userId&&(kt.userId=e.userInfo.userId,kt.OnShow(null))})}static httpRequest(t,e,i="get",s){var a=new Laya.HttpRequest;a.http.timeout=5e3,a.once(Laya.Event.COMPLETE,this,s),a.once(Laya.Event.ERROR,this,this.httpRequest,[t,e,i,s]),"get"==i?a.send(t,"",i,"text"):"post"==i&&a.send(t,JSON.stringify(e),i,"text")}static init(){kt.LogEvent("EnterGame"),console.log("轻游SDK====================="),kt.Initialize(this.platform,"android",this.gameId,"","gamelog","https://cy-game.cn-shenzhen.log.aliyuncs.com/logstores/","https://cy-game.oss-cn-shenzhen.aliyuncs.com/gameJSConfig/h5games/",null),this.dataConfig=new Tt,kt.LoadRemoteSetting(t=>{if(console.log("加载配置文件成功",JSON.stringify(t)),t){let e=bt.GlData.gameVersion.split("."),i="v"+e[0]+e[1]+e[2];if(null!=t[i])for(let e in t)this.dataConfig[e]=null!=t[i][e]?t[i][e]:t[e];else for(let e in t)this.dataConfig[e]=t[e];this.dataConfig.isDebug&&bt.Platform.setEnableDebug()}Laya.timer.once(1e3*this.dataConfig.showNativeDelayTime,this,()=>{this.canShowNativeAd=!0,this.refreshNativeAd(0)})},t=>{console.error("加载配置文件失败",JSON.stringify(t)),Laya.timer.once(1e3*this.dataConfig.showNativeDelayTime,this,()=>{this.canShowNativeAd=!0,this.refreshNativeAd(0)})}),this.login(),bt.Event.on(s.Platform_Wake_Event,this,t=>{kt.OnShow(t.param)}),bt.Event.on(s.Platform_Sleep_Event,this,()=>{kt.OnHide()}),bt.Event.on(s.Open_Ui_Event,this,this.onOpenUiEvent),bt.Event.on(s.Close_Ui_Event,this,this.onCloseUiEvent),bt.Event.on(s.Show_Video_Event,this,()=>{kt.LogEvent("ADReward")}),bt.Event.on(s.Load_Res_Msg_Event,this,t=>{1==t.progress?kt.LogEvent("LoadFinish"+t.type):0==t.progress&&kt.LogEvent("LoadStart"+t.type)})}static onOpenUiEvent(t){switch(bt.ConsoleLog("开启页面",t),t){case i.Load:break;case i.Home:this.createShortcut(300,150),this.createMoreGame(460,150);break;case i.Game:1==bt.Storage.storageData.level&&(this.playCount=0,Laya.timer.loop(5e3,this,this.countPlayTime));break;case i.Over:var e=bt.Storage.storageData.level;1!=e&&2!=e||Laya.timer.clear(this,this.countPlayTime)}}static countPlayTime(){this.playCount++,kt.LogEvent("LevelOnePlayTime："+5*this.playCount+"second")}static onCloseUiEvent(t){switch(bt.ConsoleLog("关闭页面",t.url),t.url){case i.Load:kt.LogEvent("OnMainScene");break;case i.Home:this.curLevel=1e4+bt.Storage.storageData.level,kt.LogStartLevel(this.curLevel);break;case i.Game:break;case i.Over:t.param&&kt.LogFinishLevel(this.curLevel,t.param.isWin)}}static login(){Laya.Browser.window.qg&&Laya.Browser.window.qg.login({success(t){console.log("登录成功",JSON.stringify(t)),t.token?(Mt.token=t.token,Mt.getUserId()):console.log("登录失败！"+t.errMsg)}})}static abstractPar(t,e,i=!1){var s=t+"="+e;return i||(s+="&"),s}static createShortcut(t=0,i=0){bt.Platform.hasShortcut(s=>{if(s)return;let a=bt.Prefab.getItem(e.shortcut),o=bt.UI.TopScene;o.addChild(a),a.visible=!0,a.left=t,a.top=i-a.height,f.d2_AddClickEvent(a,o,()=>{bt.Platform.createShortcut(()=>{bt.Prefab.recoverItem(e.shortcut,a),a.visible=!1})})})}static createMoreGame(t=0,i=0){let s=bt.Prefab.getItem(e.moreGame),a=bt.UI.TopScene;a.addChild(s),s.left=t,s.top=i-s.height,f.d2_AddClickEvent(s,a,()=>{bt.Platform.showBoxProtalAd(null,()=>{bt.Event.event("Update_NativeAd_Event",{isClose:!0})})})}static refreshNativeAd(t){t=null!=t?1e3*t:1e3*this.dataConfig.nativeAdRefreshTime,Laya.timer.clear(this,this.loopCreateNativeAd),Laya.timer.loop(t,this,this.loopCreateNativeAd)}static loopCreateNativeAd(t=!1){t&&this.nativeAd&&(bt.Platform.destroyNativeAd(this.nativeAd),this.nativeAd=null),bt.Platform.loadNativeAd(this.nativeAd,t=>{t&&t.nativeAd?(console.log("原生广告创建成功=======",JSON.stringify(t)),this.nativeAd=t):this.refreshNativeAd(5),bt.Event.event("Update_NativeAd_Event")}),this.refreshNativeAd()}}Mt.code="",Mt.pkgName="com.dlfcdh.nearme.gamecenter",Mt.appid="30677685",Mt.appKey="1gv6n8ECyXxcwkwoKkgKwg0cC",Mt.appSecret="B79fcaA2aDbDBb12cE2B395F42745A13",Mt.gameId="fcdh",Mt.token="",Mt.platform=1,Mt.playCount=0,Mt.canShowNativeAd=!1;class Rt extends ht{constructor(){super(...arguments),this.triggerPos="Home",this.isEnable=!0,this.canShow=!0}init(){if(console.log("原生广告组件=============="),this.self.visible=!1,bt.Event.event(s.Native_Visible_Event,!1),this.isEnable){switch(bt.GlData.platform){case t.OPPO:this.qy=Mt;break;case t.VIVO:this.qy=Dt;break;case t.PC:return}bt.Event.on("Update_NativeAd_Event",this,this.updateData),"Game"==this.triggerPos||this.updateData()}}updateData(t){if(this.self.visible=!1,bt.Event.event(s.Native_Visible_Event,!1),t&&(this.canShow=!t.isClose),this.canShow&&this.qy&&this.qy.canShowNativeAd)if("Game"!=this.triggerPos||this.qy.dataConfig.isShowGameNativeAd)if("Game"!=this.triggerPos||mt.realStart){if(this.nativeAd=this.qy.nativeAd,bt.ConsoleLog("是否有原生广告",this.nativeAd),this.nativeAd){let t=this.nativeAd;console.log("显示原生广告",JSON.stringify(t)),this.self.visible=!0,bt.Event.event(s.Native_Visible_Event,!0),this.self.zOrder=10,this.imgAd=this.self.getChildByName("imgAd"),this.btnClose=this.self.getChildByName("btnClose"),this.btnCheck=this.self.getChildByName("btnCheck"),this.lbTitle=this.self.getChildByName("lbTitle"),this.lbDesc=this.self.getChildByName("lbDesc"),this.imgClick=this.self.getChildByName("imgClick"),this.imgAd.skin=t.imgUrl,this.lbTitle.text=t.title,this.lbDesc.text=t.desc,f.d2_AddClickEvent(this.btnClose,this,this.closeAd),f.d2_AddClickEvent(this.btnCheck,this,this.clickAd),f.d2_AddClickEvent(this.imgClick,this,this.clickAd,null,!1,!0,!1),kt.OnNativeAdShow(this.triggerPos,"1")}}else console.log("游戏还未正式开始，暂不显示");else console.log("后台配置不允许游戏中原生广告显示，暂不显示")}clickAd(){bt.Platform.showNativeAd(this.nativeAd,t=>{t&&("Inter"==this.triggerPos&&(console.log("移除监听更新组件=========="),bt.Event.off("Update_NativeAd_Event",this,this.updateData)),this.qy.loopCreateNativeAd(!0),this.self.visible=!1)}),kt.OnNativeAdClick(this.triggerPos,"1")}closeAd(){"Home"!=this.triggerPos&&bt.Event.off("Update_NativeAd_Event",this,this.updateData),this.self.visible=!1,bt.Event.event(s.Native_Visible_Event,!1),"Game"==this.triggerPos&&this.qy.dataConfig&&this.qy.dataConfig.nativeAdGameReActiveTime&&this.qy.dataConfig.nativeAdGameReActiveTime>=0&&Laya.timer.once(1e3*this.qy.dataConfig.nativeAdGameReActiveTime,this,()=>{this.init(),this.canShow=!0,this.updateData()}),"Inter"==this.triggerPos&&bt.Event.event("Update_NativeAd_Event",{isClose:!1})}onDisable(){console.log("移除原生广告组件"),bt.Event.event(s.Native_Visible_Event,!1),Laya.timer.clearAll(this),bt.Event.offAllCaller(this)}}class Nt extends Laya.Script{onEnable(){let t=this.owner;g.toScale(t,.9,1.1,500,null,()=>{},!1,!0)}onDisable(){let t=this.owner;g.clearTween(t),t.scale(1,1)}}class Ht extends ct{init(){this.warning.visible=!1,this.plCompanyLogoBg.visible=!1,this.showLoading()}showWarning(){g.toAlpha(this.warningWord,0,1,200,null,()=>{Laya.timer.once(500,this,()=>{g.toAlpha(this.warningWord,1,0,500,null,()=>{this.warning.visible=!1,this.showCompanyLogo()})})})}showCompanyLogo(){this.plCompanyLogoBg.visible=!0,g.toAlpha(this.imgCompanyLogo,0,1,200,null,()=>{Laya.timer.once(500,this,()=>{g.toAlpha(this.imgCompanyLogo,1,0,500,null,()=>{this.plCompanyLogoBg.visible=!1,this.showLoading()})})})}showLoading(){if(bt.Event.on(s.Load_Res_Msg_Event,this,this.loadResMsgEvent),0==bt.Res.resList.length)this.loadResMsgEvent({allComplete:!0});else{let t=bt.Res.currentLoadType;this.loadResMsgEvent({type:t,progress:0,isComplete:!1}),this.changePointTimer=0,this.curPointCount=3,Laya.timer.frameLoop(1,this,this.frameLoadProgress)}}loadResMsgEvent(t){if(t.allComplete)this.lbLoadMsg.text="资源加载完成",this.barLoadPgs.value=1,Laya.timer.clear(this,this.frameLoadProgress),bt.UI.closeScene(i.Load),bt.Event.event(s.Init_Game_Event,"onLoad");else{if(t.type!=bt.Res.currentLoadType)return;let e=this.lbLoadMsg.text,i="";for(let t=0;t<this.curPointCount;t++)i+=".";e=t.type+"资源加载中"+i,this.lbLoadMsg.text=e,t.isComplete?this.barLoadPgs.value=1:0==t.progress?this.barLoadPgs.value=0:this.barLoadPgs.value=Math.max(t.progress,this.barLoadPgs.value)}}frameLoadProgress(){if(this.changePointTimer+=Laya.timer.delta,this.changePointTimer>200){this.changePointTimer=0;let t="";for(let e=0;e<this.curPointCount;e++)t+=".";this.curPointCount++,this.curPointCount>3&&(this.curPointCount=1);let e="";for(let t=0;t<this.curPointCount;t++)e+=".";let i=this.lbLoadMsg.text;i=i.replace(t,e),this.lbLoadMsg.text=i}this.barLoadPgs.value+=.01}}class Ut extends ct{onOpened(t){t&&(this.isWin=t.isWin,this.imgStatus.skin=t.isWin?"ui/game/js_sl_01.png":"ui/game/js_sl_02.png",t.isWin?bt.Storage.addCoin(1e3):bt.Storage.addCoin(500))}onClosed(){super.onClosed(),bt.GlData.playCount++}initEvent(){bt.Event.on(s.Update_Coin_Event,this,this.coinChange),f.d2_AddClickEvent(this.btnContinue,this,this.onContinueClick),f.d2_AddClickEvent(this.videoBtn,this,this.doubleVideoClick)}doubleVideoClick(){this.videoBtn.set_visible(!1),this.isWin?bt.Storage.addCoin(1e3):bt.Storage.addCoin(500)}init(){this.coinChange()}onContinueClick(){bt.UI.closeScene(i.Over,{isWin:this.isWin}),bt.Event.event(s.Init_Game_Event)}coinChange(){this.coinValue.value=bt.Storage.storageData.coin.toString()}}class Ot extends ht{constructor(){super(...arguments),this.companyName="广州猫仙人游戏科技有限公司",this.gameName="怪兽之王",this.prevX=0,this.prevY=0}init(){Laya.timer.scale=0,this.bg1=this.self.getChildAt(0),this.bg2=this.self.getChildAt(1),this.bg2.visible=!1,this.line1=this.bg1.getChildByName("line1"),this.line2=this.bg1.getChildByName("line2"),this.detail=this.bg1.getChildByName("detail"),this.cbDontShow=this.bg1.getChildByName("cbDontShow"),this.cbDontShow.visible=!1,this.btnAgree=this.bg1.getChildByName("btnAgree"),this.btnDisagree=this.bg1.getChildByName("btnDisagree"),this.btnClose=this.bg2.getChildByName("btnClose"),this.msg=this.bg2.getChildByName("msg"),this.self.visible=!0,this.line1.text="       欢迎使用"+this.gameName+"！"+this.gameName+"非常重视您的隐私和个人信息保护。",this.line2.text="       在您使用"+this.gameName+"前，请认真阅读                     ，您同意并接受全部条款后方可使用"+this.gameName;let t=35*this.gameName.length+480;this.detail.x=t,this.cbDontShow.selected=!0,this.btnAgree.on(Laya.Event.CLICK,this,()=>{let t=this.self.parent;t&&t instanceof Laya.Scene&&t.url==i.Pram?bt.UI.closeScene(i.Pram):this.self.destroy(),Laya.timer.scale=1}),this.btnDisagree.on(Laya.Event.CLICK,this,()=>{qg.exitApplication({})}),this.detail.on(Laya.Event.CLICK,this,this.showDetail)}showDetail(){this.bg2.visible=!0,this.initLine(),this.btnClose.on(Laya.Event.CLICK,this,()=>{this.bg2.visible=!1,this.msg.scrollY=0,this.msg.off(Laya.Event.MOUSE_DOWN,this,this.startScrollText),this.btnClose.offAllCaller(this)})}initLine(){this.msg.text=this.companyName+"在为广大用户提供高品质服务的同时，一向注重保护用户的个人数据安全，视用户信息安全与隐私保护为自己的“生命线”。我们秉承“一切以用户价值为依归”的理念，致力于提升信息处理透明度，增强您对信息管理的便捷性，保障您的信息及通信安全。 "+this.companyName+"严格遵守法律法规，遵循以下隐私保护原则，为您提供更加安全、可靠的服务： 1、安全可靠：我们竭尽全力通过合理有效的信息安全技术及管理流程，防止您的信息泄露、损毁、丢失。 2、自主选择：我们为您提供便利的信息管理选项，以便您做出合适的选择，管理您的个人信息。 3、保护通信秘密：我们严格遵照法律法规，保护您的通信秘密，为您提供安全的通信服务。 4、合理必要：为了向您和其他用户提供更好的服务，我们仅收集必要的信息。 5、清晰透明：我们努力使用简明易懂的表述，向您介绍隐私政策，以便您清晰地了解我们的信息处理方式。 6、将隐私保护融入产品设计：我们在产品或服务开发的各个环节，综合法律、产品、设计等多方因素，融入隐私保护的理念。 本《隐私政策》主要向您说明： 我们收集哪些信息； 我们收集信息的用途； 您所享有的权利。 希望您仔细阅读《隐私政策》（以下简称“本政策”），详细了解我们对信息的收集、使用方式，以便您更好地了解我们的服务并作出适当的选择。 若您使用"+this.companyName+"服务，即表示您认同我们在本政策中所述内容。 如您有问题，请联系我们。 一、我们收集的信息 我们根据合法、正当、必要的原则，仅收集实现产品功能所必要的信息。 1.1您在使用我们服务时主动提供的信息 1.1.1 您在注册帐户时填写的信息。例如，您在注册帐户时所填写的昵称、手机号码。 1.1.2 您在使用服务时上传的信息。例如，您在使用游戏、社区时，上传的头像、分享的照片。 1.1.3 您通过我们的客服或参加我们举办的活动时所提交的信息。例如，您参与我们线上活动时填写的调查问卷中可能包含您的姓名、电话、家庭地址等信息。 我们的部分服务可能需要您提供特定的个人敏感信息来实现特定功能。若您选择不提供该类信息，则可能无法正常使用服务中的特定功能，但不影响您使用服务中的其他功能。若您主动提供您的个人敏感信息，即表示您同意我们按本政策所述目的和方式来处理您的个人敏感信息。 1.2我们在您使用服务时获取的信息 1.2.1 日志信息。当您使用我们的服务时，我们可能会自动收集相关信息并存储为服务日志信息。 1.2.1.1 设备信息。例如，设备型号、操作系统版本、唯一设备标识符、电池、信号强度等信息。 1.2.1.2软件信息。例如，软件的版本号、浏览器类型。为确保操作环境的安全或提供服务所需，我们会收集有关您使用的移动应用和其他软件的信息。 1.2.1.3 IP地址。 1.2.1.4 服务日志信息。例如，您在使用我们服务时搜索、查看的信息、服务故障信息、引荐网址等信息。 1.2.1.5通讯日志信息。例如，您在使用我们服务时曾经通讯的账户、通讯时间和时长。 1.2.2 位置信息。当您使用与位置有关的服务时，我们可能会记录您设备所在的位置信息，以便为您提供相关服务。 1.2.2.1在您使用服务时，我们可能会通过IP地址、GPS、WiFi或基站等途径获取您的地理位置信息； 1.2.2.2您或其他用户在使用服务时提供的信息中可能包含您所在地理位置信息，例如您提供的帐号信息中可能包含的您所在地区信息，您或其他人共享的照片包含的地理标记信息； 1.2.3 其他相关信息。为了帮助您更好地使用我们的产品或服务，我们会收集相关信息。例如，我们收集的好友列表、群列表信息、声纹特征值信息。为确保您使用我们服务时能与您认识的人进行联系，如您选择开启导入通讯录功能，我们可能对您联系人的姓名和电话号码进行加密，并仅收集加密后的信息。 1.3其他用户分享的信息中含有您的信息例如，其他用户发布的照片或分享的视频中可能包含您的信息。 1.4从第三方合作伙伴获取的信息我们可能会获得您在使用第三方合作伙伴服务时所产生或分享的信息。例如，您使用第三方合作伙伴服务微信或QQ帐户登录时，我们会获得您使用第三方合作伙伴服务登录的名称、登录时间，方便您进行授权管理。请您仔细阅读第三方合作伙伴服务的用户协议或隐私政策。 二、我们如何使用收集的信息 我们严格遵守法律法规的规定及与用户的约定，将收集的信息用于以下用途。若我们超出以下用途使用您的信息，我们将再次向您进行说明，并征得您的同意。 --电子邮箱地址 您在注册时提供的电子邮箱地址是您在产品内的身份标识，我们使用您的电子邮箱地址在产品中识别您，以便为您提供产品服务。例如：记录您的产品数据；响应您的产品内请求；向您提供客户服务等。我们对电子邮箱地址的使用是基于您对本隐私政策的同意。 --IP地址 IP地址是网络通信中常用的标识信息，我们使用您的IP地址是为了向您提供服务或改善我们的服务质量，例如：与您建立诸如下载、产品内请求等网络通信；识别您的所属区域以便提供个性化服务；判断您的登录行为的一致性以保障您的账户安全。我们对IP地址的使用是基于我们对您的合同义务。 --设备信息 设备标识码、设备类型、网络类型、操作系统等设备信息有助于我们更好了解您体验产品服务的设备情况，我们使用您的设备信息是为了向您提供服务或改善我们的服务质量，例如：统计设备适配性；反馈并解决您在体验产品服务过程中遇到的故障；判断您的登录行为的一致性以保障您的账户安全。我们对设备信息的使用是基于我们对您的合同义务。 --联系方式 电子邮箱地址、电话号码、即时通讯工具账号、收货地址、身份证明信息等您在特定场景下提供的联系方式，将仅用于完成该场景的目的，例如：向您发送促销信息；给您寄送奖品；响应您的客户反馈。我们对联系方式的使用是基于您对本隐私政策的同意。 --个人特征 性别、年龄、个人爱好等个人特征，主要为了向您提供个性化服务，例如：个人空间展示；用户行为统计；用户问卷调查等。我们对个人特征的使用是基于您对本隐私政策的同意。 --产品数据 产品id、角色名称、产品日志等产品服务内生成的数据，是我们提供产品服务的基础之一，我们对产品数据的使用是为了履行我们对您的合同义务。 我们收集信息是为了： 2.1向您提供服务。 2.2满足您的个性化需求。例如，语言设定、位置设定、个性化的帮助服务。 2.3产品开发和服务优化。例如，当我们的系统发生故障时，我们会记录和分析系统故障时产生的信息，优化我们的服务。 2.4安全保障。例如，我们会将您的信息用于身份验证、安全防范、反诈骗监测、存档备份、客户的安全服务等用途。例如，您下载或安装的安全软件会对恶意程序或病毒进行检测，或为您识别诈骗信息。 2.5向您推荐您可能感兴趣的广告、资讯等。 2.6评估、改善我们的广告投放和其他促销及推广活动的效果。 2.7管理软件。例如，进行软件认证、软件升级等。 2.8邀请您参与有关我们服务的调查。 为了让您有更好的体验、改善我们的服务或经您同意的其他用途，在符合相关法律法规的前提下，我们可能将通过某些服务所收集的信息用于我们的其他服务。例如，将您在使用我们某项服务时的信息，用于另一项服务中向您展示个性化的内容或广告、用于用户研究分析与统计等服务。 为了确保服务的安全，帮助我们更好地了解我们应用程序的运行情况，我们可能记录相关信息，例如，您使用应用程序的频率、故障信息、总体使用情况、性能数据以及应用程序的来源。我们不会将我们存储在分析软件中的信息与您在应用程序中提供的个人身份信息相结合。 三、我们如何使用Cookie及相关技术 我们或我们的第三方合作伙伴，可能通过放置安全的Cookie及相关技术收集您的信息，目的是为您提供更个性化的用户体验和服务。我们会严格要求第三方合作伙伴遵守本政策的相关规定。 您也可以通过浏览器设置管理Cookie。但请注意，如果停用Cookie，您可能无法享受最佳的服务体验，某些服务也可能无法正常使用。 四、我们如何存储和披露您的信息 为了履行我们对您的合同义务，即：向您提供产品服务，您的个人信息会在我们的服务器上进行处理。我们的服务器位于中国。 为了向您提供产品服务，我们可能会向以下第三方披露您的个人信息： --腾讯公司，为确保您能在产品服务中使用微信支付，基于您的同意，我们会向其提供与您支付有关的信息，该公司位于中国； --阿里巴巴公司，为确保您能在产品服务中使用支付宝支付，基于您的同意，我们会向其提供与您支付有关的信息，该公司位于中国； --高德软件公司，为确保您能在产品服务中使用定位查询功能，基于您的同意，我们会向高德地图提供您的地理位置信息，该公司位于中国； --谷歌公司，为确保您能在产品服务中使用定位查询功能，基于您的同意，我们会向谷歌地图提供您的地理位置信息，该公司位于美国； --基于履行法定义务或合同义务，预防技术或安全问题，保护他人权益、公共利益或其它合理必要的理由，我们应该向其披露您的个人信息的司法机构、执法主体或其它有权实体。 五、您如何管理自己的信息 5.1您可以在使用我们服务的过程中，访问、修改和删除您提供的注册信息和其他个人信息，也可按照通知指引与我们联系。您访问、修改和删除个人信息的范围和方式将取决于您使用的具体服务。例如，若您在使用地理位置相关服务时，希望停止分享您的地理位置信息，您可通过手机定位关闭功能、软硬件服务商及通讯服务提供商的关闭方式停止分享，建议您仔细阅读相关指引。 5.2我们将按照本政策所述，仅为实现我们产品或服务的功能，收集、使用您的信息。如您发现我们违反法律、行政法规的规定或者双方的约定收集、使用您的个人信息，您可以要求我们删除。如您发现我们收集、存储的您的个人信息有错误的，您也可以要求我们更正。请通过本政策列明的联系方式与我们联系。 5.3在您访问、修改和删除相关信息时，我们可能会要求您进行身份验证，以保障帐号的安全。 5.4请您理解，由于技术所限、法律或监管要求，我们可能无法满足您的所有要求，我们会在合理的期限内答复您的请求。 六、我们分享的信息 我们遵照法律法规的规定，对信息的分享进行严格的限制，例如： 6.1经您事先同意，我们可能与第三方分享您的个人信息； 6.2仅为实现外部处理的目的，我们可能会与第三方合作伙伴（第三方服务供应商、承包商、代理、广告合作伙伴、应用开发者等，例如，代表我们发出电子邮件或推送通知的通讯服务提供商、为我们提供位置服务的地图服务供应商）（他们可能并非位于您所在的法域）分享您的个人信息，让他们按照我们的说明、隐私政策以及其他相关的保密和安全措施来为我们处理上述信息，并用于以下用途： 6.2.1 向您提供我们的服务； 6.2.2 实现“我们如何使用收集的信息”部分所述目的； 6.2.3 履行我们在本政策中的义务和行使我们的权利； 6.2.4 理解、维护和改善我们的服务。 如我们与上述第三方分享您的信息，我们将会采用加密、匿名化处理等手段保障您的信息安全。 6.3随着我们业务的持续发展，当发生合并、收购、资产转让等交易导致向第三方分享您的个人信息时，我们将通过推送通知、公告等形式告知您相关情形，按照法律法规及不低于本政策所要求的标准继续保护或要求新的管理者继续保护您的个人信息。 6.4我们会将所收集到的信息用于大数据分析。例如，我们将收集到的信息用于分析形成不包含任何个人信息的城市热力图或行业洞察报告。我们可能对外公开并与我们的合作伙伴分享经统计加工后不含身份识别内容的信息，用于了解用户如何使用我们服务或让公众了解我们服务的总体使用趋势。 6.5我们可能基于以下目的披露您的个人信息： 6.5.1 遵守适用的法律法规等有关规定； 6.5.2 遵守法院判决、裁定或其他法律程序的规定； 6.5.3 遵守相关政府机关或其他法定授权组织的要求； 6.5.4 我们有理由确信需要遵守法律法规等有关规定； 6.5.5 为执行相关服务协议或本政策、维护社会公共利益，为保护我们的客户、我们或我们的关联公司、其他用户或雇员的人身财产安全或其他合法权益合理且必要的用途。 七、我们可能向您发送的信息 7.1信息推送 您在使用我们的服务时，我们可能向您发送电子邮件、短信、资讯或推送通知。您可以按照我们的相关提示，在设备上选择取消订阅。 7.2与服务有关的公告 我们可能在必要时（例如，因系统维护而暂停某一项服务时）向您发出与服务有关的公告。您可能无法取消这些与服务有关、性质不属于广告的公告。 八、存储信息的地点和期限 8.1存储信息的地点 我们遵守法律法规的规定，将境内收集的用户个人信息存储于境内。 8.2存储信息的期限 一般而言，我们仅为实现目的所必需的最短时间保留您的个人信息。但在下列情况下，我们有可能因需符合法律要求，更改个人信息的存储时间： 8.2.1 为遵守适用的法律法规等有关规定； 8.2.2 为遵守法院判决、裁定或其他法律程序的规定； 8.2.3 为遵守相关政府机关或法定授权组织的要求； 8.2.4 我们有理由确信需要遵守法律法规等有关规定； 8.2.5 为执行相关服务协议或本政策、维护社会公共利益，为保护我们的客户、我们或我们的关联公司、其他用户或雇员的人身财产安全或其他合法权益所合理必需的用途。 当我们的产品或服务发生停止运营的情形时，我们将采取例如，推送通知、公告等形式通知您，并在合理的期限内删除或匿名化处理您的个人信息。 九、信息安全 我们为您的信息提供相应的安全保障，以防止信息的丢失、不当使用、未经授权访问或披露。 9.1我们严格遵守法律法规保护用户的通信秘密。 9.2我们将在合理的安全水平内使用各种安全保护措施以保障信息的安全。例如，我们使用加密技术（例如，TLS、SSL）、匿名化处理等手段来保护您的个人信息。 9.3我们建立专门的管理制度、流程和组织确保信息安全。例如，我们严格限制访问信息的人员范围，要求他们遵守保密义务，并进行审查。 9.4若发生个人信息泄露等安全事件，我们会启动应急预案，阻止安全事件扩大，并以推送通知、公告等形式告知您。 我们可能使用您的相关信息，在相关网站、应用及其他渠道向您提供与您更加相关的广告。您可以在关于广告页面中了解更多。 十、未成年人保护 我们非常重视对未成年人个人信息的保护。根据相关法律法规的规定，若您是18周岁以下的未成年人，在使用"+this.companyName+"的服务前，我们建议应事先取得您的家长或法定监护人的同意。若您是未成年人的监护人，当您对您所监护的未成年人的个人信息有相关疑问时，请通过联系方式与我们联系。 十一、适用范围 我们的所有服务均适用本政策。但某些服务有其特定的隐私指引/声明，该特定隐私指引/声明更具体地说明我们在该服务中如何处理您的信息。如本政策与特定服务的隐私指引/声明有不一致之处，请以该特定隐私指引/声明为准。请您注意，本政策不适用由其他公司或个人提供的服务。例如，您通过使用微信帐号登录其他公司或个人提供的服务。 您使用该等第三方服务须受其隐私政策（而非本政策）约束，您需要仔细阅读其政策内容。 十二、变更 我们可能适时修订本政策内容。如该等变更会导致您在本政策项下权利的实质减损，我们将在变更生效前，通过在页面显著位置提示、向您发送电子邮件等方式通知您。在该种情况下，若您继续使用我们的服务，即表示同意受经修订的政策约束。";let t=this.msg.text,e=t.split(" ");console.log(e.length);for(var i=0;i<e.length;i++)t=t.replace(" ","\n");this.msg.text=t,this.msg.on(Laya.Event.MOUSE_DOWN,this,this.startScrollText)}startScrollText(t){this.prevX=this.msg.mouseX,this.prevY=this.msg.mouseY,Laya.stage.on(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.finishScrollText)}finishScrollText(t){Laya.stage.off(Laya.Event.MOUSE_MOVE,this,this.scrollText),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.finishScrollText)}scrollText(t){var e=this.msg.mouseX,i=this.msg.mouseY;this.msg.scrollX+=this.prevX-e,this.msg.scrollY+=this.prevY-i,this.prevX=e,this.prevY=i}}class Gt{constructor(){}static init(){var t=Laya.ClassUtils.regClass;t("platforms/cpLogicalMgr/FanDong/Box1.ts",p),t("platforms/cpLogicalMgr/FanDong/Box2.ts",m),t("uiScenes/Game.ts",xt),t("extensionTools/mods_Nimo/ctrl/TouchScan.ts",F),t("extensionTools/mods_Nimo/ctrl/CarControlComponent.ts",z),t("gameComponents/UI/SpeedUI.ts",st),t("gameComponents/UI/SpeedButton.ts",k),t("extensionTools/mods_Nimo/ctrl/JoystickComponentLeft.ts",j),t("extensionTools/mods_Nimo/ctrl/JoystickComponentRight.ts",W),t("gameComponents/UI/AttackButton1.ts",X),t("gameComponents/UI/AttackButton2.ts",Y),t("gameComponents/UI/AttackButton3.ts",q),t("gameComponents/UI/HpShow.ts",Z),t("extensionTools/mods_Nimo/ui/AlphaUITween.ts",Pt),t("platforms/cpLogicalMgr/QingYou/Component/NativeAdComponent.ts",Rt),t("gameComponents/UI/emojiCoolButton.ts",tt),t("gameComponents/UI/emojiCryButton.ts",et),t("gameComponents/UI/emojiCryLaughButton.ts",it),t("extensionTools/mods_Nimo/ui/ScaleUITween.ts",Nt),t("uiScenes/Home.ts",dt),t("gameComponents/UI/CoinWindow.ts",lt),t("uiScenes/Load.ts",Ht),t("uiScenes/Over.ts",Ut),t("uiScenes/UiScene.ts",ct),t("d2Components/PrivacyAgreementComponent.ts",Ot)}}Gt.width=1334,Gt.height=750,Gt.scaleMode="fixedheight",Gt.screenMode="horizontal",Gt.alignV="middle",Gt.alignH="center",Gt.startScene="FDScene/Box1.scene",Gt.sceneRoot="",Gt.debug=!1,Gt.stat=!1,Gt.physicsDebug=!1,Gt.exportSceneToJson=!0,Gt.init();new class{constructor(){window.Laya3D?Laya3D.init(Gt.width,Gt.height):Laya.init(Gt.width,Gt.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=Gt.scaleMode,Laya.stage.screenMode=Gt.screenMode,Laya.stage.alignV=Gt.alignV,Laya.stage.alignH=Gt.alignH,Laya.URL.exportSceneToJson=Gt.exportSceneToJson,(Gt.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),Gt.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),Gt.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){c.init(()=>{bt.init(),c.loadGame(()=>{bt.UI.openScene(i.Load)})})}}}();